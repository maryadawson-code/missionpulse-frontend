<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse — Personnel Registry</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:#00050F;min-height:100vh;color:#e2e8f0}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(0,229,250,0.2);border-radius:3px}</style>
</head>
<body>
  <div id="missionpulse-sidebar"></div>
  <div class="main-content"><div id="root"></div></div>
  <script src="missionpulse-nav.js"></script>
  <script type="text/babel">
    const{useState,useEffect,useMemo}=React;
    const SB_URL='https://qdrtpnpnhkxvfmvfziop.supabase.co';
    const SB_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5MjMxNDMsImV4cCI6MjA1MzQ5OTE0M30.GFbjgRMgVhMMcnNaJMrLVnJI_u6yBGJOhO-LHKE8sZQ';
    var sbClient;try{sbClient=supabase.createClient(SB_URL,SB_KEY)}catch(e){sbClient=null}
    const ROLES_ALLOWED=['CEO','COO','CAP','PM','HR'];

    const DEMO_PERSONNEL=[
      {id:1,name:'Mary Womack',title:'Program Manager',lcat:'PM',clearance:'Secret',clearanceStatus:'Active',availability:'Available',company:'MMT',keyPersonnel:true,yearsExp:18,certs:['PMP','ITIL v4','SAFe SPC'],agencies:['DHA','VA','CMS'],resumeStatus:'Current',resumeDate:'2026-02-01',proposals:['DHA EHR Mod','VA Claims AI'],skills:['Program Management','Agile','EVM','Federal Health IT','Proposal Leadership']},
      {id:2,name:'Tom Patterson',title:'Deputy Program Manager',lcat:'DPM',clearance:'Secret',clearanceStatus:'Active',availability:'Available',company:'MMT',keyPersonnel:true,yearsExp:14,certs:['PMP','CSM','CMMI'],agencies:['DHA','DoD'],resumeStatus:'Current',resumeDate:'2026-01-20',proposals:['DHA EHR Mod'],skills:['Capture Management','Risk Management','Transition Planning','Team Leadership']},
      {id:3,name:'Sarah Kim',title:'Solutions Architect',lcat:'SA',clearance:'Top Secret',clearanceStatus:'Active',availability:'Available',company:'MMT',keyPersonnel:true,yearsExp:16,certs:['AWS Solutions Architect Pro','Azure Solutions Architect','CISSP'],agencies:['DHA','VA','NIH'],resumeStatus:'Current',resumeDate:'2026-02-10',proposals:['DHA EHR Mod','VA Claims AI','CMS Data Analytics'],skills:['Cloud Architecture','DevSecOps','Microservices','FedRAMP','Azure Gov']},
      {id:4,name:'James Rodriguez',title:'AI/ML Lead',lcat:'AI-Lead',clearance:'Secret',clearanceStatus:'Active',availability:'Partial',company:'MMT',keyPersonnel:true,yearsExp:10,certs:['AWS ML Specialty','Google Cloud ML','TensorFlow Dev'],agencies:['VA','CMS'],resumeStatus:'Current',resumeDate:'2026-01-28',proposals:['VA Claims AI'],skills:['Machine Learning','NLP','Python','MLOps','Responsible AI']},
      {id:5,name:'Angela Foster',title:'Cybersecurity Lead',lcat:'Cyber-Lead',clearance:'Top Secret/SCI',clearanceStatus:'Active',availability:'Available',company:'MMT',keyPersonnel:true,yearsExp:12,certs:['CISSP','CISM','CEH','Security+'],agencies:['DoD','DHA','NSA'],resumeStatus:'Current',resumeDate:'2026-02-05',proposals:['DHA EHR Mod'],skills:['RMF','NIST 800-171','CMMC','Penetration Testing','ATO']},
      {id:6,name:'David Chen',title:'Senior Developer',lcat:'Sr-Dev',clearance:'Secret',clearanceStatus:'Active',availability:'Available',company:'TechPartner Alpha',keyPersonnel:false,yearsExp:8,certs:['AWS Dev Associate','Kubernetes CKA'],agencies:['DHA'],resumeStatus:'Current',resumeDate:'2025-12-15',proposals:['DHA EHR Mod'],skills:['React','Node.js','Python','PostgreSQL','CI/CD']},
      {id:7,name:'Michelle Torres',title:'Data Engineer',lcat:'Data-Eng',clearance:'Secret',clearanceStatus:'Pending',availability:'Available',company:'DataBridge LLC',keyPersonnel:false,yearsExp:7,certs:['AWS Data Analytics','Snowflake'],agencies:['CMS','VA'],resumeStatus:'Needs Update',resumeDate:'2025-10-20',proposals:['CMS Data Analytics'],skills:['ETL','SQL','Spark','Airflow','Data Modeling']},
      {id:8,name:'Robert Jackson',title:'ISSO',lcat:'ISSO',clearance:'Top Secret',clearanceStatus:'Active',availability:'Partial',company:'SecureForce Inc.',keyPersonnel:false,yearsExp:15,certs:['CISSP','CISA','CAP'],agencies:['DoD','DHA','Army'],resumeStatus:'Current',resumeDate:'2026-01-10',proposals:['DHA EHR Mod'],skills:['eMASS','RMF','STIG','SCAP','Vulnerability Management']},
      {id:9,name:'Lisa Wang',title:'DevSecOps Engineer',lcat:'DevSecOps',clearance:'Secret',clearanceStatus:'Active',availability:'Available',company:'MMT',keyPersonnel:false,yearsExp:6,certs:['Kubernetes CKA','HashiCorp Terraform','AWS DevOps Pro'],agencies:['DHA','VA'],resumeStatus:'Current',resumeDate:'2026-01-25',proposals:['DHA EHR Mod','VA Claims AI'],skills:['Terraform','Kubernetes','Jenkins','GitLab CI','Container Security']},
      {id:10,name:'Kevin Brown',title:'Help Desk Lead',lcat:'HD-Lead',clearance:'Public Trust',clearanceStatus:'Active',availability:'Available',company:'MMT',keyPersonnel:false,yearsExp:9,certs:['ITIL v4 Foundation','HDI Support Center Lead'],agencies:['DHA','VA'],resumeStatus:'Needs Update',resumeDate:'2025-09-15',proposals:[],skills:['ServiceNow','ITSM','Knowledge Management','SLA Management']},
      {id:11,name:'Patricia Nguyen',title:'QA Lead',lcat:'QA-Lead',clearance:'Secret',clearanceStatus:'Active',availability:'Available',company:'MMT',keyPersonnel:false,yearsExp:11,certs:['ISTQB Advanced','CSM'],agencies:['DHA','CMS'],resumeStatus:'Current',resumeDate:'2026-02-08',proposals:['DHA EHR Mod','CMS Data Analytics'],skills:['Test Automation','Selenium','508 Testing','Performance Testing','Agile QA']},
      {id:12,name:'Mark Stevens',title:'Technical Writer',lcat:'TW',clearance:'Public Trust',clearanceStatus:'Active',availability:'Available',company:'MMT',keyPersonnel:false,yearsExp:7,certs:['CPTC'],agencies:['DHA','VA','CMS'],resumeStatus:'Current',resumeDate:'2026-01-30',proposals:['DHA EHR Mod','VA Claims AI','CMS Data Analytics'],skills:['Proposal Writing','Technical Documentation','508 Compliance','DITA','Shipley']},
    ];

    const CLEARANCE_LEVELS=['All','Top Secret/SCI','Top Secret','Secret','Public Trust'];
    const AVAILABILITY=['All','Available','Partial','Committed','Unavailable'];

    const ConnectionDot=({c})=>(<div style={{display:'flex',alignItems:'center',gap:'6px',fontSize:'11px',color:c?'#00ff88':'#f59e0b'}}><div style={{width:'8px',height:'8px',borderRadius:'50%',background:c?'#00ff88':'#f59e0b',boxShadow:`0 0 6px ${c?'#00ff88':'#f59e0b'}`}}/>{c?'LIVE':'DEMO'}</div>);

    const App=()=>{
      const[connected,setConnected]=useState(false);
      const[personnel]=useState(DEMO_PERSONNEL);
      const[search,setSearch]=useState('');
      const[clearanceFilter,setClearanceFilter]=useState('All');
      const[availFilter,setAvailFilter]=useState('All');
      const[keyOnly,setKeyOnly]=useState(false);
      const[expanded,setExpanded]=useState(null);
      const[view,setView]=useState('cards');

      useEffect(()=>{if(!sbClient)return;(async()=>{try{const{data,error}=await sbClient.from('team_assignments').select('id');if(!error&&data&&data.length>0)setConnected(true)}catch{}})()},[]);

      const filtered=useMemo(()=>{
        return personnel.filter(p=>{
          if(keyOnly&&!p.keyPersonnel)return false;
          if(clearanceFilter!=='All'&&p.clearance!==clearanceFilter)return false;
          if(availFilter!=='All'&&p.availability!==availFilter)return false;
          if(search){const s=search.toLowerCase();return p.name.toLowerCase().includes(s)||p.title.toLowerCase().includes(s)||p.lcat.toLowerCase().includes(s)||p.skills.some(sk=>sk.toLowerCase().includes(s))||p.certs.some(c=>c.toLowerCase().includes(s))}
          return true;
        });
      },[search,clearanceFilter,availFilter,keyOnly,personnel]);

      const clearanceColor={'Top Secret/SCI':'#ef4444','Top Secret':'#f59e0b','Secret':'#00E5FA','Public Trust':'#94a3b8'};
      const availColor={Available:'#00ff88',Partial:'#f59e0b',Committed:'#ef4444',Unavailable:'#5a7a9a'};
      const resumeColor={Current:'#00ff88','Needs Update':'#f59e0b'};

      return(
        <div style={{padding:'24px 32px',maxWidth:'1400px'}}>
          <div style={{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'24px'}}>
            <div>
              <div style={{fontSize:'10px',fontWeight:700,color:'rgba(0,229,250,0.5)',letterSpacing:'2px',textTransform:'uppercase',marginBottom:'4px'}}>WORKFORCE MANAGEMENT</div>
              <h1 style={{fontSize:'26px',fontWeight:800,color:'white',letterSpacing:'-0.5px',margin:0}}>Personnel Registry</h1>
              <div style={{fontSize:'12px',color:'#5a7a9a',marginTop:'4px'}}>Key personnel • Clearances • Resume bank • Availability</div>
            </div>
            <ConnectionDot c={connected}/>
          </div>

          {/* Stats */}
          <div style={{display:'flex',gap:'10px',flexWrap:'wrap',marginBottom:'20px'}}>
            {[
              {label:'Total Personnel',value:personnel.length,color:'#00E5FA'},
              {label:'Key Personnel',value:personnel.filter(p=>p.keyPersonnel).length,color:'#f59e0b'},
              {label:'TS/SCI + TS',value:personnel.filter(p=>p.clearance.includes('Top Secret')).length,color:'#ef4444'},
              {label:'Available Now',value:personnel.filter(p=>p.availability==='Available').length,color:'#00ff88'},
              {label:'Resumes Current',value:personnel.filter(p=>p.resumeStatus==='Current').length,color:'#00ff88'},
              {label:'Needs Update',value:personnel.filter(p=>p.resumeStatus==='Needs Update').length,color:'#f59e0b'},
            ].map(s=>(
              <div key={s.label} style={{background:'rgba(10,22,40,0.7)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'10px',padding:'10px 16px',minWidth:'120px'}}>
                <div style={{fontSize:'9px',fontWeight:700,color:'#5a7a9a',letterSpacing:'0.5px',textTransform:'uppercase'}}>{s.label}</div>
                <div style={{fontSize:'22px',fontWeight:800,color:s.color,letterSpacing:'-0.5px'}}>{s.value}</div>
              </div>
            ))}
          </div>

          {/* Filters */}
          <div style={{display:'flex',gap:'8px',flexWrap:'wrap',marginBottom:'16px',alignItems:'center'}}>
            <input type="text" placeholder="Search name, LCAT, skill, cert…" value={search} onChange={e=>setSearch(e.target.value)} style={{background:'rgba(10,22,40,0.7)',border:'1px solid rgba(0,229,250,0.15)',borderRadius:'8px',padding:'7px 14px',fontSize:'12px',color:'#e2e8f0',outline:'none',width:'240px'}}/>
            <button onClick={()=>setKeyOnly(!keyOnly)} style={{padding:'5px 12px',fontSize:'11px',fontWeight:600,borderRadius:'6px',border:'none',cursor:'pointer',background:keyOnly?'rgba(245,158,11,0.15)':'rgba(10,22,40,0.5)',color:keyOnly?'#f59e0b':'#5a7a9a'}}>⭐ Key Only</button>
            <select value={clearanceFilter} onChange={e=>setClearanceFilter(e.target.value)} style={{background:'rgba(10,22,40,0.7)',border:'1px solid rgba(0,229,250,0.15)',borderRadius:'8px',padding:'6px 10px',fontSize:'11px',color:'#e2e8f0',outline:'none'}}>
              {CLEARANCE_LEVELS.map(c=><option key={c} value={c}>{c==='All'?'All Clearances':c}</option>)}
            </select>
            <select value={availFilter} onChange={e=>setAvailFilter(e.target.value)} style={{background:'rgba(10,22,40,0.7)',border:'1px solid rgba(0,229,250,0.15)',borderRadius:'8px',padding:'6px 10px',fontSize:'11px',color:'#e2e8f0',outline:'none'}}>
              {AVAILABILITY.map(a=><option key={a} value={a}>{a==='All'?'All Availability':a}</option>)}
            </select>
            <div style={{marginLeft:'auto',display:'flex',gap:'4px'}}>
              {[{k:'cards',l:'Cards'},{k:'table',l:'Table'}].map(v=>(
                <button key={v.k} onClick={()=>setView(v.k)} style={{padding:'5px 12px',fontSize:'11px',fontWeight:600,borderRadius:'6px',border:'none',cursor:'pointer',background:view===v.k?'rgba(0,229,250,0.15)':'rgba(10,22,40,0.5)',color:view===v.k?'#00E5FA':'#5a7a9a'}}>{v.l}</button>
              ))}
            </div>
          </div>

          {/* CARDS VIEW */}
          {view==='cards'&&(
            <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(360px, 1fr))',gap:'10px'}}>
              {filtered.map(p=>(
                <div key={p.id} style={{background:'rgba(10,22,40,0.5)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'12px',padding:'16px',transition:'all 0.15s',cursor:'pointer'}}
                  onClick={()=>setExpanded(expanded===p.id?null:p.id)}
                  onMouseOver={e=>e.currentTarget.style.borderColor='rgba(0,229,250,0.25)'} onMouseOut={e=>e.currentTarget.style.borderColor='rgba(0,229,250,0.08)'}>
                  <div style={{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'10px'}}>
                    <div>
                      <div style={{display:'flex',alignItems:'center',gap:'6px'}}>
                        <span style={{fontSize:'15px',fontWeight:700,color:'white'}}>{p.name}</span>
                        {p.keyPersonnel&&<span style={{fontSize:'9px',fontWeight:700,padding:'1px 5px',borderRadius:'3px',background:'rgba(245,158,11,0.12)',color:'#f59e0b'}}>⭐ KEY</span>}
                      </div>
                      <div style={{fontSize:'12px',color:'#94a3b8',marginTop:'2px'}}>{p.title} • {p.company}</div>
                    </div>
                    <div style={{display:'flex',gap:'4px',flexDirection:'column',alignItems:'flex-end'}}>
                      <span style={{fontSize:'9px',fontWeight:700,padding:'2px 6px',borderRadius:'3px',background:`${clearanceColor[p.clearance]}12`,color:clearanceColor[p.clearance]}}>{p.clearance}</span>
                      <span style={{fontSize:'9px',fontWeight:600,padding:'1px 5px',borderRadius:'3px',background:`${availColor[p.availability]}10`,color:availColor[p.availability]}}>● {p.availability}</span>
                    </div>
                  </div>
                  <div style={{display:'flex',gap:'10px',fontSize:'11px',marginBottom:'8px'}}>
                    <span style={{color:'#5a7a9a'}}>LCAT: <span style={{color:'#00E5FA',fontWeight:600}}>{p.lcat}</span></span>
                    <span style={{color:'#5a7a9a'}}>{p.yearsExp} yrs exp</span>
                    <span style={{color:'#5a7a9a'}}>Resume: <span style={{color:resumeColor[p.resumeStatus],fontWeight:600}}>{p.resumeStatus}</span></span>
                  </div>
                  <div style={{display:'flex',gap:'3px',flexWrap:'wrap',marginBottom:'8px'}}>
                    {p.certs.map(c=><span key={c} style={{fontSize:'9px',fontWeight:600,padding:'1px 5px',borderRadius:'3px',background:'rgba(167,139,250,0.08)',color:'#a78bfa'}}>{c}</span>)}
                  </div>

                  {expanded===p.id&&(
                    <div style={{borderTop:'1px solid rgba(0,229,250,0.06)',paddingTop:'10px',marginTop:'4px'}}>
                      <div style={{marginBottom:'8px'}}>
                        <div style={{fontSize:'10px',fontWeight:700,color:'#5a7a9a',marginBottom:'4px'}}>SKILLS</div>
                        <div style={{display:'flex',gap:'3px',flexWrap:'wrap'}}>
                          {p.skills.map(s=><span key={s} style={{fontSize:'9px',padding:'2px 6px',borderRadius:'4px',background:'rgba(0,229,250,0.06)',color:'#67e8f9'}}>{s}</span>)}
                        </div>
                      </div>
                      <div style={{marginBottom:'8px'}}>
                        <div style={{fontSize:'10px',fontWeight:700,color:'#5a7a9a',marginBottom:'4px'}}>AGENCY EXPERIENCE</div>
                        <div style={{display:'flex',gap:'4px'}}>
                          {p.agencies.map(a=><span key={a} style={{fontSize:'10px',fontWeight:600,padding:'2px 6px',borderRadius:'4px',background:'rgba(0,255,136,0.06)',color:'#86efac'}}>{a}</span>)}
                        </div>
                      </div>
                      {p.proposals.length>0&&(
                        <div>
                          <div style={{fontSize:'10px',fontWeight:700,color:'#5a7a9a',marginBottom:'4px'}}>ACTIVE PROPOSALS</div>
                          <div style={{display:'flex',gap:'4px',flexWrap:'wrap'}}>
                            {p.proposals.map(pr=><span key={pr} style={{fontSize:'10px',padding:'2px 6px',borderRadius:'4px',background:'rgba(0,229,250,0.06)',color:'#00E5FA'}}>{pr}</span>)}
                          </div>
                        </div>
                      )}
                      <div style={{marginTop:'8px',fontSize:'10px',color:'#3e4f63'}}>
                        Clearance: {p.clearanceStatus} | Resume updated: {p.resumeDate}
                      </div>
                    </div>
                  )}
                </div>
              ))}
            </div>
          )}

          {/* TABLE VIEW */}
          {view==='table'&&(
            <div style={{background:'rgba(10,22,40,0.5)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'12px',overflow:'auto'}}>
              <table style={{width:'100%',borderCollapse:'collapse',fontSize:'12px',minWidth:'900px'}}>
                <thead><tr style={{borderBottom:'1px solid rgba(0,229,250,0.1)'}}>
                  {['Name','Title','LCAT','Company','Clearance','Status','Availability','Exp','Resume','Proposals'].map(h=>(
                    <th key={h} style={{padding:'10px 10px',textAlign:'left',color:'#5a7a9a',fontWeight:700,fontSize:'10px',letterSpacing:'0.5px',textTransform:'uppercase',whiteSpace:'nowrap'}}>{h}</th>
                  ))}
                </tr></thead>
                <tbody>
                  {filtered.map(p=>(
                    <tr key={p.id} style={{borderBottom:'1px solid rgba(0,229,250,0.04)'}} onMouseOver={e=>e.currentTarget.style.background='rgba(0,229,250,0.03)'} onMouseOut={e=>e.currentTarget.style.background='transparent'}>
                      <td style={{padding:'8px 10px',fontWeight:600,color:'white',whiteSpace:'nowrap'}}>
                        {p.name}{p.keyPersonnel&&<span style={{marginLeft:'4px',fontSize:'9px',color:'#f59e0b'}}>⭐</span>}
                      </td>
                      <td style={{padding:'8px 10px',color:'#94a3b8',fontSize:'11px'}}>{p.title}</td>
                      <td style={{padding:'8px 10px',fontFamily:'monospace',fontSize:'11px',color:'#00E5FA',fontWeight:600}}>{p.lcat}</td>
                      <td style={{padding:'8px 10px',color:'#94a3b8',fontSize:'11px'}}>{p.company}</td>
                      <td style={{padding:'8px 10px'}}><span style={{fontSize:'9px',fontWeight:600,padding:'1px 5px',borderRadius:'3px',background:`${clearanceColor[p.clearance]}10`,color:clearanceColor[p.clearance]}}>{p.clearance}</span></td>
                      <td style={{padding:'8px 10px'}}><span style={{fontSize:'9px',fontWeight:600,color:p.clearanceStatus==='Active'?'#00ff88':'#f59e0b'}}>{p.clearanceStatus}</span></td>
                      <td style={{padding:'8px 10px'}}><span style={{fontSize:'9px',fontWeight:600,padding:'1px 5px',borderRadius:'3px',background:`${availColor[p.availability]}10`,color:availColor[p.availability]}}>{p.availability}</span></td>
                      <td style={{padding:'8px 10px',textAlign:'center',fontSize:'11px',color:'#e2e8f0'}}>{p.yearsExp}</td>
                      <td style={{padding:'8px 10px'}}><span style={{fontSize:'9px',fontWeight:600,color:resumeColor[p.resumeStatus]}}>{p.resumeStatus}</span></td>
                      <td style={{padding:'8px 10px',fontSize:'10px',color:'#5a7a9a',maxWidth:'150px',overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'}}>{p.proposals.join(', ')||'—'}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}

          <div style={{marginTop:'10px',fontSize:'11px',color:'#3e4f63',textAlign:'right'}}>{filtered.length} of {personnel.length} personnel shown</div>

          <div style={{textAlign:'center',padding:'20px 0',marginTop:'20px',borderTop:'1px solid rgba(0,229,250,0.06)',fontSize:'10px',color:'rgba(148,163,184,0.4)',lineHeight:'1.8'}}>⚠️ AI GENERATED — REQUIRES HUMAN REVIEW<br/>MissionPulse v12.0 — Mission Meets Tech | CMMC 2.0 L2 Compliant</div>
        </div>
      );
    };
    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  </script>
</body>
</html>
