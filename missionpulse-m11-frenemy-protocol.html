<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M11 Frenemy Protocol | MissionPulse v12</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'pulse-cyan': '#00E5FA',
                        'deep-navy': '#00050F',
                        'navy-light': '#0a1628',
                        'navy-mid': '#162033',
                        'success': '#10B981',
                        'warning': '#F59E0B',
                        'danger': '#EF4444',
                        'info': '#3B82F6'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .glass-card {
            background: linear-gradient(135deg, rgba(22, 32, 51, 0.9) 0%, rgba(10, 22, 40, 0.95) 100%);
            border: 1px solid rgba(0, 229, 250, 0.2);
            backdrop-filter: blur(10px);
        }
        .glass-card:hover {
            border-color: rgba(0, 229, 250, 0.4);
            box-shadow: 0 0 30px rgba(0, 229, 250, 0.1);
        }
        .pulse-glow {
            box-shadow: 0 0 20px rgba(0, 229, 250, 0.3);
        }
        .risk-meter {
            background: linear-gradient(90deg, #10B981 0%, #F59E0B 50%, #EF4444 100%);
        }
        .partner-card {
            transition: all 0.3s ease;
        }
        .partner-card:hover {
            transform: translateY(-2px);
        }
        @keyframes pulse-ring {
            0% { box-shadow: 0 0 0 0 rgba(0, 229, 250, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0, 229, 250, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 229, 250, 0); }
        }
        .alert-pulse {
            animation: pulse-ring 2s infinite;
        }
        .work-share-bar {
            transition: width 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-deep-navy min-h-screen text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // ============ DEMO DATA ============
        const DEMO_PARTNERS = [
            {
                id: 'TP001',
                name: 'CyberShield Solutions',
                type: 'Prime',
                relationship: 'Active',
                workShare: 35,
                risks: { financial: 2, performance: 1, oci: 3, capacity: 2 },
                overallRisk: 'Low',
                contracts: ['DHA-EMR-2024', 'VA-CYBER-2025'],
                agreements: [
                    { type: 'NDA', expires: '2025-06-15', status: 'Active' },
                    { type: 'TA', expires: '2025-03-20', status: 'Expiring Soon' }
                ],
                scorecard: { onTime: 94, quality: 92, communication: 88, compliance: 96 },
                history: [
                    { date: '2024-12-01', event: 'Renewed Teaming Agreement', type: 'positive' },
                    { date: '2024-09-15', event: 'Won DHA-EMR-2024 together', type: 'positive' },
                    { date: '2024-06-01', event: 'Initial partnership formed', type: 'neutral' }
                ],
                keyPersonnel: 'Sarah Chen (BD Director)',
                phone: '(703) 555-0142',
                email: 'partnerships@cybershield.com',
                naicsMatch: ['541512', '541519', '518210'],
                certifications: ['ISO 27001', 'CMMC L3', 'FedRAMP Moderate']
            },
            {
                id: 'TP002',
                name: 'HealthTech Dynamics',
                type: 'Subcontractor',
                relationship: 'Watch',
                workShare: 25,
                risks: { financial: 4, performance: 3, oci: 1, capacity: 4 },
                overallRisk: 'Medium',
                contracts: ['VA-TELEHEALTH-2024'],
                agreements: [
                    { type: 'NDA', expires: '2025-01-30', status: 'Expiring Soon' },
                    { type: 'TA', expires: '2025-04-15', status: 'Active' }
                ],
                scorecard: { onTime: 78, quality: 82, communication: 75, compliance: 88 },
                history: [
                    { date: '2024-11-15', event: 'Delivery delay on VA module', type: 'negative' },
                    { date: '2024-08-01', event: 'Joined VA-TELEHEALTH team', type: 'positive' },
                    { date: '2024-05-20', event: 'Capacity concerns flagged', type: 'warning' }
                ],
                keyPersonnel: 'Marcus Thompson (CEO)',
                phone: '(571) 555-0198',
                email: 'marcus@healthtechdyn.com',
                naicsMatch: ['541511', '541512'],
                certifications: ['HIPAA Compliant', 'SOC 2 Type II']
            },
            {
                id: 'TP003',
                name: 'Federal Cloud Systems',
                type: 'Subcontractor',
                relationship: 'Active',
                workShare: 20,
                risks: { financial: 1, performance: 2, oci: 2, capacity: 1 },
                overallRisk: 'Low',
                contracts: ['DHA-CLOUD-2025', 'VA-INFRA-2024'],
                agreements: [
                    { type: 'NDA', expires: '2026-01-01', status: 'Active' },
                    { type: 'TA', expires: '2025-12-31', status: 'Active' }
                ],
                scorecard: { onTime: 96, quality: 94, communication: 91, compliance: 98 },
                history: [
                    { date: '2024-12-10', event: 'Exceeded SLA targets Q4', type: 'positive' },
                    { date: '2024-10-01', event: 'Added to DHA-CLOUD team', type: 'positive' },
                    { date: '2024-03-15', event: 'Long-term partnership renewed', type: 'positive' }
                ],
                keyPersonnel: 'Jennifer Walsh (Partnerships VP)',
                phone: '(202) 555-0167',
                email: 'jwalsh@fedcloudsys.com',
                naicsMatch: ['518210', '541512', '541519'],
                certifications: ['FedRAMP High', 'ISO 27001', 'CMMC L3', 'SOC 2']
            },
            {
                id: 'TP004',
                name: 'DataSync Analytics',
                type: 'Subcontractor',
                relationship: 'Terminated',
                workShare: 0,
                risks: { financial: 5, performance: 5, oci: 4, capacity: 5 },
                overallRisk: 'High',
                contracts: [],
                agreements: [
                    { type: 'NDA', expires: '2025-06-01', status: 'Active (Post-Term)' },
                    { type: 'TA', expires: '2024-09-30', status: 'Terminated' }
                ],
                scorecard: { onTime: 45, quality: 52, communication: 40, compliance: 65 },
                history: [
                    { date: '2024-09-30', event: 'Partnership terminated - repeated failures', type: 'negative' },
                    { date: '2024-08-15', event: 'Compliance violation reported', type: 'negative' },
                    { date: '2024-07-01', event: 'Missed critical deadline', type: 'negative' },
                    { date: '2024-04-01', event: 'Performance issues first noted', type: 'warning' }
                ],
                keyPersonnel: 'Robert Kim (Former Contact)',
                phone: 'N/A',
                email: 'N/A',
                naicsMatch: ['541511', '541519'],
                certifications: ['SOC 2 Type I (Expired)']
            },
            {
                id: 'TP005',
                name: 'MedRecord Innovations',
                type: 'Prime',
                relationship: 'Active',
                workShare: 20,
                risks: { financial: 2, performance: 2, oci: 5, capacity: 2 },
                overallRisk: 'Medium',
                contracts: ['DHA-EMR-2024'],
                agreements: [
                    { type: 'NDA', expires: '2025-08-15', status: 'Active' },
                    { type: 'TA', expires: '2025-02-28', status: 'Expiring Soon' }
                ],
                scorecard: { onTime: 88, quality: 90, communication: 85, compliance: 92 },
                history: [
                    { date: '2024-11-01', event: 'OCI review initiated - competing on VA work', type: 'warning' },
                    { date: '2024-09-15', event: 'Joint win on DHA-EMR', type: 'positive' },
                    { date: '2024-07-01', event: 'Teaming agreement signed', type: 'positive' }
                ],
                keyPersonnel: 'Dr. Amanda Foster (CTO)',
                phone: '(703) 555-0234',
                email: 'afoster@medrecord.io',
                naicsMatch: ['541511', '541512', '621999'],
                certifications: ['HIPAA Compliant', 'HITRUST', 'FedRAMP Moderate']
            }
        ];

        // ============ RBAC CONFIGURATION ============
        const ROLES = {
            CEO: { label: 'CEO', access: 'full', color: 'purple', canEdit: true, canTerminate: true, viewFinancial: true, viewOCI: true },
            COO: { label: 'COO', access: 'full', color: 'indigo', canEdit: true, canTerminate: true, viewFinancial: true, viewOCI: true },
            CAP: { label: 'Capture Lead', access: 'full', color: 'blue', canEdit: true, canTerminate: false, viewFinancial: true, viewOCI: true },
            PM: { label: 'Program Manager', access: 'limited', color: 'cyan', canEdit: false, canTerminate: false, viewFinancial: false, viewOCI: false },
            SA: { label: 'Solution Architect', access: 'limited', color: 'teal', canEdit: false, canTerminate: false, viewFinancial: false, viewOCI: false },
            FIN: { label: 'Finance', access: 'limited', color: 'green', canEdit: false, canTerminate: false, viewFinancial: true, viewOCI: false },
            CON: { label: 'Contracts', access: 'limited', color: 'yellow', canEdit: false, canTerminate: false, viewFinancial: false, viewOCI: true },
            DEL: { label: 'Delivery Lead', access: 'limited', color: 'orange', canEdit: false, canTerminate: false, viewFinancial: false, viewOCI: false },
            SME: { label: 'Subject Matter Expert', access: 'limited', color: 'red', canEdit: false, canTerminate: false, viewFinancial: false, viewOCI: false },
            WRITE: { label: 'Proposal Writer', access: 'limited', color: 'pink', canEdit: false, canTerminate: false, viewFinancial: false, viewOCI: false },
            VIEW: { label: 'Viewer', access: 'minimal', color: 'gray', canEdit: false, canTerminate: false, viewFinancial: false, viewOCI: false }
        };

        // ============ UTILITY FUNCTIONS ============
        const getRiskColor = (level) => {
            if (level <= 2) return 'text-success';
            if (level <= 3) return 'text-warning';
            return 'text-danger';
        };

        const getRiskBg = (level) => {
            if (level <= 2) return 'bg-success/20 border-success/30';
            if (level <= 3) return 'bg-warning/20 border-warning/30';
            return 'bg-danger/20 border-danger/30';
        };

        const getOverallRiskBadge = (risk) => {
            const colors = {
                'Low': 'bg-success/20 text-success border-success/30',
                'Medium': 'bg-warning/20 text-warning border-warning/30',
                'High': 'bg-danger/20 text-danger border-danger/30'
            };
            return colors[risk] || colors['Medium'];
        };

        const getRelationshipBadge = (status) => {
            const styles = {
                'Active': 'bg-success/20 text-success border-success/30',
                'Watch': 'bg-warning/20 text-warning border-warning/30',
                'Terminated': 'bg-danger/20 text-danger border-danger/30'
            };
            return styles[status] || styles['Watch'];
        };

        const getAgreementStatus = (expires) => {
            const expDate = new Date(expires);
            const today = new Date();
            const daysUntil = Math.ceil((expDate - today) / (1000 * 60 * 60 * 24));
            
            if (daysUntil < 0) return { status: 'Expired', color: 'text-danger', urgent: true };
            if (daysUntil <= 30) return { status: 'Expiring Soon', color: 'text-danger', urgent: true };
            if (daysUntil <= 90) return { status: 'Review Soon', color: 'text-warning', urgent: false };
            return { status: 'Active', color: 'text-success', urgent: false };
        };

        const getDaysUntil = (dateStr) => {
            const date = new Date(dateStr);
            const today = new Date();
            return Math.ceil((date - today) / (1000 * 60 * 60 * 24));
        };

        // ============ COMPONENTS ============

        // Header Component
        const Header = ({ currentRole, setCurrentRole }) => (
            <header className="bg-navy-light border-b border-pulse-cyan/20 sticky top-0 z-50">
                <div className="max-w-7xl mx-auto px-4 py-3">
                    <div className="flex items-center justify-between">
                        <div className="flex items-center gap-4">
                            <div className="flex items-center gap-2">
                                <div className="w-10 h-10 rounded-lg bg-gradient-to-br from-pulse-cyan to-blue-500 flex items-center justify-center">
                                    <svg className="w-6 h-6 text-deep-navy" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                                    </svg>
                                </div>
                                <div>
                                    <h1 className="text-lg font-bold text-white">MissionPulse</h1>
                                    <p className="text-xs text-pulse-cyan">M11 Frenemy Protocol</p>
                                </div>
                            </div>
                        </div>
                        
                        <div className="flex items-center gap-4">
                            <div className="flex items-center gap-2">
                                <span className="text-xs text-gray-400">Role:</span>
                                <select 
                                    value={currentRole}
                                    onChange={(e) => setCurrentRole(e.target.value)}
                                    className="bg-navy-mid border border-pulse-cyan/30 rounded-lg px-3 py-1.5 text-sm text-white focus:outline-none focus:border-pulse-cyan"
                                >
                                    {Object.entries(ROLES).map(([key, role]) => (
                                        <option key={key} value={key}>{role.label}</option>
                                    ))}
                                </select>
                            </div>
                            <div className={`px-3 py-1 rounded-full text-xs font-medium ${
                                ROLES[currentRole].access === 'full' ? 'bg-success/20 text-success' :
                                ROLES[currentRole].access === 'limited' ? 'bg-warning/20 text-warning' :
                                'bg-gray-500/20 text-gray-400'
                            }`}>
                                {ROLES[currentRole].access.toUpperCase()} ACCESS
                            </div>
                        </div>
                    </div>
                </div>
            </header>
        );

        // Risk Matrix Component
        const RiskMatrix = ({ risks, showDetails, roleConfig }) => {
            const riskLabels = {
                financial: { label: 'Financial', icon: 'üí∞', desc: 'Fiscal stability & viability' },
                performance: { label: 'Performance', icon: 'üìä', desc: 'Delivery track record' },
                oci: { label: 'OCI', icon: '‚ö†Ô∏è', desc: 'Conflict of interest risk' },
                capacity: { label: 'Capacity', icon: 'üë•', desc: 'Resource availability' }
            };

            return (
                <div className="grid grid-cols-2 gap-2">
                    {Object.entries(risks).map(([key, value]) => {
                        const isRestricted = (key === 'financial' && !roleConfig.viewFinancial) || 
                                           (key === 'oci' && !roleConfig.viewOCI);
                        
                        return (
                            <div key={key} className={`p-2 rounded-lg border ${getRiskBg(value)} ${isRestricted ? 'opacity-50' : ''}`}>
                                <div className="flex items-center justify-between">
                                    <span className="text-xs text-gray-300">
                                        {riskLabels[key].icon} {riskLabels[key].label}
                                    </span>
                                    <span className={`text-sm font-bold ${getRiskColor(value)}`}>
                                        {isRestricted ? 'üîí' : `${value}/5`}
                                    </span>
                                </div>
                                {showDetails && !isRestricted && (
                                    <div className="mt-1 h-1.5 bg-gray-700 rounded-full overflow-hidden">
                                        <div 
                                            className={`h-full rounded-full ${value <= 2 ? 'bg-success' : value <= 3 ? 'bg-warning' : 'bg-danger'}`}
                                            style={{ width: `${(value / 5) * 100}%` }}
                                        />
                                    </div>
                                )}
                            </div>
                        );
                    })}
                </div>
            );
        };

        // Work Share Visualization
        const WorkShareChart = ({ partners }) => {
            const activePartners = partners.filter(p => p.relationship !== 'Terminated' && p.workShare > 0);
            const totalShare = activePartners.reduce((sum, p) => sum + p.workShare, 0);
            const primeShare = 100 - totalShare;
            
            const colors = ['#00E5FA', '#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6'];
            
            return (
                <div className="glass-card rounded-xl p-4">
                    <h3 className="text-sm font-semibold text-white mb-4 flex items-center gap-2">
                        <span>üìä</span> Work Share Allocation
                    </h3>
                    
                    <div className="h-8 bg-gray-800 rounded-full overflow-hidden flex mb-4">
                        <div 
                            className="h-full bg-pulse-cyan/60 flex items-center justify-center text-xs font-medium work-share-bar"
                            style={{ width: `${primeShare}%` }}
                        >
                            {primeShare > 10 && `Your Org ${primeShare}%`}
                        </div>
                        {activePartners.map((partner, idx) => (
                            <div 
                                key={partner.id}
                                className="h-full flex items-center justify-center text-xs font-medium work-share-bar"
                                style={{ 
                                    width: `${partner.workShare}%`,
                                    backgroundColor: colors[idx % colors.length]
                                }}
                            >
                                {partner.workShare > 8 && `${partner.workShare}%`}
                            </div>
                        ))}
                    </div>
                    
                    <div className="flex flex-wrap gap-2">
                        <div className="flex items-center gap-1.5 text-xs">
                            <div className="w-3 h-3 rounded bg-pulse-cyan/60" />
                            <span className="text-gray-300">Your Organization ({primeShare}%)</span>
                        </div>
                        {activePartners.map((partner, idx) => (
                            <div key={partner.id} className="flex items-center gap-1.5 text-xs">
                                <div 
                                    className="w-3 h-3 rounded"
                                    style={{ backgroundColor: colors[idx % colors.length] }}
                                />
                                <span className="text-gray-300">{partner.name} ({partner.workShare}%)</span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // Agreement Alerts Component
        const AgreementAlerts = ({ partners }) => {
            const alerts = [];
            
            partners.forEach(partner => {
                if (partner.relationship === 'Terminated') return;
                
                partner.agreements.forEach(agreement => {
                    const status = getAgreementStatus(agreement.expires);
                    const daysUntil = getDaysUntil(agreement.expires);
                    
                    if (status.urgent || daysUntil <= 90) {
                        alerts.push({
                            partner: partner.name,
                            partnerId: partner.id,
                            type: agreement.type,
                            expires: agreement.expires,
                            daysUntil,
                            ...status
                        });
                    }
                });
            });
            
            alerts.sort((a, b) => a.daysUntil - b.daysUntil);
            
            if (alerts.length === 0) {
                return (
                    <div className="glass-card rounded-xl p-4">
                        <h3 className="text-sm font-semibold text-white mb-3 flex items-center gap-2">
                            <span>üîî</span> Agreement Alerts
                        </h3>
                        <div className="text-center py-4 text-gray-400 text-sm">
                            ‚úÖ No urgent agreement renewals needed
                        </div>
                    </div>
                );
            }
            
            return (
                <div className="glass-card rounded-xl p-4">
                    <h3 className="text-sm font-semibold text-white mb-3 flex items-center gap-2">
                        <span>üîî</span> Agreement Alerts
                        <span className="px-2 py-0.5 rounded-full bg-danger/20 text-danger text-xs">
                            {alerts.filter(a => a.urgent).length} Urgent
                        </span>
                    </h3>
                    
                    <div className="space-y-2 max-h-64 overflow-y-auto">
                        {alerts.map((alert, idx) => (
                            <div 
                                key={idx}
                                className={`p-3 rounded-lg border ${alert.urgent ? 'bg-danger/10 border-danger/30 alert-pulse' : 'bg-warning/10 border-warning/30'}`}
                            >
                                <div className="flex items-center justify-between">
                                    <div>
                                        <span className="text-sm font-medium text-white">{alert.partner}</span>
                                        <span className="text-xs text-gray-400 ml-2">‚Ä¢ {alert.type}</span>
                                    </div>
                                    <span className={`text-xs font-medium ${alert.color}`}>
                                        {alert.daysUntil < 0 ? `${Math.abs(alert.daysUntil)} days ago` : `${alert.daysUntil} days`}
                                    </span>
                                </div>
                                <div className="text-xs text-gray-400 mt-1">
                                    Expires: {new Date(alert.expires).toLocaleDateString()}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // Partner Scorecard Component
        const PartnerScorecard = ({ scorecard, name }) => {
            const metrics = [
                { key: 'onTime', label: 'On-Time Delivery', icon: '‚è±Ô∏è' },
                { key: 'quality', label: 'Quality Score', icon: '‚ú®' },
                { key: 'communication', label: 'Communication', icon: 'üí¨' },
                { key: 'compliance', label: 'Compliance', icon: 'üìã' }
            ];
            
            const getScoreColor = (score) => {
                if (score >= 90) return 'text-success';
                if (score >= 75) return 'text-warning';
                return 'text-danger';
            };
            
            const avgScore = Math.round(Object.values(scorecard).reduce((a, b) => a + b, 0) / 4);
            
            return (
                <div className="space-y-3">
                    <div className="flex items-center justify-between">
                        <span className="text-sm font-medium text-gray-300">Performance Scorecard</span>
                        <span className={`text-lg font-bold ${getScoreColor(avgScore)}`}>
                            {avgScore}%
                        </span>
                    </div>
                    
                    {metrics.map(metric => (
                        <div key={metric.key}>
                            <div className="flex items-center justify-between text-xs mb-1">
                                <span className="text-gray-400">{metric.icon} {metric.label}</span>
                                <span className={getScoreColor(scorecard[metric.key])}>
                                    {scorecard[metric.key]}%
                                </span>
                            </div>
                            <div className="h-1.5 bg-gray-700 rounded-full overflow-hidden">
                                <div 
                                    className={`h-full rounded-full transition-all duration-500 ${
                                        scorecard[metric.key] >= 90 ? 'bg-success' :
                                        scorecard[metric.key] >= 75 ? 'bg-warning' : 'bg-danger'
                                    }`}
                                    style={{ width: `${scorecard[metric.key]}%` }}
                                />
                            </div>
                        </div>
                    ))}
                </div>
            );
        };

        // Partner History Timeline
        const PartnerHistory = ({ history }) => {
            const getEventIcon = (type) => {
                switch(type) {
                    case 'positive': return '‚úÖ';
                    case 'negative': return '‚ùå';
                    case 'warning': return '‚ö†Ô∏è';
                    default: return 'üìå';
                }
            };
            
            const getEventColor = (type) => {
                switch(type) {
                    case 'positive': return 'border-success/50 bg-success/10';
                    case 'negative': return 'border-danger/50 bg-danger/10';
                    case 'warning': return 'border-warning/50 bg-warning/10';
                    default: return 'border-gray-500/50 bg-gray-500/10';
                }
            };
            
            return (
                <div className="space-y-2">
                    <span className="text-sm font-medium text-gray-300">Relationship History</span>
                    <div className="space-y-2 max-h-48 overflow-y-auto">
                        {history.map((event, idx) => (
                            <div 
                                key={idx}
                                className={`p-2 rounded-lg border ${getEventColor(event.type)}`}
                            >
                                <div className="flex items-start gap-2">
                                    <span>{getEventIcon(event.type)}</span>
                                    <div className="flex-1">
                                        <p className="text-xs text-white">{event.event}</p>
                                        <p className="text-xs text-gray-500 mt-1">
                                            {new Date(event.date).toLocaleDateString()}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // Partner Card Component
        const PartnerCard = ({ partner, roleConfig, onSelect, isSelected }) => (
            <div 
                onClick={() => onSelect(partner)}
                className={`partner-card glass-card rounded-xl p-4 cursor-pointer ${
                    isSelected ? 'ring-2 ring-pulse-cyan' : ''
                }`}
            >
                <div className="flex items-start justify-between mb-3">
                    <div>
                        <h3 className="text-base font-semibold text-white">{partner.name}</h3>
                        <div className="flex items-center gap-2 mt-1">
                            <span className="text-xs text-gray-400">{partner.type}</span>
                            <span className={`px-2 py-0.5 rounded-full text-xs border ${getRelationshipBadge(partner.relationship)}`}>
                                {partner.relationship}
                            </span>
                        </div>
                    </div>
                    <span className={`px-2 py-1 rounded-lg text-xs font-medium border ${getOverallRiskBadge(partner.overallRisk)}`}>
                        {partner.overallRisk} Risk
                    </span>
                </div>
                
                <RiskMatrix risks={partner.risks} showDetails={false} roleConfig={roleConfig} />
                
                <div className="mt-3 pt-3 border-t border-gray-700">
                    <div className="flex items-center justify-between text-xs">
                        <span className="text-gray-400">Work Share</span>
                        <span className="text-pulse-cyan font-medium">{partner.workShare}%</span>
                    </div>
                    <div className="flex items-center justify-between text-xs mt-1">
                        <span className="text-gray-400">Active Contracts</span>
                        <span className="text-white">{partner.contracts.length}</span>
                    </div>
                </div>
                
                {partner.agreements.some(a => getAgreementStatus(a.expires).urgent) && (
                    <div className="mt-2 p-2 rounded-lg bg-danger/10 border border-danger/30">
                        <span className="text-xs text-danger">‚ö†Ô∏è Agreement expiring soon</span>
                    </div>
                )}
            </div>
        );

        // Partner Detail Panel
        const PartnerDetailPanel = ({ partner, roleConfig, onClose }) => {
            if (!partner) return null;
            
            return (
                <div className="glass-card rounded-xl p-6 space-y-6">
                    <div className="flex items-start justify-between">
                        <div>
                            <h2 className="text-xl font-bold text-white">{partner.name}</h2>
                            <div className="flex items-center gap-2 mt-1">
                                <span className="text-sm text-gray-400">{partner.type}</span>
                                <span className={`px-2 py-0.5 rounded-full text-xs border ${getRelationshipBadge(partner.relationship)}`}>
                                    {partner.relationship}
                                </span>
                                <span className={`px-2 py-0.5 rounded-full text-xs border ${getOverallRiskBadge(partner.overallRisk)}`}>
                                    {partner.overallRisk} Risk
                                </span>
                            </div>
                        </div>
                        <button 
                            onClick={onClose}
                            className="text-gray-400 hover:text-white"
                        >
                            ‚úï
                        </button>
                    </div>
                    
                    {/* Contact Info */}
                    <div className="p-3 bg-navy-mid rounded-lg">
                        <h4 className="text-xs font-semibold text-gray-400 uppercase mb-2">Contact</h4>
                        <p className="text-sm text-white">{partner.keyPersonnel}</p>
                        <p className="text-xs text-pulse-cyan">{partner.email}</p>
                        <p className="text-xs text-gray-400">{partner.phone}</p>
                    </div>
                    
                    {/* Risk Matrix Detailed */}
                    <div>
                        <h4 className="text-xs font-semibold text-gray-400 uppercase mb-2">Risk Assessment</h4>
                        <RiskMatrix risks={partner.risks} showDetails={true} roleConfig={roleConfig} />
                    </div>
                    
                    {/* Scorecard */}
                    <PartnerScorecard scorecard={partner.scorecard} name={partner.name} />
                    
                    {/* Agreements */}
                    <div>
                        <h4 className="text-xs font-semibold text-gray-400 uppercase mb-2">Agreements</h4>
                        <div className="space-y-2">
                            {partner.agreements.map((agreement, idx) => {
                                const status = getAgreementStatus(agreement.expires);
                                return (
                                    <div key={idx} className="flex items-center justify-between p-2 bg-navy-mid rounded-lg">
                                        <div>
                                            <span className="text-sm text-white">{agreement.type}</span>
                                            <p className="text-xs text-gray-400">
                                                Expires: {new Date(agreement.expires).toLocaleDateString()}
                                            </p>
                                        </div>
                                        <span className={`text-xs font-medium ${status.color}`}>
                                            {status.status}
                                        </span>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                    
                    {/* Certifications */}
                    <div>
                        <h4 className="text-xs font-semibold text-gray-400 uppercase mb-2">Certifications</h4>
                        <div className="flex flex-wrap gap-1">
                            {partner.certifications.map((cert, idx) => (
                                <span key={idx} className="px-2 py-1 bg-navy-mid rounded text-xs text-gray-300">
                                    {cert}
                                </span>
                            ))}
                        </div>
                    </div>
                    
                    {/* NAICS Codes */}
                    <div>
                        <h4 className="text-xs font-semibold text-gray-400 uppercase mb-2">NAICS Alignment</h4>
                        <div className="flex flex-wrap gap-1">
                            {partner.naicsMatch.map((code, idx) => (
                                <span key={idx} className="px-2 py-1 bg-pulse-cyan/10 border border-pulse-cyan/30 rounded text-xs text-pulse-cyan">
                                    {code}
                                </span>
                            ))}
                        </div>
                    </div>
                    
                    {/* History */}
                    <PartnerHistory history={partner.history} />
                    
                    {/* Action Buttons */}
                    {roleConfig.canEdit && partner.relationship !== 'Terminated' && (
                        <div className="flex gap-2 pt-4 border-t border-gray-700">
                            <button className="flex-1 px-4 py-2 bg-pulse-cyan/20 text-pulse-cyan rounded-lg text-sm hover:bg-pulse-cyan/30 transition-colors">
                                Edit Partner
                            </button>
                            <button className="flex-1 px-4 py-2 bg-warning/20 text-warning rounded-lg text-sm hover:bg-warning/30 transition-colors">
                                Change Status
                            </button>
                            {roleConfig.canTerminate && (
                                <button className="px-4 py-2 bg-danger/20 text-danger rounded-lg text-sm hover:bg-danger/30 transition-colors">
                                    Terminate
                                </button>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        // Summary Stats Component
        const SummaryStats = ({ partners }) => {
            const active = partners.filter(p => p.relationship === 'Active').length;
            const watch = partners.filter(p => p.relationship === 'Watch').length;
            const terminated = partners.filter(p => p.relationship === 'Terminated').length;
            const urgentAlerts = partners.reduce((count, p) => {
                if (p.relationship === 'Terminated') return count;
                return count + p.agreements.filter(a => getAgreementStatus(a.expires).urgent).length;
            }, 0);
            
            const stats = [
                { label: 'Active Partners', value: active, color: 'text-success', icon: '‚úÖ' },
                { label: 'On Watch', value: watch, color: 'text-warning', icon: 'üëÅÔ∏è' },
                { label: 'Terminated', value: terminated, color: 'text-danger', icon: 'üö´' },
                { label: 'Urgent Alerts', value: urgentAlerts, color: urgentAlerts > 0 ? 'text-danger' : 'text-gray-400', icon: 'üîî' }
            ];
            
            return (
                <div className="grid grid-cols-2 lg:grid-cols-4 gap-3">
                    {stats.map((stat, idx) => (
                        <div key={idx} className="glass-card rounded-xl p-4">
                            <div className="flex items-center justify-between">
                                <span className="text-2xl">{stat.icon}</span>
                                <span className={`text-2xl font-bold ${stat.color}`}>{stat.value}</span>
                            </div>
                            <p className="text-xs text-gray-400 mt-2">{stat.label}</p>
                        </div>
                    ))}
                </div>
            );
        };

        // Filter Bar Component
        const FilterBar = ({ filter, setFilter, search, setSearch }) => (
            <div className="glass-card rounded-xl p-4 flex flex-wrap items-center gap-4">
                <div className="flex-1 min-w-[200px]">
                    <input
                        type="text"
                        placeholder="Search partners..."
                        value={search}
                        onChange={(e) => setSearch(e.target.value)}
                        className="w-full px-4 py-2 bg-navy-mid border border-pulse-cyan/30 rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-pulse-cyan"
                    />
                </div>
                <div className="flex items-center gap-2">
                    <span className="text-xs text-gray-400">Status:</span>
                    {['All', 'Active', 'Watch', 'Terminated'].map(status => (
                        <button
                            key={status}
                            onClick={() => setFilter(status)}
                            className={`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${
                                filter === status 
                                    ? 'bg-pulse-cyan text-deep-navy' 
                                    : 'bg-navy-mid text-gray-300 hover:bg-navy-light'
                            }`}
                        >
                            {status}
                        </button>
                    ))}
                </div>
            </div>
        );

        // Main App Component
        const FrenemyProtocol = () => {
            const [currentRole, setCurrentRole] = useState('CEO');
            const [partners] = useState(DEMO_PARTNERS);
            const [selectedPartner, setSelectedPartner] = useState(null);
            const [filter, setFilter] = useState('All');
            const [search, setSearch] = useState('');
            
            const roleConfig = ROLES[currentRole];
            
            const filteredPartners = useMemo(() => {
                return partners.filter(p => {
                    const matchesFilter = filter === 'All' || p.relationship === filter;
                    const matchesSearch = p.name.toLowerCase().includes(search.toLowerCase()) ||
                                         p.type.toLowerCase().includes(search.toLowerCase());
                    return matchesFilter && matchesSearch;
                });
            }, [partners, filter, search]);
            
            return (
                <div className="min-h-screen bg-deep-navy">
                    <Header currentRole={currentRole} setCurrentRole={setCurrentRole} />
                    
                    <main className="max-w-7xl mx-auto px-4 py-6 space-y-6">
                        {/* Page Title */}
                        <div className="flex items-center justify-between">
                            <div>
                                <h1 className="text-2xl font-bold text-white flex items-center gap-3">
                                    ü§ù Frenemy Protocol
                                </h1>
                                <p className="text-sm text-gray-400 mt-1">
                                    Teaming Partner Risk Assessment & Relationship Management
                                </p>
                            </div>
                            {roleConfig.canEdit && (
                                <button className="px-4 py-2 bg-pulse-cyan text-deep-navy rounded-lg text-sm font-medium hover:bg-pulse-cyan/90 transition-colors">
                                    + Add Partner
                                </button>
                            )}
                        </div>
                        
                        {/* Summary Stats */}
                        <SummaryStats partners={partners} />
                        
                        {/* Work Share & Alerts Row */}
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
                            <WorkShareChart partners={partners} />
                            <AgreementAlerts partners={partners} />
                        </div>
                        
                        {/* Filter Bar */}
                        <FilterBar 
                            filter={filter} 
                            setFilter={setFilter}
                            search={search}
                            setSearch={setSearch}
                        />
                        
                        {/* Main Content */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            {/* Partner Cards */}
                            <div className="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4">
                                {filteredPartners.map(partner => (
                                    <PartnerCard 
                                        key={partner.id}
                                        partner={partner}
                                        roleConfig={roleConfig}
                                        onSelect={setSelectedPartner}
                                        isSelected={selectedPartner?.id === partner.id}
                                    />
                                ))}
                                {filteredPartners.length === 0 && (
                                    <div className="col-span-2 text-center py-12 text-gray-400">
                                        No partners match your search criteria
                                    </div>
                                )}
                            </div>
                            
                            {/* Detail Panel */}
                            <div className="lg:col-span-1">
                                {selectedPartner ? (
                                    <PartnerDetailPanel 
                                        partner={selectedPartner}
                                        roleConfig={roleConfig}
                                        onClose={() => setSelectedPartner(null)}
                                    />
                                ) : (
                                    <div className="glass-card rounded-xl p-8 text-center">
                                        <div className="text-4xl mb-4">üëà</div>
                                        <p className="text-gray-400">
                                            Select a partner to view details
                                        </p>
                                    </div>
                                )}
                            </div>
                        </div>
                        
                        {/* Access Restriction Notice */}
                        {roleConfig.access !== 'full' && (
                            <div className="glass-card rounded-xl p-4 border-warning/30">
                                <div className="flex items-center gap-3">
                                    <span className="text-xl">üîí</span>
                                    <div>
                                        <p className="text-sm text-warning font-medium">Limited Access Mode</p>
                                        <p className="text-xs text-gray-400">
                                            Your role ({roleConfig.label}) has restricted access to sensitive partner data.
                                            {!roleConfig.viewFinancial && ' Financial risk data is hidden.'}
                                            {!roleConfig.viewOCI && ' OCI assessments are hidden.'}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>
                    
                    {/* Footer */}
                    <footer className="border-t border-pulse-cyan/10 mt-12">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <div className="flex items-center justify-between text-xs text-gray-500">
                                <div className="flex items-center gap-4">
                                    <span>MissionPulse v12 ‚Ä¢ M11 Frenemy Protocol</span>
                                    <span>‚Ä¢</span>
                                    <span>Shield & Pulse UX v8.0</span>
                                </div>
                                <div className="px-3 py-1 bg-warning/10 border border-warning/30 rounded text-warning">
                                    AI GENERATED - REQUIRES HUMAN REVIEW
                                </div>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        // Render
        ReactDOM.createRoot(document.getElementById('root')).render(<FrenemyProtocol />);
    </script>
</body>
</html>
