<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse S142 - Compliance Checklist</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Space Grotesk',sans-serif;background:#00050F;min-height:100vh}.font-mono{font-family:'JetBrains Mono',monospace}@keyframes slideIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}@keyframes barFill{from{width:0%}}.animate-slide-in{animation:slideIn .4s ease-out forwards}.animate-pulse{animation:pulse 2s ease-in-out infinite}.animate-bar{animation:barFill .8s ease-out forwards}.glass-card{background:linear-gradient(135deg,rgba(15,23,42,.9) 0%,rgba(15,23,42,.7) 100%);backdrop-filter:blur(10px);border:1px solid rgba(0,229,250,.15)}.glass-card:hover{border-color:rgba(0,229,250,.3)}
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const{useState,useEffect}=React;
    const SUPABASE_URL='https://qdrtpnpnhkxvfmvfziop.supabase.co';const SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc4MjMwMTgsImV4cCI6MjA1MzM5OTAxOH0.gFHBoGjPMWjCGuJNdxMGPOBmGMHBp0jSTbxxcFKqkPQ';
    var sbClient;try{sbClient=supabase.createClient(SUPABASE_URL,SUPABASE_KEY)}catch(e){sbClient=null}

    const Icons={
      check:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7"/></svg>,
      shield:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>,
      alert:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>,
      document:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>,
      clock:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" strokeWidth={2}/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6l4 2"/></svg>,
    };
    const Icon=({name,className="w-4 h-4"})=>{const C=Icons[name];return C?<span className={`inline-block ${className}`}><C/></span>:null};

    const CHECKLIST_SECTIONS=[
      {id:'section_l',name:'Section L Cross-Check',desc:'Solicitation Instructions Compliance',items:[
        {id:1,req:'L.1',desc:'Technical Volume does not exceed page limit',limit:'85 pages',status:'pass',notes:'83 pages — within limit'},
        {id:2,req:'L.2',desc:'Management Volume does not exceed page limit',limit:'42 pages',status:'pass',notes:'42 pages — at limit'},
        {id:3,req:'L.3',desc:'Past Performance volume includes 3-5 references',limit:'3-5 refs',status:'pass',notes:'4 references included'},
        {id:4,req:'L.4',desc:'All volumes use required font (Times New Roman 12pt)',limit:'TNR 12pt',status:'fail',notes:'Section 3.2 uses 11pt — FIX REQUIRED'},
        {id:5,req:'L.5',desc:'Margins are 1" on all sides',limit:'1" margins',status:'pass',notes:'Verified across all volumes'},
        {id:6,req:'L.6',desc:'Executive Summary does not exceed 2 pages',limit:'2 pages',status:'pass',notes:'1.5 pages'},
        {id:7,req:'L.7',desc:'Proposal transmitted via designated portal',limit:'SAM.gov',status:'pending',notes:'Awaiting final upload'},
        {id:8,req:'L.8',desc:'All required certifications and representations included',limit:'Required',status:'pass',notes:'All certs verified'},
      ]},
      {id:'section_m',name:'Section M Cross-Check',desc:'Evaluation Criteria Alignment',items:[
        {id:9,req:'M.1',desc:'Technical Approach addresses all evaluation subfactors',limit:'5 subfactors',status:'pass',notes:'All 5 addressed with traceability'},
        {id:10,req:'M.2',desc:'Management Plan demonstrates understanding of PWS',limit:'PWS aligned',status:'pass',notes:'PWS cross-reference matrix included'},
        {id:11,req:'M.3',desc:'Past Performance relevance matches evaluation criteria',limit:'Scope/size/complexity',status:'warn',notes:'1 reference lacks complexity match — REVIEW'},
        {id:12,req:'M.4',desc:'Price volume aligns with IGCE expectations',limit:'Within range',status:'pass',notes:'Within 5% of IGCE estimate'},
        {id:13,req:'M.5',desc:'Key personnel resumes meet qualification requirements',limit:'Per SOW',status:'pass',notes:'All 4 key personnel qualified'},
        {id:14,req:'M.6',desc:'Small business subcontracting plan included',limit:'Required',status:'pass',notes:'30% SB goal documented'},
      ]},
      {id:'format',name:'Format & Style Verification',desc:'Document Formatting QC',items:[
        {id:15,req:'F.1',desc:'Headers and footers consistent across all volumes',limit:'Required',status:'pass',notes:'Company name, volume title, page numbers verified'},
        {id:16,req:'F.2',desc:'Table of Contents is accurate and matches page numbers',limit:'Required',status:'warn',notes:'Tech Volume TOC off by 1 page after final edit — UPDATE'},
        {id:17,req:'F.3',desc:'All figures have captions and are numbered sequentially',limit:'Required',status:'pass',notes:'8 figures, all captioned correctly'},
        {id:18,req:'F.4',desc:'All tables have titles and are numbered sequentially',limit:'Required',status:'pass',notes:'12 tables, all titled correctly'},
        {id:19,req:'F.5',desc:'Acronym list is complete and accurate',limit:'Required',status:'pass',notes:'47 acronyms listed and verified'},
        {id:20,req:'F.6',desc:'No tracked changes, comments, or metadata remaining',limit:'Clean docs',status:'pass',notes:'All docs scrubbed clean'},
        {id:21,req:'F.7',desc:'PDF conversion preserves all formatting',limit:'Required',status:'pending',notes:'Final PDF conversion pending'},
        {id:22,req:'F.8',desc:'File naming convention matches solicitation requirements',limit:'Per RFP',status:'pass',notes:'All files named per RFP Section L.3.a'},
      ]},
      {id:'compliance',name:'Compliance & Regulatory',desc:'Mandatory Compliance Checks',items:[
        {id:23,req:'C.1',desc:'DUNS/UEI number verified and active in SAM.gov',limit:'Active',status:'pass',notes:'UEI verified active as of 2/18/2026'},
        {id:24,req:'C.2',desc:'Organizational Conflict of Interest (OCI) statement included',limit:'Required',status:'pass',notes:'OCI statement signed by CEO'},
        {id:25,req:'C.3',desc:'Section 508 compliance for all electronic documents',limit:'WCAG 2.1',status:'warn',notes:'2 images missing alt text — FIX'},
        {id:26,req:'C.4',desc:'CUI markings applied where required',limit:'Per DFARS',status:'pass',notes:'All CUI portions marked correctly'},
        {id:27,req:'C.5',desc:'No proprietary data without proper legends',limit:'Required',status:'pass',notes:'Proprietary legends on Tech Vol'},
        {id:28,req:'C.6',desc:'Signed by authorized representative',limit:'Required',status:'pending',notes:'Awaiting CEO signature on SF1449'},
      ]},
    ];

    const ConnectionIndicator=({connected})=>(
      <div className="flex items-center gap-2 px-3 py-1 rounded-full text-xs font-mono" style={{background:connected?'rgba(0,255,136,0.1)':'rgba(255,184,0,0.1)',border:`1px solid ${connected?'rgba(0,255,136,0.3)':'rgba(255,184,0,0.3)'}`}}>
        <div className={`w-2 h-2 rounded-full ${connected?'bg-green-400':'bg-amber-400 animate-pulse'}`}/>
        <span style={{color:connected?'#00ff88':'#ffb800'}}>{connected?'LIVE':'DEMO'}</span>
      </div>
    );

    const App=()=>{
      const[connected,setConnected]=useState(false);
      const[userRole]=useState('CEO');
      const[checks,setChecks]=useState(()=>{
        const map={};
        CHECKLIST_SECTIONS.forEach(s=>s.items.forEach(i=>{map[i.id]=i.status}));
        return map;
      });
      const[expandedSection,setExpandedSection]=useState('section_l');

      useEffect(()=>{const a=['CEO','COO','CAP','PM','QA','Admin'];if(!a.includes(userRole))return},[userRole]);
      useEffect(()=>{if(!sbClient)return;(async()=>{try{const{data}=await sbClient.from('opportunities').select('id').limit(1);if(data)setConnected(true)}catch(e){}})()},[]);

      const allItems=CHECKLIST_SECTIONS.flatMap(s=>s.items);
      const total=allItems.length;
      const passed=Object.values(checks).filter(s=>s==='pass').length;
      const failed=Object.values(checks).filter(s=>s==='fail').length;
      const warnings=Object.values(checks).filter(s=>s==='warn').length;
      const pending=Object.values(checks).filter(s=>s==='pending').length;
      const pctComplete=Math.round((passed/total)*100);

      const toggleStatus=(id)=>{
        const cycle={pass:'fail',fail:'warn',warn:'pending',pending:'pass'};
        setChecks(prev=>({...prev,[id]:cycle[prev[id]]||'pass'}));
      };

      const StatusIcon=({status,size="w-5 h-5"})=>{
        if(status==='pass')return <div className={`${size} rounded-full bg-green-500/20 border border-green-500/40 flex items-center justify-center`}><Icon name="check" className="w-3 h-3 text-green-400"/></div>;
        if(status==='fail')return <div className={`${size} rounded-full bg-red-500/20 border border-red-500/40 flex items-center justify-center text-xs font-bold text-red-400`}>✗</div>;
        if(status==='warn')return <div className={`${size} rounded-full bg-amber-500/20 border border-amber-500/40 flex items-center justify-center`}><Icon name="alert" className="w-3 h-3 text-amber-400"/></div>;
        return <div className={`${size} rounded-full bg-slate-500/20 border border-slate-500/40 flex items-center justify-center`}><Icon name="clock" className="w-3 h-3 text-slate-400"/></div>;
      };

      return(
        <div className="min-h-screen" style={{background:'#00050F'}}>
          <div className="max-w-7xl mx-auto p-6">
            <div className="flex items-center justify-between mb-6">
              <div><div className="flex items-center gap-3 mb-1"><h1 className="text-2xl font-bold text-white">Compliance Checklist</h1><ConnectionIndicator connected={connected}/></div>
              <p className="text-sm text-slate-400">Pre-submission QC, Section L/M cross-check & format verification</p></div>
              <div className="text-right">
                <div className="text-3xl font-mono font-bold" style={{color:pctComplete>=90?'#00ff88':pctComplete>=70?'#ffb800':'#ff4444'}}>{pctComplete}%</div>
                <div className="text-xs text-slate-500">Complete</div>
              </div>
            </div>

            {/* Overall progress bar */}
            <div className="glass-card rounded-xl p-4 mb-6">
              <div className="h-4 rounded-full bg-slate-700/30 overflow-hidden flex">
                <div className="h-full bg-green-500/50 transition-all" style={{width:`${(passed/total)*100}%`}}/>
                <div className="h-full bg-amber-500/50 transition-all" style={{width:`${(warnings/total)*100}%`}}/>
                <div className="h-full bg-red-500/50 transition-all" style={{width:`${(failed/total)*100}%`}}/>
                <div className="h-full bg-slate-500/30 transition-all" style={{width:`${(pending/total)*100}%`}}/>
              </div>
              <div className="flex items-center gap-6 mt-2">
                {[{l:'Pass',v:passed,c:'#00ff88'},{l:'Fail',v:failed,c:'#ff4444'},{l:'Warning',v:warnings,c:'#ffb800'},{l:'Pending',v:pending,c:'#64748b'}].map((s,i)=>(
                  <span key={i} className="flex items-center gap-1.5 text-xs font-mono"><div className="w-3 h-3 rounded" style={{background:`${s.c}60`}}/><span style={{color:s.c}}>{s.v}</span><span className="text-slate-500">{s.l}</span></span>
                ))}
              </div>
            </div>

            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
              {[{label:'Total Checks',value:total,color:'#00E5FA'},{label:'Passed',value:passed,color:'#00ff88'},{label:'Failed',value:failed,color:'#ff4444'},{label:'Warnings',value:warnings,color:'#ffb800'}].map((k,i)=>(
                <div key={i} className="glass-card rounded-xl p-4 animate-slide-in" style={{animationDelay:`${i*.05}s`}}>
                  <span className="text-xs text-slate-500 font-mono uppercase">{k.label}</span>
                  <div className="text-2xl font-mono font-bold mt-1" style={{color:k.color}}>{k.value}</div>
                </div>
              ))}
            </div>

            {/* Sections */}
            <div className="space-y-4">
              {CHECKLIST_SECTIONS.map((section,si)=>{
                const sectionPassed=section.items.filter(i=>checks[i.id]==='pass').length;
                const sectionTotal=section.items.length;
                const sectionPct=Math.round((sectionPassed/sectionTotal)*100);
                const hasFails=section.items.some(i=>checks[i.id]==='fail');
                const hasWarns=section.items.some(i=>checks[i.id]==='warn');
                const isExpanded=expandedSection===section.id;

                return(
                  <div key={section.id} className="glass-card rounded-xl overflow-hidden animate-slide-in" style={{animationDelay:`${si*.08}s`}}>
                    <div onClick={()=>setExpandedSection(isExpanded?null:section.id)} className="flex items-center justify-between p-5 cursor-pointer hover:bg-slate-800/20 transition">
                      <div className="flex items-center gap-4">
                        <div className={`w-10 h-10 rounded-lg flex items-center justify-center text-sm font-mono font-bold ${sectionPct===100?'bg-green-500/10 text-green-400':hasFails?'bg-red-500/10 text-red-400':'bg-amber-500/10 text-amber-400'}`}>{sectionPct}%</div>
                        <div><h3 className="text-white font-semibold">{section.name}</h3><p className="text-xs text-slate-500">{section.desc} · {sectionPassed}/{sectionTotal} passed</p></div>
                        {hasFails&&<span className="px-2 py-0.5 rounded text-xs font-mono font-bold bg-red-500/10 text-red-400 border border-red-500/20">FAIL</span>}
                        {!hasFails&&hasWarns&&<span className="px-2 py-0.5 rounded text-xs font-mono font-bold bg-amber-500/10 text-amber-400 border border-amber-500/20">REVIEW</span>}
                        {!hasFails&&!hasWarns&&sectionPct===100&&<span className="px-2 py-0.5 rounded text-xs font-mono font-bold bg-green-500/10 text-green-400 border border-green-500/20">CLEAR</span>}
                      </div>
                      <span className="text-slate-500">{isExpanded?'▾':'▸'}</span>
                    </div>
                    {isExpanded&&(
                      <div className="border-t border-slate-700/20">
                        {section.items.map((item,ii)=>(
                          <div key={item.id} className="flex items-center gap-4 px-5 py-3 border-b border-slate-700/10 last:border-0 hover:bg-slate-800/10 transition">
                            <button onClick={()=>toggleStatus(item.id)} className="shrink-0"><StatusIcon status={checks[item.id]}/></button>
                            <span className="text-xs font-mono text-cyan-400 font-bold w-10 shrink-0">{item.req}</span>
                            <div className="flex-1">
                              <span className="text-sm text-white">{item.desc}</span>
                              {item.limit&&<span className="text-xs text-slate-500 ml-2">({item.limit})</span>}
                            </div>
                            <span className={`text-xs font-mono ${checks[item.id]==='fail'?'text-red-400 font-bold':checks[item.id]==='warn'?'text-amber-400':'text-slate-500'}`}>{item.notes}</span>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                );
              })}
            </div>

            {/* Submission readiness */}
            <div className={`mt-6 p-5 rounded-xl border ${failed>0?'bg-red-500/5 border-red-500/30':'pending>0?bg-amber-500/5 border-amber-500/30':'bg-green-500/5 border-green-500/30'}`}>
              <div className="flex items-center gap-3">
                {failed>0?<Icon name="alert" className="w-6 h-6 text-red-400"/>:pending>0?<Icon name="clock" className="w-6 h-6 text-amber-400"/>:<Icon name="check" className="w-6 h-6 text-green-400"/>}
                <div>
                  <h3 className={`font-bold ${failed>0?'text-red-400':pending>0?'text-amber-400':'text-green-400'}`}>
                    {failed>0?'NOT READY FOR SUBMISSION':pending>0?'PENDING ITEMS REMAIN':'READY FOR SUBMISSION'}
                  </h3>
                  <p className="text-xs text-slate-400 mt-0.5">
                    {failed>0?`${failed} failed check(s) must be resolved before submission.`:pending>0?`${pending} item(s) pending completion.`:'All compliance checks passed. Proposal is clear for submission.'}
                  </p>
                </div>
              </div>
            </div>

            <div className="mt-8 text-center"><div className="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-amber-500/5 border border-amber-500/20"><Icon name="shield" className="w-3.5 h-3.5 text-amber-500"/><span className="text-xs text-amber-500/80 font-mono">AI GENERATED — REQUIRES HUMAN REVIEW</span></div></div>
          </div>
        </div>
      );
    };
    ReactDOM.render(<App/>,document.getElementById('root'));
  </script>
</body>
</html>
