<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse v12 | AI Proposal Command Center</title>
  <meta name="description" content="Enterprise proposal management with 11-role RBAC, AI agent swarm, Shipley methodology">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root{--mmt-cyan:#00E5FA;--mmt-navy:#00050F;--mmt-slate:#1e293b;--mmt-text:#e2e8f0}
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;background:var(--mmt-navy);color:var(--mmt-text);min-height:100vh}
    .font-mono{font-family:'JetBrains Mono',monospace}
    ::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-track{background:#0a1628}::-webkit-scrollbar-thumb{background:#334155;border-radius:3px}
    .glass-panel{background:rgba(15,23,42,0.7);backdrop-filter:blur(12px);border:1px solid rgba(0,229,250,0.12);border-radius:12px}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    @keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
    @keyframes spin{to{transform:rotate(360deg)}}
    .animate-fadeIn{animation:fadeIn 0.4s ease-out}
    .animate-slideUp{animation:slideUp 0.5s ease-out}
    .animate-pulse{animation:pulse 2s infinite}
    .animate-spin{animation:spin 1s linear infinite}
    .hover-lift{transition:transform 0.2s,box-shadow 0.2s}
    .hover-lift:hover{transform:translateY(-2px);box-shadow:0 8px 25px -5px rgba(0,229,250,0.15)}
    .progress-bar{transition:width 0.8s ease-out}
  </style>
</head>
<body class="overflow-hidden">
<div id="root"></div>
<script type="text/babel">
// ============================================================
// MISSIONPULSE v12 ULTIMATE - COMPLETE PLATFORM
// All 17 Modules | 11 Shipley Roles | Full RBAC | Demo Flow | AI Chat
// ¬© 2026 Mission Meets Tech
// ============================================================
const{useState,useEffect,useMemo,useCallback,useRef,createContext,useContext}=React;

// CONFIG
const CONFIG={
  SUPABASE_URL:'https://qlbvbfaprymzdqywcsiq.supabase.co',
  SUPABASE_KEY:'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFsYnZiZmFwcnltemRxeXdjc2lxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc3NjQ4NjcsImV4cCI6MjA1MzM0MDg2N30.QEnpsflnMM9i9xvYPHJlJO7wGPazPTvTWSFIohHcA',
  API_URL:'https://missionpulse-api.onrender.com'
};
const supabase=window.supabase.createClient(CONFIG.SUPABASE_URL,CONFIG.SUPABASE_KEY);

// CONTEXT
const RoleContext=createContext(null);

// ============================================================
// 11 SHIPLEY METHODOLOGY ROLES
// ============================================================
const ROLES=[
  {id:'CEO',name:'CEO',fullName:'Mary Womack',icon:'crown',color:'#fbbf24',bgColor:'rgba(251,191,36,0.2)',shipleyFunction:'Executive Approver',description:'Final Go/No-Go authority',access:['dashboard','pipeline','warroom','swarm','launch_roi','orals','frenemy','post_award']},
  {id:'COO',name:'COO',fullName:'David Chen',icon:'briefcase',color:'#f472b6',bgColor:'rgba(244,114,182,0.2)',shipleyFunction:'Capture Oversight',description:'Resource allocation',access:['dashboard','pipeline','warroom','swarm','hitl','frenemy','launch_roi','post_award','pricing']},
  {id:'CAP',name:'Capture',fullName:'Michael Torres',icon:'target',color:'#a78bfa',bgColor:'rgba(167,139,250,0.2)',shipleyFunction:'Capture Manager',description:'Win strategy owner',access:['dashboard','pipeline','blackhat','warroom','frenemy','swarm']},
  {id:'PM',name:'Proposal Mgr',fullName:'Lisa Martinez',icon:'clipboard',color:'#22d3ee',bgColor:'rgba(34,211,238,0.2)',shipleyFunction:'Proposal Manager',description:'Schedule & compliance',access:['dashboard','pipeline','warroom','swarm','compliance','writer','hitl','launch_roi','post_award','orals']},
  {id:'SA',name:'Solution Arch',fullName:'Sarah Chen',icon:'cpu',color:'#34d399',bgColor:'rgba(52,211,153,0.2)',shipleyFunction:'Technical Lead',description:'Technical approach',access:['dashboard','writer','compliance','contracts','orals','swarm']},
  {id:'FIN',name:'Pricing',fullName:'Jennifer Park',icon:'dollarSign',color:'#f97316',bgColor:'rgba(249,115,22,0.2)',shipleyFunction:'Volume Lead',description:'Price-to-win',access:['dashboard','pricing','contracts','launch_roi','swarm']},
  {id:'CON',name:'Contracts',fullName:'Robert Williams',icon:'scale',color:'#ef4444',bgColor:'rgba(239,68,68,0.2)',shipleyFunction:'Compliance',description:'FAR/DFARS expert',access:['dashboard','compliance','contracts','swarm','hitl']},
  {id:'DEL',name:'Delivery',fullName:'Amanda Foster',icon:'users',color:'#06b6d4',bgColor:'rgba(6,182,212,0.2)',shipleyFunction:'Staffing',description:'Resource planning',access:['dashboard','swarm','writer','post_award','orals']},
  {id:'QA',name:'QA Lead',fullName:'James Thompson',icon:'checkCircle',color:'#84cc16',bgColor:'rgba(132,204,22,0.2)',shipleyFunction:'Quality',description:'Review standards',access:['dashboard','hitl','compliance','swarm','writer']},
  {id:'Partner',name:'Partner',fullName:'External',icon:'handshake',color:'#8b5cf6',bgColor:'rgba(139,92,246,0.2)',shipleyFunction:'Teaming Partner',description:'External access',access:['frenemy','swarm'],external:true},
  {id:'Admin',name:'Admin',fullName:'System Admin',icon:'settings',color:'#64748b',bgColor:'rgba(100,116,139,0.2)',shipleyFunction:'System Admin',description:'Full access',access:['dashboard','pipeline','warroom','swarm','compliance','contracts','writer','blackhat','pricing','hitl','orals','frenemy','launch_roi','post_award','playbook','admin','training']}
];

// ============================================================
// 17 MODULES
// ============================================================
const MODULES=[
  {id:'dashboard',name:'Mission Control',icon:'activity',color:'#00E5FA',category:'Command',description:'Executive Dashboard'},
  {id:'pipeline',name:'Pipeline Intel',icon:'filter',color:'#22d3ee',category:'Strategy',description:'Opportunity Tracking'},
  {id:'warroom',name:'War Room',icon:'swords',color:'#f97316',category:'Strategy',description:'Pursuit Strategy'},
  {id:'swarm',name:'Agent Swarm',icon:'cpu',color:'#a78bfa',category:'Strategy',description:'AI Assistants'},
  {id:'compliance',name:'RFP Shredder',icon:'fileCheck',color:'#8b5cf6',category:'Intelligence',description:'Compliance Matrix'},
  {id:'contracts',name:'Contract Scanner',icon:'scale',color:'#ef4444',category:'Intelligence',description:'Risk Analysis'},
  {id:'writer',name:'Iron Dome',icon:'penTool',color:'#10b981',category:'Intelligence',description:'AI Writing'},
  {id:'blackhat',name:'Black Hat',icon:'ghost',color:'#f59e0b',category:'Intelligence',description:'Competitive Intel',badge:'PRIVATE'},
  {id:'pricing',name:'Pricing Engine',icon:'calculator',color:'#ec4899',category:'Delivery',description:'LCAT & BOE',badge:'CUI'},
  {id:'hitl',name:'HITL Queue',icon:'eye',color:'#6366f1',category:'Delivery',description:'Review Queue'},
  {id:'orals',name:'Orals Studio',icon:'mic',color:'#f472b6',category:'Delivery',description:'Presentation Prep'},
  {id:'frenemy',name:'Frenemy Protocol',icon:'shield',color:'#22d3ee',category:'Delivery',description:'Partner Access'},
  {id:'launch_roi',name:'Launch & ROI',icon:'rocket',color:'#e879f9',category:'Command',description:'Submission'},
  {id:'post_award',name:'Post-Award',icon:'archive',color:'#a78bfa',category:'Command',description:'Transition'},
  {id:'playbook',name:'Playbook',icon:'star',color:'#fbbf24',category:'Admin',description:'Golden Examples'},
  {id:'admin',name:'Admin',icon:'sliders',color:'#cbd5e1',category:'Admin',description:'Settings',badge:'ADMIN'},
  {id:'training',name:'Training Hub',icon:'folder',color:'#10b981',category:'Admin',description:'Company Onboarding'}
];

const MODULE_CATEGORIES=[
  {id:'Strategy',name:'Strategy Phase',icon:'target'},
  {id:'Intelligence',name:'Intelligence Phase',icon:'search'},
  {id:'Delivery',name:'Delivery Phase',icon:'send'},
  {id:'Command',name:'Command Center',icon:'activity'},
  {id:'Admin',name:'Administration',icon:'settings'}
];

// ============================================================
// 9-SCENE DEMO FLOW
// ============================================================
const DEMO_SCENES=[
  {id:1,title:'Parking Lot Intel',subtitle:'Voice capture after customer meeting',icon:'üé§',module:'pipeline',color:'#00E5FA',description:'Capture critical intel from customer conversations instantly'},
  {id:2,title:'Instant Compliance',subtitle:'RFP shredding & matrix generation',icon:'üìÑ',module:'compliance',color:'#8B5CF6',description:'AI extracts requirements and builds compliance matrix'},
  {id:3,title:'Green Team Miracle',subtitle:'LCAT mapping & pricing',icon:'üí∞',module:'pricing',color:'#10B981',description:'Automated labor category mapping and BOE generation'},
  {id:4,title:'Iron Dome Drafter',subtitle:'CUI-aware AI writing',icon:'‚úçÔ∏è',module:'writer',color:'#EF4444',description:'AI generates compliant proposal sections'},
  {id:5,title:'Frenemy View',subtitle:'Partner data masking',icon:'üõ°Ô∏è',module:'frenemy',color:'#F59E0B',description:'Secure partner collaboration with dynamic masking'},
  {id:6,title:'Orals Studio',subtitle:'Presentation generation',icon:'üé§',module:'orals',color:'#A855F7',description:'AI-powered slide decks and talking points'},
  {id:7,title:'Crisis Room',subtitle:'EN/Amendment response',icon:'‚ö†Ô∏è',module:'warroom',color:'#EC4899',description:'Rapid response to government amendments'},
  {id:8,title:'Launch Sequence',subtitle:'Final submission countdown',icon:'üöÄ',module:'launch_roi',color:'#06B6D4',description:'Checklists and quality gates for submission'},
  {id:9,title:'The Handoff',subtitle:'Transition to delivery',icon:'ü§ù',module:'post_award',color:'#22C55E',description:'Seamless handoff from capture to delivery team'}
];

// ============================================================
// AI AGENTS
// ============================================================
const AI_AGENTS=[
  {id:'capture',name:'Capture Agent',icon:'üéØ',color:'#00E5FA',description:'Win strategy and capture intelligence'},
  {id:'strategy',name:'Strategy Agent',icon:'‚ôüÔ∏è',color:'#8B5CF6',description:'Competitive analysis and positioning'},
  {id:'compliance',name:'Compliance Agent',icon:'üìã',color:'#10B981',description:'FAR/DFARS requirements expert'},
  {id:'pricing',name:'Pricing Agent',icon:'üíµ',color:'#F59E0B',description:'Cost modeling and price-to-win'},
  {id:'writer',name:'Writer Agent',icon:'‚úçÔ∏è',color:'#EC4899',description:'Proposal section drafting'},
  {id:'contracts',name:'Contracts Agent',icon:'‚öñÔ∏è',color:'#EF4444',description:'Terms and conditions review'},
  {id:'orals',name:'Orals Coach',icon:'üé§',color:'#A855F7',description:'Presentation preparation'},
  {id:'blackhat',name:'Black Hat',icon:'üé≠',color:'#64748B',description:'Competitor simulation',restricted:true}
];

// ============================================================
// DEMO DATA
// ============================================================
const DEMO_OPPORTUNITIES=[
  {id:'OPP-2026-DHA-001',nickname:'DHA EHR Mod',title:'DHA MHS GENESIS Cloud Migration',agency:'DHA',ceiling:98450210,priority:'P-0',phase:'Pink Team',pWin:72,daysRemaining:37},
  {id:'OPP-2026-VA-003',nickname:'VA Claims AI',title:'VA Enterprise Cloud Hosting',agency:'VA',ceiling:45000000,priority:'P-1',phase:'Blue Team',pWin:58,daysRemaining:82},
  {id:'OPP-2026-CMS-008',nickname:'CMS Analytics',title:'CMS Data Analytics Modernization',agency:'CMS',ceiling:125000000,priority:'P-0',phase:'Red Team',pWin:68,daysRemaining:127},
  {id:'OPP-2026-IHS-012',nickname:'IHS Telehealth',title:'IHS Telehealth Expansion',agency:'IHS',ceiling:32000000,priority:'P-1',phase:'Capture',pWin:55,daysRemaining:156},
  {id:'OPP-2026-SSA-015',nickname:'SSA Legacy',title:'SSA Legacy Modernization',agency:'SSA',ceiling:200000000,priority:'P-2',phase:'Qualify',pWin:42,daysRemaining:210}
];

const DEMO_COMPLIANCE=[
  {ref:'PWS 4.3.1',title:'Health Data Interoperability',status:'HIGH RISK',risk:'RED',owner:'James Wong'},
  {ref:'PWS 4.3.2',title:'FedRAMP Authorization',status:'COMPLIANT',risk:'GREEN',owner:'Sarah Chen'},
  {ref:'PWS 4.4.1',title:'Key Personnel Requirements',status:'PARTIAL',risk:'YELLOW',owner:'Lisa Martinez'},
  {ref:'PWS 5.1.1',title:'Performance Metrics',status:'COMPLIANT',risk:'GREEN',owner:'Michael Torres'},
  {ref:'PWS 5.2.1',title:'Security Clearances',status:'PARTIAL',risk:'YELLOW',owner:'Robert Williams'}
];

const DEMO_COMPETITORS=[
  {name:'Leidos',threat:'HIGH',strengths:'Incumbent, strong DHA relationships',weakness:'Higher rates, slow innovation',strategy:'Emphasize agility and AI capabilities'},
  {name:'Booz Allen',threat:'MEDIUM',strengths:'Analytics expertise',weakness:'No healthcare focus',strategy:'Highlight healthcare IT specialization'},
  {name:'GDIT',threat:'MEDIUM',strengths:'Scale, clearances',weakness:'Recent contract issues',strategy:'Reference recent performance challenges'}
];

const DEMO_LCATS=[
  {title:'Program Manager',rate:185,hours:2080,total:384800},
  {title:'Sr. Software Engineer',rate:165,hours:4160,total:686400},
  {title:'Data Scientist',rate:155,hours:2080,total:322400},
  {title:'Cloud Architect',rate:175,hours:1040,total:182000},
  {title:'QA Analyst',rate:125,hours:2080,total:260000}
];

// ============================================================
// ICON COMPONENT
// ============================================================
const Icon=({name,className='w-5 h-5',style})=>{
  const icons={
    crown:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 3l3.5 7L12 6l3.5 4L19 3m-14 8v8h14v-8M5 15h14"/></svg>,
    briefcase:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>,
    target:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" strokeWidth={2}/><circle cx="12" cy="12" r="6" strokeWidth={2}/><circle cx="12" cy="12" r="2" strokeWidth={2}/></svg>,
    clipboard:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>,
    cpu:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"/></svg>,
    dollarSign:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>,
    scale:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"/></svg>,
    users:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/></svg>,
    checkCircle:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>,
    handshake:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/></svg>,
    settings:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>,
    filter:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/></svg>,
    swords:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 6l6 6m0 0l6-6m-6 6v12M4 4l16 16M20 4L4 20"/></svg>,
    fileCheck:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>,
    penTool:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>,
    ghost:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/></svg>,
    calculator:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>,
    eye:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>,
    mic:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/></svg>,
    shield:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>,
    activity:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>,
    rocket:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>,
    archive:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/></svg>,
    sliders:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/></svg>,
    star:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/></svg>,
    folder:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/></svg>,
    chevronDown:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7"/></svg>,
    chevronRight:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7"/></svg>,
    chevronLeft:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7"/></svg>,
    x:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12"/></svg>,
    menu:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16"/></svg>,
    search:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>,
    send:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/></svg>,
    play:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>,
    logout:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>,
    plus:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4"/></svg>,
    check:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7"/></svg>,
    trendingUp:<svg className={className} style={style} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg>,
  };
  return icons[name]||<span className={className}>‚óè</span>;
};

// ============================================================
// FORMAT HELPERS
// ============================================================
const fmt=v=>{if(v>=1e9)return`$${(v/1e9).toFixed(1)}B`;if(v>=1e6)return`$${(v/1e6).toFixed(0)}M`;return`$${(v||0).toLocaleString()}`};

// ============================================================
// AUTH CHECK
// ============================================================
function checkAuth(){
  const s=localStorage.getItem('MP_SESSION'),u=localStorage.getItem('MP_USER');
  if(!s||!u){window.location.href='login.html';return null}
  try{return JSON.parse(u)}catch{return{email:'demo@mmt.com',role:'CEO',name:'Demo User'}}
}
function handleLogout(){localStorage.clear();window.location.href='login.html'}

// ============================================================
// DEMO FLOW PANEL
// ============================================================
function DemoFlowPanel({currentScene,setCurrentScene,setActiveModule,demoMode}){
  if(!demoMode)return null;
  return(
    <div className="glass-panel p-4 mb-4 animate-fadeIn">
      <div className="flex items-center justify-between mb-3">
        <h3 className="font-semibold text-white flex items-center gap-2"><Icon name="play" className="w-4 h-4"/>Demo Flow - 9 Scenes</h3>
        <span className="text-sm text-cyan-400">Scene {currentScene+1} of 9</span>
      </div>
      <div className="flex gap-2 overflow-x-auto pb-2">
        {DEMO_SCENES.map((scene,idx)=>(
          <button key={scene.id} onClick={()=>{setCurrentScene(idx);setActiveModule(MODULES.find(m=>m.id===scene.module))}} className={`flex-shrink-0 flex items-center gap-2 px-3 py-2 rounded-lg transition ${currentScene===idx?'bg-cyan-500 text-black font-medium':'bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700'}`}>
            <span>{scene.icon}</span>
            <span className="text-sm whitespace-nowrap">{scene.title}</span>
          </button>
        ))}
      </div>
      <div className="mt-3 p-3 rounded-xl" style={{backgroundColor:DEMO_SCENES[currentScene]?.color+'15'}}>
        <div className="flex items-start gap-3">
          <div className="text-3xl">{DEMO_SCENES[currentScene]?.icon}</div>
          <div>
            <h4 className="font-semibold text-white">{DEMO_SCENES[currentScene]?.title}</h4>
            <p className="text-xs text-slate-400">{DEMO_SCENES[currentScene]?.subtitle}</p>
            <p className="text-sm text-slate-300 mt-1">{DEMO_SCENES[currentScene]?.description}</p>
          </div>
        </div>
      </div>
    </div>
  );
}

// ============================================================
// AI CHAT WIDGET
// ============================================================
function AIChatWidget({activeAgent,setActiveAgent}){
  const[isOpen,setIsOpen]=useState(false);
  const[messages,setMessages]=useState([]);
  const[input,setInput]=useState('');
  const[loading,setLoading]=useState(false);
  const messagesEndRef=useRef(null);

  useEffect(()=>{messagesEndRef.current?.scrollIntoView({behavior:'smooth'})},[messages]);
  useEffect(()=>{if(activeAgent){setMessages([{role:'assistant',content:`Hello! I'm the ${activeAgent.name}. ${activeAgent.description}. How can I help you today?`}]);setIsOpen(true)}},[activeAgent]);

  const sendMessage=async()=>{
    if(!input.trim()||loading)return;
    const userMsg={role:'user',content:input};
    setMessages(prev=>[...prev,userMsg]);
    setInput('');setLoading(true);
    try{
      const res=await fetch(`${CONFIG.API_URL}/api/chat`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:input,agent:activeAgent?.id||'capture'})});
      if(res.ok){const data=await res.json();setMessages(prev=>[...prev,{role:'assistant',content:data.response||data.message}])}
      else throw new Error();
    }catch{
      setTimeout(()=>{setMessages(prev=>[...prev,{role:'assistant',content:`Great question about "${input}". As the ${activeAgent?.name||'AI Assistant'}, I'd recommend focusing on compliance and win themes. Let me analyze this further...\n\n*Demo mode - connect API for full responses*`}])},800);
    }
    setLoading(false);
  };

  if(!isOpen)return(
    <button onClick={()=>setIsOpen(true)} className="fixed bottom-4 right-4 w-14 h-14 bg-gradient-to-r from-cyan-500 to-teal-500 rounded-full shadow-lg flex items-center justify-center text-white hover:scale-105 transition z-50">
      <span className="text-2xl">ü§ñ</span>
    </button>
  );

  return(
    <div className="fixed bottom-4 right-4 w-96 h-[500px] glass-panel shadow-2xl flex flex-col z-50 animate-fadeIn">
      <div className="p-3 border-b border-slate-700/50 flex items-center justify-between">
        <div className="flex items-center gap-2">
          <span className="text-2xl">{activeAgent?.icon||'ü§ñ'}</span>
          <div>
            <div className="text-sm font-semibold text-white">{activeAgent?.name||'AI Assistant'}</div>
            <div className="text-xs text-slate-400">{activeAgent?.description||'Ready to help'}</div>
          </div>
        </div>
        <button onClick={()=>setIsOpen(false)} className="p-1 text-slate-400 hover:text-white"><Icon name="x" className="w-5 h-5"/></button>
      </div>
      <div className="p-2 border-b border-slate-700/50 flex gap-1 overflow-x-auto">
        {AI_AGENTS.filter(a=>!a.restricted).map(agent=>(
          <button key={agent.id} onClick={()=>setActiveAgent(agent)} className={`flex-shrink-0 px-2 py-1 rounded text-xs flex items-center gap-1 ${activeAgent?.id===agent.id?'bg-cyan-500/20 text-cyan-400':'text-slate-400 hover:bg-slate-700'}`}>
            <span>{agent.icon}</span>
          </button>
        ))}
      </div>
      <div className="flex-1 overflow-y-auto p-3 space-y-3">
        {messages.map((msg,i)=>(
          <div key={i} className={`flex ${msg.role==='user'?'justify-end':'justify-start'}`}>
            <div className={`max-w-[85%] p-3 rounded-xl text-sm ${msg.role==='user'?'bg-cyan-500 text-white':'bg-slate-700 text-slate-200'}`}>
              {msg.content}
            </div>
          </div>
        ))}
        {loading&&<div className="flex justify-start"><div className="bg-slate-700 p-3 rounded-xl"><div className="flex gap-1"><div className="w-2 h-2 bg-slate-400 rounded-full animate-pulse"/><div className="w-2 h-2 bg-slate-400 rounded-full animate-pulse" style={{animationDelay:'0.2s'}}/><div className="w-2 h-2 bg-slate-400 rounded-full animate-pulse" style={{animationDelay:'0.4s'}}/></div></div></div>}
        <div ref={messagesEndRef}/>
      </div>
      <div className="p-3 border-t border-slate-700/50 flex gap-2">
        <input value={input} onChange={e=>setInput(e.target.value)} onKeyPress={e=>e.key==='Enter'&&sendMessage()} placeholder="Ask anything..." className="flex-1 bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-cyan-500"/>
        <button onClick={sendMessage} disabled={!input.trim()||loading} className="p-2 bg-cyan-500 rounded-lg text-white disabled:opacity-50"><Icon name="send" className="w-5 h-5"/></button>
      </div>
    </div>
  );
}

// ============================================================
// SIDEBAR
// ============================================================
function Sidebar({currentRole,activeModule,onModuleSelect,onRoleChange,user,demoMode,setDemoMode}){
  const[collapsed,setCollapsed]=useState(false);
  const[showRoleSwitcher,setShowRoleSwitcher]=useState(false);
  const[expandedCategories,setExpandedCategories]=useState(['Strategy','Intelligence','Delivery','Command','Admin']);

  const toggleCategory=(catId)=>{setExpandedCategories(prev=>prev.includes(catId)?prev.filter(c=>c!==catId):[...prev,catId])};
  const accessibleModules=useMemo(()=>MODULES.filter(m=>currentRole.access.includes(m.id)),[currentRole]);
  const modulesByCategory=useMemo(()=>{const grouped={};MODULE_CATEGORIES.forEach(cat=>{grouped[cat.id]=accessibleModules.filter(m=>m.category===cat.id)});return grouped},[accessibleModules]);

  return(
    <aside className={`flex-shrink-0 h-screen bg-slate-900/95 border-r border-slate-800 flex flex-col transition-all duration-300 ${collapsed?'w-16':'w-64'}`}>
      <div className="p-4 border-b border-slate-800">
        <div className="flex items-center justify-between">
          {!collapsed&&<div className="flex items-center gap-2"><div className="w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-500 to-teal-400 flex items-center justify-center"><span className="text-white font-bold text-sm">MP</span></div><div><h1 className="text-sm font-bold text-white">MissionPulse</h1><p className="text-[10px] text-slate-500">v12.0 Ultimate</p></div></div>}
          <button onClick={()=>setCollapsed(!collapsed)} className="p-1.5 rounded-lg hover:bg-slate-800 text-slate-400"><Icon name={collapsed?'chevronRight':'chevronLeft'} className="w-4 h-4"/></button>
        </div>
      </div>

      {!collapsed&&<div className="p-3 border-b border-slate-800">
        <button onClick={()=>setDemoMode(!demoMode)} className={`w-full flex items-center justify-between p-2 rounded-lg transition ${demoMode?'bg-cyan-500/20 text-cyan-400 border border-cyan-500/30':'bg-slate-800 text-slate-400'}`}>
          <div className="flex items-center gap-2"><Icon name="play" className="w-4 h-4"/><span className="text-sm font-medium">Demo Mode</span></div>
          {demoMode&&<span className="text-xs bg-cyan-500 text-black px-1.5 py-0.5 rounded font-bold">ON</span>}
        </button>
      </div>}

      <div className={`p-3 border-b border-slate-800 ${collapsed?'text-center':''}`}>
        <button onClick={()=>setShowRoleSwitcher(!showRoleSwitcher)} className="w-full flex items-center gap-3 p-2 rounded-lg hover:bg-slate-800/50 transition-colors">
          <div className="w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0" style={{backgroundColor:currentRole.bgColor}}>
            <Icon name={currentRole.icon} className="w-4 h-4" style={{color:currentRole.color}}/>
          </div>
          {!collapsed&&<><div className="flex-1 text-left"><p className="text-sm font-medium text-white">{currentRole.fullName}</p><p className="text-xs text-slate-400">{currentRole.shipleyFunction}</p></div><Icon name="chevronDown" className={`w-4 h-4 text-slate-400 transition-transform ${showRoleSwitcher?'rotate-180':''}`}/></>}
        </button>
        {showRoleSwitcher&&!collapsed&&(
          <div className="mt-2 p-2 bg-slate-800/50 rounded-lg border border-slate-700/50 max-h-64 overflow-y-auto animate-fadeIn">
            <p className="text-[10px] uppercase text-slate-500 font-semibold mb-2 px-2">Switch Role</p>
            {ROLES.map(role=>(
              <button key={role.id} onClick={()=>{onRoleChange(role);setShowRoleSwitcher(false)}} className={`w-full flex items-center gap-2 p-2 rounded-lg hover:bg-slate-700 ${currentRole.id===role.id?'bg-cyan-500/10':''}`}>
                <div className="w-6 h-6 rounded flex items-center justify-center" style={{backgroundColor:role.bgColor}}><Icon name={role.icon} className="w-3 h-3" style={{color:role.color}}/></div>
                <div className="flex-1 text-left"><p className="text-xs font-medium text-white">{role.name}</p><p className="text-[10px] text-slate-500">{role.shipleyFunction}</p></div>
                {currentRole.id===role.id&&<Icon name="check" className="w-4 h-4 text-cyan-400"/>}
              </button>
            ))}
          </div>
        )}
      </div>

      <nav className="flex-1 overflow-y-auto p-2">
        {MODULE_CATEGORIES.map(cat=>{
          const mods=modulesByCategory[cat.id]||[];
          if(mods.length===0)return null;
          const isExpanded=expandedCategories.includes(cat.id);
          return(
            <div key={cat.id} className="mb-2">
              <button onClick={()=>toggleCategory(cat.id)} className="w-full flex items-center justify-between p-2 text-[10px] uppercase text-slate-500 font-semibold hover:text-slate-300">
                {!collapsed&&<span>{cat.name}</span>}
                {!collapsed&&<Icon name={isExpanded?'chevronDown':'chevronRight'} className="w-3 h-3"/>}
              </button>
              {(isExpanded||collapsed)&&mods.map(mod=>(
                <button key={mod.id} onClick={()=>onModuleSelect(mod)} className={`w-full flex items-center gap-2 p-2 rounded-lg mb-0.5 transition ${activeModule?.id===mod.id?'bg-cyan-500/20 text-cyan-400 border border-cyan-500/30':'text-slate-400 hover:bg-slate-800 hover:text-white'}`} title={collapsed?mod.name:''}>
                  <Icon name={mod.icon} className="w-4 h-4" style={{color:mod.color}}/>
                  {!collapsed&&<><span className="flex-1 text-left text-sm">{mod.name}</span>{mod.badge&&<span className={`px-1 py-0.5 text-[9px] font-bold rounded ${mod.badge==='PRIVATE'?'bg-amber-500/20 text-amber-400':mod.badge==='CUI'?'bg-red-500/20 text-red-400':'bg-purple-500/20 text-purple-400'}`}>{mod.badge}</span>}</>}
                </button>
              ))}
            </div>
          );
        })}
      </nav>

      <div className={`p-3 border-t border-slate-800 ${collapsed?'text-center':''}`}>
        <div className="flex items-center gap-2 px-2"><span className="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"/>{!collapsed&&<span className="text-[10px] text-slate-400">RBAC Active ‚Ä¢ FedRAMP Moderate</span>}</div>
      </div>

      {!collapsed&&user&&(
        <div className="p-3 border-t border-slate-800">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-2">
              <div className="w-8 h-8 rounded-full bg-gradient-to-br from-cyan-500 to-teal-400 flex items-center justify-center text-white text-xs font-bold">{user.name?.[0]||user.email?.[0]||'U'}</div>
              <div className="text-xs"><p className="text-white font-medium truncate max-w-[120px]">{user.name||user.email}</p></div>
            </div>
            <button onClick={handleLogout} className="p-1.5 rounded-lg hover:bg-red-500/20 text-slate-400 hover:text-red-400 transition" title="Sign Out"><Icon name="logout" className="w-4 h-4"/></button>
          </div>
        </div>
      )}
    </aside>
  );
}

// ============================================================
// MODULE CONTENT COMPONENTS
// ============================================================

// DASHBOARD
function ModuleDashboard({opportunities,demoMode,currentScene,setCurrentScene,setActiveModule}){
  const totalValue=opportunities.reduce((sum,o)=>sum+(o.ceiling||0),0);
  const avgPwin=Math.round(opportunities.reduce((sum,o)=>sum+(o.pWin||0),0)/opportunities.length);
  return(
    <div className="space-y-4 animate-fadeIn">
      <DemoFlowPanel currentScene={currentScene} setCurrentScene={setCurrentScene} setActiveModule={setActiveModule} demoMode={demoMode}/>
      <div className="glass-panel p-6 bg-gradient-to-r from-cyan-500/10 to-teal-500/10">
        <div className="flex items-center justify-between">
          <div><h2 className="text-2xl font-bold text-white">Mission Control</h2><p className="text-slate-400">AI-Powered Proposal Command Center</p><p className="text-cyan-400 text-sm mt-1">Mission. Technology. Transformation.</p></div>
          <div className="text-6xl">üéØ</div>
        </div>
      </div>
      <div className="grid grid-cols-4 gap-4">
        {[{label:'Pipeline Value',value:fmt(totalValue),color:'emerald',sub:'‚Üë 12% this quarter'},{label:'Active Pursuits',value:opportunities.length,color:'cyan',sub:`${Math.ceil(opportunities.length*0.4)} in proposal phase`},{label:'Avg Win Probability',value:`${avgPwin}%`,color:'amber',sub:'Above 65% target'},{label:'Hours Saved',value:'340+',color:'purple',sub:'Per proposal with AI'}].map((stat,i)=>(
          <div key={i} className="glass-panel p-4 hover-lift">
            <p className="text-slate-400 text-xs mb-1">{stat.label}</p>
            <p className={`text-2xl font-bold text-${stat.color}-400`}>{stat.value}</p>
            <p className="text-slate-500 text-xs mt-1">{stat.sub}</p>
          </div>
        ))}
      </div>
      <div className="glass-panel overflow-hidden">
        <div className="p-4 border-b border-slate-700/50 flex justify-between items-center">
          <h3 className="font-semibold text-white">Active Pipeline</h3>
          <span className="text-xs text-slate-400">{opportunities.length} opportunities</span>
        </div>
        <table className="w-full">
          <thead className="bg-slate-800/50"><tr>{['Opportunity','Agency','Value','Phase','pWin','Days'].map(h=><th key={h} className="text-left p-3 text-xs font-semibold text-slate-400 uppercase">{h}</th>)}</tr></thead>
          <tbody className="divide-y divide-slate-700/50">
            {opportunities.map(opp=>(
              <tr key={opp.id} className="hover:bg-slate-800/30 cursor-pointer">
                <td className="p-3"><div className="font-medium text-white text-sm">{opp.nickname}</div><div className="text-xs text-slate-500">{opp.title}</div></td>
                <td className="p-3 text-sm text-slate-300">{opp.agency}</td>
                <td className="p-3 text-sm text-emerald-400 font-medium">{fmt(opp.ceiling)}</td>
                <td className="p-3"><span className="px-2 py-1 rounded text-xs bg-cyan-500/20 text-cyan-400">{opp.phase}</span></td>
                <td className="p-3"><div className="flex items-center gap-2"><div className="w-16 h-1.5 bg-slate-700 rounded-full overflow-hidden"><div className="h-full bg-gradient-to-r from-cyan-500 to-emerald-500" style={{width:`${opp.pWin}%`}}/></div><span className="text-xs text-slate-300">{opp.pWin}%</span></div></td>
                <td className="p-3 text-sm text-slate-400">{opp.daysRemaining}d</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
}

// PIPELINE
function ModulePipeline({opportunities}){
  const[filter,setFilter]=useState('all');
  const phases=['Qualify','Capture','Blue Team','Pink Team','Red Team'];
  const filtered=filter==='all'?opportunities:opportunities.filter(o=>o.phase===filter);
  return(
    <div className="space-y-4 animate-fadeIn">
      <div className="flex justify-between items-center">
        <div><h2 className="text-xl font-bold text-white">Pipeline Intelligence</h2><p className="text-slate-400 text-sm">Track opportunities through Shipley phases</p></div>
        <button className="px-4 py-2 bg-cyan-500 text-white rounded-lg text-sm font-medium hover:bg-cyan-600 transition">+ Add Opportunity</button>
      </div>
      <div className="flex gap-2 overflow-x-auto pb-2">
        <button onClick={()=>setFilter('all')} className={`px-4 py-2 rounded-lg text-sm font-medium transition ${filter==='all'?'bg-cyan-500 text-white':'bg-slate-800 text-slate-400 hover:text-white'}`}>All ({opportunities.length})</button>
        {phases.map(p=><button key={p} onClick={()=>setFilter(p)} className={`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition ${filter===p?'bg-cyan-500 text-white':'bg-slate-800 text-slate-400 hover:text-white'}`}>{p} ({opportunities.filter(o=>o.phase===p).length})</button>)}
      </div>
      <div className="grid grid-cols-3 gap-4">
        {filtered.map(opp=>(
          <div key={opp.id} className="glass-panel p-4 hover-lift cursor-pointer">
            <div className="flex justify-between items-start mb-3">
              <span className={`px-2 py-1 rounded text-xs font-medium ${opp.priority==='P-0'?'bg-red-500/20 text-red-400':opp.priority==='P-1'?'bg-amber-500/20 text-amber-400':'bg-slate-600 text-slate-300'}`}>{opp.priority}</span>
              <span className="text-emerald-400 font-semibold">{fmt(opp.ceiling)}</span>
            </div>
            <h4 className="font-semibold text-white mb-1">{opp.nickname}</h4>
            <p className="text-xs text-slate-400 mb-3 line-clamp-2">{opp.title}</p>
            <div className="flex justify-between items-center text-xs">
              <span className="text-slate-500">{opp.agency}</span>
              <span className="px-2 py-1 rounded bg-slate-700 text-slate-300">{opp.phase}</span>
            </div>
            <div className="mt-3 flex items-center gap-2">
              <div className="flex-1 h-1.5 bg-slate-700 rounded-full overflow-hidden"><div className="h-full bg-gradient-to-r from-cyan-500 to-emerald-500" style={{width:`${opp.pWin}%`}}/></div>
              <span className="text-xs text-slate-400">{opp.pWin}%</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

// COMPLIANCE
function ModuleCompliance(){
  return(
    <div className="space-y-4 animate-fadeIn">
      <div className="flex justify-between items-center">
        <div><h2 className="text-xl font-bold text-white">RFP Shredder</h2><p className="text-slate-400 text-sm">AI-powered compliance matrix generation</p></div>
        <button className="px-4 py-2 bg-cyan-500 text-white rounded-lg text-sm font-medium">üì§ Upload RFP</button>
      </div>
      <div className="glass-panel overflow-hidden">
        <div className="p-4 border-b border-slate-700/50 flex justify-between items-center">
          <h3 className="font-semibold text-white">Compliance Matrix</h3>
          <div className="flex gap-2">
            <span className="px-2 py-1 rounded text-xs bg-emerald-500/20 text-emerald-400">3 Compliant</span>
            <span className="px-2 py-1 rounded text-xs bg-amber-500/20 text-amber-400">2 Partial</span>
            <span className="px-2 py-1 rounded text-xs bg-red-500/20 text-red-400">1 High Risk</span>
          </div>
        </div>
        <table className="w-full">
          <thead className="bg-slate-800/50"><tr>{['PWS Ref','Requirement','Status','Risk','Owner'].map(h=><th key={h} className="text-left p-3 text-xs font-semibold text-slate-400 uppercase">{h}</th>)}</tr></thead>
          <tbody className="divide-y divide-slate-700/50">
            {DEMO_COMPLIANCE.map((req,i)=>(
              <tr key={i} className="hover:bg-slate-800/30">
                <td className="p-3 text-sm font-mono text-cyan-400">{req.ref}</td>
                <td className="p-3 text-sm text-white">{req.title}</td>
                <td className="p-3"><span className={`px-2 py-1 rounded text-xs ${req.status==='COMPLIANT'?'bg-emerald-500/20 text-emerald-400':req.status==='PARTIAL'?'bg-amber-500/20 text-amber-400':'bg-red-500/20 text-red-400'}`}>{req.status}</span></td>
                <td className="p-3"><span className={`w-3 h-3 rounded-full inline-block ${req.risk==='GREEN'?'bg-emerald-500':req.risk==='YELLOW'?'bg-amber-500':'bg-red-500'}`}/></td>
                <td className="p-3 text-sm text-slate-300">{req.owner}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
}

// BLACK HAT
function ModuleBlackHat({currentRole}){
  if(currentRole.id!=='CAP'&&currentRole.id!=='Admin')return(
    <div className="glass-panel p-12 text-center animate-fadeIn">
      <div className="text-6xl mb-4">üîí</div>
      <h2 className="text-xl font-bold text-white mb-2">Access Restricted</h2>
      <p className="text-slate-400">Black Hat intelligence requires Capture Manager or Admin role</p>
    </div>
  );
  return(
    <div className="space-y-4 animate-fadeIn">
      <div className="flex items-center gap-2"><h2 className="text-xl font-bold text-white">Black Hat Review</h2><span className="px-2 py-1 bg-amber-500/20 text-amber-400 rounded text-xs font-bold">PRIVATE</span></div>
      <p className="text-slate-400 text-sm">Competitive intelligence and counter-strategy analysis</p>
      <div className="space-y-4">
        {DEMO_COMPETITORS.map((comp,i)=>(
          <div key={i} className="glass-panel p-4">
            <div className="flex justify-between items-start mb-3">
              <h3 className="font-semibold text-white text-lg">{comp.name}</h3>
              <span className={`px-2 py-1 rounded text-xs font-medium ${comp.threat==='HIGH'?'bg-red-500/20 text-red-400':'bg-amber-500/20 text-amber-400'}`}>{comp.threat} THREAT</span>
            </div>
            <div className="grid grid-cols-3 gap-4 text-sm">
              <div><p className="text-slate-500 text-xs mb-1">Strengths</p><p className="text-slate-300">{comp.strengths}</p></div>
              <div><p className="text-slate-500 text-xs mb-1">Weaknesses</p><p className="text-slate-300">{comp.weakness}</p></div>
              <div><p className="text-slate-500 text-xs mb-1">Counter Strategy</p><p className="text-cyan-400">{comp.strategy}</p></div>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

// PRICING
function ModulePricing(){
  const totalLabor=DEMO_LCATS.reduce((sum,l)=>sum+l.total,0);
  return(
    <div className="space-y-4 animate-fadeIn">
      <div className="flex items-center gap-2"><h2 className="text-xl font-bold text-white">Pricing Engine</h2><span className="px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs font-bold">CUI</span></div>
      <p className="text-slate-400 text-sm">LCAT mapping and BOE generation</p>
      <div className="grid grid-cols-3 gap-4">
        <div className="glass-panel p-4"><p className="text-slate-400 text-xs">Direct Labor</p><p className="text-2xl font-bold text-white">{fmt(totalLabor)}</p></div>
        <div className="glass-panel p-4"><p className="text-slate-400 text-xs">Wrap Rate</p><p className="text-2xl font-bold text-white">1.85x</p></div>
        <div className="glass-panel p-4"><p className="text-slate-400 text-xs">Total Proposed</p><p className="text-2xl font-bold text-emerald-400">{fmt(totalLabor*1.85)}</p></div>
      </div>
      <div className="glass-panel overflow-hidden">
        <div className="p-4 border-b border-slate-700/50"><h3 className="font-semibold text-white">LCAT Pricing</h3></div>
        <table className="w-full">
          <thead className="bg-slate-800/50"><tr>{['Labor Category','Rate/Hr','Hours','Extended'].map(h=><th key={h} className="text-left p-3 text-xs font-semibold text-slate-400 uppercase">{h}</th>)}</tr></thead>
          <tbody className="divide-y divide-slate-700/50">
            {DEMO_LCATS.map((lcat,i)=>(
              <tr key={i} className="hover:bg-slate-800/30">
                <td className="p-3 text-sm text-white">{lcat.title}</td>
                <td className="p-3 text-sm text-slate-300">${lcat.rate}</td>
                <td className="p-3 text-sm text-slate-300">{lcat.hours.toLocaleString()}</td>
                <td className="p-3 text-sm text-emerald-400 font-medium">{fmt(lcat.total)}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
}

// AGENT SWARM
function ModuleSwarm({setActiveAgent}){
  return(
    <div className="space-y-4 animate-fadeIn">
      <div><h2 className="text-xl font-bold text-white">AI Agent Swarm</h2><p className="text-slate-400 text-sm">Your proposal intelligence team</p></div>
      <div className="grid grid-cols-2 gap-4">
        {AI_AGENTS.map(agent=>(
          <button key={agent.id} onClick={()=>!agent.restricted&&setActiveAgent(agent)} disabled={agent.restricted} className={`glass-panel p-4 text-left hover-lift transition ${agent.restricted?'opacity-50 cursor-not-allowed':''}`}>
            <div className="flex items-start gap-4">
              <div className="text-4xl">{agent.icon}</div>
              <div className="flex-1">
                <div className="flex items-center gap-2">
                  <span className="font-semibold text-white">{agent.name}</span>
                  {agent.restricted&&<span className="px-1.5 py-0.5 bg-amber-500/20 text-amber-400 rounded text-xs">PRIVATE</span>}
                </div>
                <p className="text-sm text-slate-400 mt-1">{agent.description}</p>
                {!agent.restricted&&<p className="text-xs text-cyan-400 mt-2">Launch Chat ‚Üí</p>}
              </div>
            </div>
          </button>
        ))}
      </div>
    </div>
  );
}

// TRAINING HUB
function ModuleTraining(){
  const[tab,setTab]=useState('company');
  const[uploads,setUploads]=useState([]);
  const[training,setTraining]=useState(false);
  const[progress,setProgress]=useState(0);
  const handleUpload=(type)=>{setUploads(prev=>[...prev,{id:Date.now(),name:`${type}_document.pdf`,type,status:'Ready'}])};
  const startTraining=()=>{setTraining(true);setProgress(0);const interval=setInterval(()=>{setProgress(p=>{if(p>=100){clearInterval(interval);setTraining(false);return 100}return p+10})},500)};

  return(
    <div className="space-y-4 animate-fadeIn">
      <div><h2 className="text-xl font-bold text-white">üéì Training Hub</h2><p className="text-slate-400 text-sm">Onboard your company and train AI on your content</p></div>
      <div className="flex gap-2 border-b border-slate-700 pb-2">
        {[{id:'company',label:'Company Profile',icon:'üè¢'},{id:'documents',label:'Upload Documents',icon:'üìÑ'},{id:'training',label:'AI Training',icon:'ü§ñ'},{id:'integrations',label:'Integrations',icon:'üîó'}].map(t=><button key={t.id} onClick={()=>setTab(t.id)} className={`px-4 py-2 rounded-lg text-sm font-medium transition ${tab===t.id?'bg-cyan-500/20 text-cyan-400 border border-cyan-500/30':'text-slate-400 hover:text-white'}`}>{t.icon} {t.label}</button>)}
      </div>
      {tab==='company'&&(
        <div className="glass-panel p-6 space-y-4">
          <h3 className="font-semibold text-white">Company Information</h3>
          <div className="grid grid-cols-2 gap-4">
            <div><label className="text-sm text-slate-400 block mb-1">Company Name</label><input type="text" defaultValue="Mission Meets Tech" className="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white"/></div>
            <div><label className="text-sm text-slate-400 block mb-1">CAGE Code</label><input type="text" placeholder="XXXXX" className="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white"/></div>
            <div><label className="text-sm text-slate-400 block mb-1">DUNS/UEI</label><input type="text" placeholder="Enter UEI" className="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white"/></div>
            <div><label className="text-sm text-slate-400 block mb-1">Primary NAICS</label><input type="text" placeholder="541512" className="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white"/></div>
          </div>
          <div><label className="text-sm text-slate-400 block mb-1">Certifications</label><div className="flex flex-wrap gap-2">{['SDVOSB','WOSB','8(a)','HUBZone','MBE'].map(c=><label key={c} className="flex items-center gap-2 px-3 py-2 bg-slate-800 rounded-lg cursor-pointer hover:bg-slate-700"><input type="checkbox" className="rounded border-slate-600"/><span className="text-sm text-white">{c}</span></label>)}</div></div>
          <button className="px-4 py-2 bg-cyan-500 text-white rounded-lg font-medium">Save Company Profile</button>
        </div>
      )}
      {tab==='documents'&&(
        <div className="space-y-4">
          <div className="grid grid-cols-3 gap-4">
            {[{type:'proposals',label:'Past Proposals',icon:'üìù'},{type:'performance',label:'Past Performance',icon:'‚≠ê'},{type:'resumes',label:'Key Personnel',icon:'üë§'},{type:'templates',label:'Templates',icon:'üìã'},{type:'win_themes',label:'Win Themes',icon:'üèÜ'},{type:'pricing',label:'Pricing History',icon:'üí∞'}].map(d=><button key={d.type} onClick={()=>handleUpload(d.type)} className="glass-panel p-4 text-left hover-lift"><div className="text-2xl mb-2">{d.icon}</div><h4 className="font-medium text-white">{d.label}</h4><div className="mt-2 text-xs text-cyan-400">+ Upload Files</div></button>)}
          </div>
          {uploads.length>0&&<div className="glass-panel p-4"><h4 className="font-medium text-white mb-3">Uploaded Files ({uploads.length})</h4><div className="space-y-2">{uploads.map(f=><div key={f.id} className="flex items-center justify-between p-2 bg-slate-800/50 rounded-lg"><div className="flex items-center gap-3"><span className="text-lg">üìÑ</span><span className="text-sm text-white">{f.name}</span></div><span className="px-2 py-0.5 bg-emerald-500/20 text-emerald-400 rounded text-xs">{f.status}</span></div>)}</div></div>}
        </div>
      )}
      {tab==='training'&&(
        <div className="glass-panel p-6 space-y-4">
          <h3 className="font-semibold text-white">Train AI on Your Content</h3>
          <p className="text-sm text-slate-400">MissionPulse AI will learn from your uploaded documents to generate content in your company's voice.</p>
          <div className="grid grid-cols-3 gap-4">
            <div className="p-4 bg-slate-800/50 rounded-lg text-center"><div className="text-2xl font-bold text-white">{uploads.length}</div><div className="text-xs text-slate-400">Documents Ready</div></div>
            <div className="p-4 bg-slate-800/50 rounded-lg text-center"><div className="text-2xl font-bold text-white">0</div><div className="text-xs text-slate-400">Win Themes</div></div>
            <div className="p-4 bg-slate-800/50 rounded-lg text-center"><div className="text-2xl font-bold text-white">0</div><div className="text-xs text-slate-400">Past Performance</div></div>
          </div>
          {training?(<div className="space-y-2"><div className="flex justify-between text-sm"><span className="text-white">Training in progress...</span><span className="text-cyan-400">{progress}%</span></div><div className="w-full h-3 bg-slate-700 rounded-full overflow-hidden"><div className="h-full bg-gradient-to-r from-cyan-500 to-teal-500 progress-bar" style={{width:`${progress}%`}}/></div></div>):(<button onClick={startTraining} disabled={uploads.length===0} className="w-full py-3 bg-gradient-to-r from-cyan-500 to-teal-500 text-white rounded-xl font-semibold disabled:opacity-50">üöÄ Start AI Training</button>)}
          {progress===100&&<div className="p-4 bg-emerald-500/10 border border-emerald-500/30 rounded-lg"><span className="text-emerald-400 font-medium">‚úÖ Training Complete!</span></div>}
        </div>
      )}
      {tab==='integrations'&&(
        <div className="grid grid-cols-2 gap-4">
          {[{name:'Microsoft 365',icon:'üî∑',desc:'Teams, Outlook, Word'},{name:'Google Workspace',icon:'üî¥',desc:'Drive, Docs, Gmail'},{name:'HubSpot CRM',icon:'üü†',desc:'Contact sync'},{name:'GovWin',icon:'üü¢',desc:'Opportunity intel'},{name:'SAM.gov',icon:'üîµ',desc:'Registration'},{name:'Deltek CostPoint',icon:'üü£',desc:'Pricing'}].map((int,i)=><div key={i} className="glass-panel p-4 flex items-center justify-between"><div className="flex items-center gap-3"><span className="text-2xl">{int.icon}</span><div><h4 className="font-medium text-white">{int.name}</h4><p className="text-xs text-slate-400">{int.desc}</p></div></div><button className="px-3 py-1.5 bg-cyan-500/20 text-cyan-400 rounded-lg text-sm">Connect</button></div>)}
        </div>
      )}
    </div>
  );
}

// GENERIC MODULE
function ModuleGeneric({module}){
  return(
    <div className="glass-panel p-12 text-center animate-fadeIn">
      <div className="text-6xl mb-4"><Icon name={module.icon} className="w-16 h-16 mx-auto" style={{color:module.color}}/></div>
      <h2 className="text-xl font-bold text-white mb-2">{module.name}</h2>
      <p className="text-slate-400 mb-4">{module.description}</p>
      {module.badge&&<span className={`px-3 py-1 rounded text-sm font-bold ${module.badge==='PRIVATE'?'bg-amber-500/20 text-amber-400':module.badge==='CUI'?'bg-red-500/20 text-red-400':'bg-purple-500/20 text-purple-400'}`}>{module.badge}</span>}
      <p className="text-slate-500 text-sm mt-4">Module ready for content integration</p>
    </div>
  );
}

// ============================================================
// MAIN CONTENT
// ============================================================
function MainContent({activeModule,currentRole,opportunities,demoMode,currentScene,setCurrentScene,setActiveModule,setActiveAgent}){
  if(!activeModule)return(
    <div className="flex-1 flex items-center justify-center">
      <div className="text-center">
        <div className="text-6xl mb-4">üõ°Ô∏è</div>
        <h2 className="text-xl font-bold text-white mb-2">Welcome to MissionPulse</h2>
        <p className="text-slate-400">Select a module from the sidebar to begin</p>
      </div>
    </div>
  );

  const renderModule=()=>{
    switch(activeModule.id){
      case 'dashboard':return<ModuleDashboard opportunities={opportunities} demoMode={demoMode} currentScene={currentScene} setCurrentScene={setCurrentScene} setActiveModule={setActiveModule}/>;
      case 'pipeline':return<ModulePipeline opportunities={opportunities}/>;
      case 'compliance':return<ModuleCompliance/>;
      case 'blackhat':return<ModuleBlackHat currentRole={currentRole}/>;
      case 'pricing':return<ModulePricing/>;
      case 'swarm':return<ModuleSwarm setActiveAgent={setActiveAgent}/>;
      case 'training':return<ModuleTraining/>;
      default:return<ModuleGeneric module={activeModule}/>;
    }
  };

  return(
    <div className="flex-1 overflow-y-auto">
      <header className="sticky top-0 bg-slate-900/90 backdrop-blur border-b border-slate-800 px-6 py-3 z-10">
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-3">
            <Icon name={activeModule.icon} className="w-6 h-6" style={{color:activeModule.color}}/>
            <div><h1 className="font-semibold text-white">{activeModule.name}</h1><p className="text-xs text-slate-400">{activeModule.description}</p></div>
            {activeModule.badge&&<span className={`px-2 py-0.5 rounded text-xs font-bold ${activeModule.badge==='PRIVATE'?'bg-amber-500/20 text-amber-400':activeModule.badge==='CUI'?'bg-red-500/20 text-red-400':'bg-purple-500/20 text-purple-400'}`}>{activeModule.badge}</span>}
          </div>
        </div>
      </header>
      <main className="p-6">{renderModule()}</main>
    </div>
  );
}

// ============================================================
// APP
// ============================================================
function App(){
  const[user,setUser]=useState(null);
  const[currentRole,setCurrentRole]=useState(ROLES[0]);
  const[activeModule,setActiveModule]=useState(null);
  const[opportunities,setOpportunities]=useState(DEMO_OPPORTUNITIES);
  const[loading,setLoading]=useState(true);
  const[demoMode,setDemoMode]=useState(true);
  const[currentScene,setCurrentScene]=useState(0);
  const[activeAgent,setActiveAgent]=useState(AI_AGENTS[0]);

  useEffect(()=>{
    const userData=checkAuth();
    if(userData){
      setUser(userData);
      if(userData.role){const role=ROLES.find(r=>r.id===userData.role);if(role)setCurrentRole(role)}
    }
  },[]);

  useEffect(()=>{
    async function loadData(){
      setLoading(true);
      try{
        const{data,error}=await supabase.from('opportunities').select('*').order('created_at',{ascending:false});
        if(!error&&data?.length)setOpportunities(data.map(o=>({...o,nickname:o.nickname||o.title?.substring(0,20),pWin:o.pwin||65,daysRemaining:30,phase:o.phase||'Capture'})));
      }catch(e){console.log('Using demo data')}
      setLoading(false);
    }
    loadData();
  },[]);

  useEffect(()=>{
    const savedRole=localStorage.getItem('missionpulse_role');
    const savedModule=localStorage.getItem('missionpulse_module');
    if(savedRole){const role=ROLES.find(r=>r.id===savedRole);if(role)setCurrentRole(role)}
    if(savedModule){const mod=MODULES.find(m=>m.id===savedModule);if(mod&&currentRole.access.includes(mod.id))setActiveModule(mod)}
  },[]);

  useEffect(()=>{localStorage.setItem('missionpulse_role',currentRole.id)},[currentRole]);
  useEffect(()=>{if(activeModule)localStorage.setItem('missionpulse_module',activeModule.id)},[activeModule]);

  const handleRoleChange=(newRole)=>{
    setCurrentRole(newRole);
    if(activeModule&&!newRole.access.includes(activeModule.id)){
      const firstAccessible=MODULES.find(m=>newRole.access.includes(m.id));
      setActiveModule(firstAccessible||null);
    }
  };

  const handleModuleSelect=(mod)=>{if(currentRole.access.includes(mod.id))setActiveModule(mod)};

  if(!user)return<div className="h-screen flex items-center justify-center bg-[#00050F]"><div className="text-center"><div className="w-12 h-12 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"/><p className="text-slate-400">Loading MissionPulse...</p></div></div>;

  return(
    <RoleContext.Provider value={{currentRole,setCurrentRole:handleRoleChange,user,handleLogout}}>
      <div className="h-screen flex bg-[#00050F] overflow-hidden">
        <Sidebar currentRole={currentRole} activeModule={activeModule} onModuleSelect={handleModuleSelect} onRoleChange={handleRoleChange} user={user} demoMode={demoMode} setDemoMode={setDemoMode}/>
        <MainContent activeModule={activeModule} currentRole={currentRole} opportunities={opportunities} demoMode={demoMode} currentScene={currentScene} setCurrentScene={setCurrentScene} setActiveModule={handleModuleSelect} setActiveAgent={setActiveAgent}/>
      </div>
      <div className="fixed bottom-0 left-0 right-0 h-6 bg-slate-900/95 border-t border-slate-800 flex items-center justify-center z-40">
        <span className="text-[10px] text-slate-500 tracking-wider">AI GENERATED - REQUIRES HUMAN REVIEW ‚Ä¢ MissionPulse v12.0 Ultimate ‚Ä¢ ¬© 2026 Mission Meets Tech</span>
      </div>
      <AIChatWidget activeAgent={activeAgent} setActiveAgent={setActiveAgent}/>
    </RoleContext.Provider>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>
