<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse â€” CUI Portion Marking Audit</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Space Grotesk',sans-serif;background:#00050F;min-height:100vh}.font-mono{font-family:'JetBrains Mono',monospace}@keyframes slideIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}@keyframes barFill{from{width:0%}}.animate-slide-in{animation:slideIn .4s ease-out forwards}.animate-pulse{animation:pulse 2s ease-in-out infinite}.animate-bar{animation:barFill .8s ease-out forwards}.glass-card{background:linear-gradient(135deg,rgba(15,23,42,.9) 0%,rgba(15,23,42,.7) 100%);backdrop-filter:blur(10px);border:1px solid rgba(0,229,250,.15)}.glass-card:hover{border-color:rgba(0,229,250,.3)}.cui-banner{background:linear-gradient(90deg,rgba(255,184,0,.08),rgba(255,184,0,.03));border:1px solid rgba(255,184,0,.3)}
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const{useState,useEffect}=React;
    const SB_URL='https://qdrtpnpnhkxvfmvfziop.supabase.co';const SB_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc4MjMwMTgsImV4cCI6MjA1MzM5OTAxOH0.gFHBoGjPMWjCGuJNdxMGPOBmGMHBp0jSTbxxcFKqkPQ';
    var sbClient;try{sbClient=supabase.createClient(SB_URL,SB_KEY)}catch(e){sbClient=null}

    const CUI_MODULES=[
      {module:'Pricing (M8)',file:'missionpulse-m8-pricing.html',cuiCategory:'CTI â€” Controlled Technical Information',dataTypes:['Labor rates','Wrap rates','Fee percentages','BOE estimates'],checks:[
        {check:'CUI banner at page top',status:'pass',detail:'Amber banner with lock icon and "CUI // CONTROLLED" text'},
        {check:'Amber shield icon in header',status:'pass',detail:'ðŸ›¡ CUI badge next to module title'},
        {check:'RBAC restricted to CEO/COO/FIN/Admin',status:'pass',detail:'useEffect enforces role whitelist'},
        {check:'AI disclaimer footer present',status:'pass',detail:'"AI GENERATED â€” REQUIRES HUMAN REVIEW"'},
        {check:'No export/download without CUI marking',status:'pass',detail:'Exported files include CUI header/footer'},
        {check:'Screen capture warning',status:'pass',detail:'CUI notice visible in all screenshots'},
      ]},
      {module:'Pricing Library (S140)',file:'missionpulse-pricing-library.html',cuiCategory:'CTI â€” Controlled Technical Information',dataTypes:['Historical rates','Wrap rate components','Labor categories','Rate escalation factors'],checks:[
        {check:'CUI banner at page top',status:'pass',detail:'Full-width amber gradient banner with lock icon'},
        {check:'Amber shield icon in header',status:'pass',detail:'ðŸ›¡ CUI badge and "AUTHORIZED ACCESS ONLY"'},
        {check:'RBAC restricted to CEO/COO/FIN/Admin',status:'pass',detail:'useEffect with 4-role whitelist'},
        {check:'AI disclaimer footer present',status:'pass',detail:'Dual footer: CUI marking + AI disclaimer'},
        {check:'Wrap rate calculations protected',status:'pass',detail:'Multiplier calc shown only to authorized roles'},
        {check:'Historical bid data CUI marked',status:'pass',detail:'Win/loss rates classified as competitive intel'},
      ]},
      {module:'Budget Tracker (S137)',file:'missionpulse-budget-tracker.html',cuiCategory:'PROPIN â€” Proprietary Business Information',dataTypes:['B&P budget allocation','Investment per opportunity','ROI calculations','Burn rate data'],checks:[
        {check:'CUI banner at page top',status:'warn',detail:'GAP: No CUI banner â€” module contains proprietary budget data'},
        {check:'RBAC restricted to CEO/COO/FIN/Admin',status:'pass',detail:'useEffect with 4-role whitelist'},
        {check:'AI disclaimer footer present',status:'pass',detail:'Standard AI disclaimer present'},
        {check:'Investment data marked proprietary',status:'warn',detail:'GAP: Per-opportunity ROI should show PROPIN marking'},
        {check:'Export controls',status:'pass',detail:'No bulk export functionality exposed'},
      ]},
      {module:'Black Hat (M7)',file:'missionpulse-m7-blackhat-enhanced.html',cuiCategory:'CTI â€” Competitive Intelligence',dataTypes:['Competitor weaknesses','Ghost strategies','Win themes','Red team analysis'],checks:[
        {check:'Maximum RBAC restriction (CEO/COO/CAP)',status:'pass',detail:'3-role whitelist, most restricted module'},
        {check:'Module hidden from unauthorized roles',status:'pass',detail:'Invisible RBAC â€” module does not render'},
        {check:'AI disclaimer footer present',status:'pass',detail:'Standard AI disclaimer present'},
        {check:'No partner access',status:'pass',detail:'Partner role explicitly excluded'},
        {check:'Competitive data isolation',status:'pass',detail:'No data leaks to other modules'},
      ]},
    ];

    const NON_CUI_MODULES=[
      {module:'Dashboard',file:'missionpulse-m1-enhanced.html',aiDisclaimer:true,cuiBannerAbsent:true,status:'clean'},
      {module:'Pipeline',file:'index.html',aiDisclaimer:true,cuiBannerAbsent:true,status:'clean'},
      {module:'War Room',file:'missionpulse-m2-warroom-enhanced.html',aiDisclaimer:true,cuiBannerAbsent:true,status:'clean'},
      {module:'Swimlane',file:'missionpulse-m3-swimlane-board.html',aiDisclaimer:true,cuiBannerAbsent:true,status:'clean'},
      {module:'RFP Shredder',file:'missionpulse-m5-contracts-enhanced.html',aiDisclaimer:true,cuiBannerAbsent:true,status:'clean'},
      {module:'Task Orders',file:'missionpulse-task-orders.html',aiDisclaimer:true,cuiBannerAbsent:true,status:'review',note:'Contains obligated $ â€” verify no CUI overlap'},
      {module:'Meeting Notes',file:'missionpulse-meeting-notes.html',aiDisclaimer:true,cuiBannerAbsent:true,status:'review',note:'Customer meeting content may contain CUI â€” user responsible for marking'},
      {module:'Clearance Tracker',file:'missionpulse-clearance-tracker.html',aiDisclaimer:true,cuiBannerAbsent:true,status:'review',note:'Personnel clearance data is PII â€” verify privacy controls'},
    ];

    const ConnectionIndicator=({connected})=>(
      <div className="flex items-center gap-2 px-3 py-1 rounded-full text-xs font-mono" style={{background:connected?'rgba(0,255,136,0.1)':'rgba(255,184,0,0.1)',border:`1px solid ${connected?'rgba(0,255,136,0.3)':'rgba(255,184,0,0.3)'}`}}>
        <div className={`w-2 h-2 rounded-full ${connected?'bg-green-400':'bg-amber-400 animate-pulse'}`}/>
        <span style={{color:connected?'#00ff88':'#ffb800'}}>{connected?'LIVE':'DEMO'}</span>
      </div>
    );

    const App=()=>{
      const[connected,setConnected]=useState(false);
      const[userRole]=useState('CEO');
      const[activeTab,setActiveTab]=useState('cui');

      useEffect(()=>{const a=['CEO','COO','Admin'];if(!a.includes(userRole))return},[userRole]);
      useEffect(()=>{if(!sbClient)return;(async()=>{try{const{data}=await sbClient.from('opportunities').select('id').limit(1);if(data)setConnected(true)}catch(e){}})()},[]);

      const totalChecks=CUI_MODULES.reduce((s,m)=>s+m.checks.length,0);
      const passedChecks=CUI_MODULES.reduce((s,m)=>s+m.checks.filter(c=>c.status==='pass').length,0);
      const warnChecks=CUI_MODULES.reduce((s,m)=>s+m.checks.filter(c=>c.status==='warn').length,0);
      const failChecks=CUI_MODULES.reduce((s,m)=>s+m.checks.filter(c=>c.status==='fail').length,0);
      const reviewModules=NON_CUI_MODULES.filter(m=>m.status==='review').length;

      const StatusIcon=({status})=>{
        if(status==='pass')return <div className="w-5 h-5 rounded-full bg-green-500/20 border border-green-500/40 flex items-center justify-center"><svg className="w-3 h-3 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7"/></svg></div>;
        if(status==='warn')return <div className="w-5 h-5 rounded-full bg-amber-500/20 border border-amber-500/40 flex items-center justify-center"><svg className="w-3 h-3 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M12 9v2m0 4h.01"/></svg></div>;
        return <div className="w-5 h-5 rounded-full bg-red-500/20 border border-red-500/40 flex items-center justify-center"><svg className="w-3 h-3 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M6 18L18 6M6 6l12 12"/></svg></div>;
      };

      const tabs=[{key:'cui',label:`CUI Modules (${CUI_MODULES.length})`},{key:'noncui',label:`Non-CUI Scan (${NON_CUI_MODULES.length})`},{key:'policy',label:'CUI Policy Ref'}];

      return(
        <div className="min-h-screen" style={{background:'#00050F'}}>
          <div className="max-w-7xl mx-auto p-6">
            <div className="cui-banner rounded-lg px-4 py-2 mb-4 flex items-center gap-3">
              <svg className="w-4 h-4 text-amber-500 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>
              <span className="text-xs font-mono font-bold text-amber-500">CUI AUDIT DASHBOARD â€” AUTHORIZED REVIEWERS ONLY (CEO / COO / ISSO / Admin)</span>
            </div>

            <div className="flex items-center justify-between mb-6">
              <div><div className="flex items-center gap-3 mb-1"><h1 className="text-2xl font-bold text-white">CUI Portion Marking Audit</h1><ConnectionIndicator connected={connected}/></div>
              <p className="text-sm text-slate-400">Verify CUI markings, amber shields, export restrictions & NIST 800-171 compliance</p></div>
            </div>

            <div className="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
              {[{l:'CUI Modules',v:CUI_MODULES.length,c:'#ffb800'},{l:'Total Checks',v:totalChecks,c:'#00E5FA'},{l:'Passed',v:passedChecks,c:'#00ff88'},{l:'Warnings',v:warnChecks,c:warnChecks>0?'#ffb800':'#00ff88'},{l:'Needs Review',v:reviewModules,c:reviewModules>0?'#a78bfa':'#00ff88'}].map((k,i)=>(
                <div key={i} className="glass-card rounded-xl p-4 animate-slide-in" style={{animationDelay:`${i*.05}s`}}>
                  <span className="text-xs text-slate-500 font-mono uppercase">{k.l}</span>
                  <div className="text-2xl font-mono font-bold mt-1" style={{color:k.c}}>{k.v}</div>
                </div>
              ))}
            </div>

            <div className="flex items-center gap-1 bg-slate-800/30 rounded-lg p-1 mb-6">
              {tabs.map(t=><button key={t.key} onClick={()=>setActiveTab(t.key)} className={`px-4 py-2 rounded-md text-sm font-mono font-bold transition flex-1 ${activeTab===t.key?'bg-cyan-500/20 text-cyan-400':'text-slate-500 hover:text-slate-300'}`}>{t.label}</button>)}
            </div>

            {activeTab==='cui'&&(
              <div className="space-y-4 animate-slide-in">
                {CUI_MODULES.map((m,mi)=>{
                  const mPass=m.checks.filter(c=>c.status==='pass').length;const mTotal=m.checks.length;const allPass=mPass===mTotal;
                  return(
                    <div key={mi} className="glass-card rounded-xl overflow-hidden animate-slide-in" style={{animationDelay:`${mi*.08}s`}}>
                      <div className="p-5 border-b border-slate-700/20">
                        <div className="flex items-center justify-between">
                          <div>
                            <div className="flex items-center gap-3"><span className="px-2 py-0.5 rounded text-xs font-mono font-bold bg-amber-500/15 text-amber-500">ðŸ›¡ CUI</span><h3 className="text-white font-semibold">{m.module}</h3><span className={`px-2 py-0.5 rounded text-xs font-mono font-bold ${allPass?'bg-green-500/10 text-green-400 border border-green-500/20':'bg-amber-500/10 text-amber-400 border border-amber-500/20'}`}>{allPass?'ALL PASS':'REVIEW'}</span></div>
                            <p className="text-xs text-slate-500 mt-1">{m.cuiCategory} Â· {m.file}</p>
                          </div>
                          <span className="text-sm font-mono font-bold" style={{color:allPass?'#00ff88':'#ffb800'}}>{mPass}/{mTotal}</span>
                        </div>
                        <div className="flex flex-wrap gap-1.5 mt-3">{m.dataTypes.map((d,i)=><span key={i} className="px-2 py-0.5 rounded text-xs font-mono bg-amber-500/8 text-amber-400/80 border border-amber-500/15">{d}</span>)}</div>
                      </div>
                      <div className="divide-y divide-slate-700/10">
                        {m.checks.map((c,ci)=>(
                          <div key={ci} className="flex items-center gap-4 px-5 py-3 hover:bg-slate-800/10 transition">
                            <StatusIcon status={c.status}/>
                            <div className="flex-1"><span className="text-sm text-white">{c.check}</span></div>
                            <span className={`text-xs font-mono ${c.status==='pass'?'text-slate-500':c.status==='warn'?'text-amber-400 font-bold':'text-red-400 font-bold'}`}>{c.detail}</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  );
                })}
              </div>
            )}

            {activeTab==='noncui'&&(
              <div className="glass-card rounded-xl overflow-hidden animate-slide-in">
                <div className="p-4 border-b border-slate-700/30"><h3 className="text-sm font-mono font-bold text-cyan-400">NON-CUI MODULE VERIFICATION</h3><p className="text-xs text-slate-500 mt-1">Confirming these modules correctly omit CUI markings and include AI disclaimers.</p></div>
                <div className="divide-y divide-slate-700/10">
                  {NON_CUI_MODULES.map((m,i)=>(
                    <div key={i} className="flex items-center gap-4 px-5 py-3 hover:bg-slate-800/10 transition">
                      <StatusIcon status={m.status==='clean'?'pass':'warn'}/>
                      <div className="flex-1">
                        <div className="flex items-center gap-2"><span className="text-sm text-white">{m.module}</span>
                          {m.aiDisclaimer&&<span className="px-1.5 py-0.5 rounded text-xs font-mono bg-green-500/10 text-green-400">AI Disclaimer âœ“</span>}
                          {m.cuiBannerAbsent&&<span className="px-1.5 py-0.5 rounded text-xs font-mono bg-green-500/10 text-green-400">No CUI Banner âœ“</span>}
                        </div>
                        {m.note&&<div className="text-xs text-amber-400 mt-0.5">âš  {m.note}</div>}
                      </div>
                      <span className="text-xs font-mono text-slate-500">{m.file}</span>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {activeTab==='policy'&&(
              <div className="glass-card rounded-xl p-6 animate-slide-in">
                <h3 className="text-sm font-mono font-bold text-cyan-400 mb-4">CUI MARKING POLICY â€” MissionPulse Implementation</h3>
                <div className="space-y-4 text-sm text-slate-300 leading-relaxed">
                  <div className="p-4 rounded-lg bg-slate-800/30 border border-slate-700/20">
                    <h4 className="text-amber-400 font-mono font-bold text-xs mb-2">NIST SP 800-171 Rev 2 â€” 3.1.3</h4>
                    <p>Control the flow of CUI in accordance with approved authorizations. MissionPulse enforces data flow control via invisible RBAC â€” unauthorized roles cannot see CUI-producing modules at all.</p>
                  </div>
                  <div className="p-4 rounded-lg bg-slate-800/30 border border-slate-700/20">
                    <h4 className="text-amber-400 font-mono font-bold text-xs mb-2">32 CFR Part 2002 â€” CUI Marking Requirements</h4>
                    <p>All CUI modules display: (1) Amber CUI banner at page top, (2) CUI category label (CTI/PROPIN), (3) Amber shield icon in header badge, (4) CUI footer on exported documents.</p>
                  </div>
                  <div className="p-4 rounded-lg bg-slate-800/30 border border-slate-700/20">
                    <h4 className="text-amber-400 font-mono font-bold text-xs mb-2">DFARS 252.204-7012 â€” Safeguarding Covered Defense Information</h4>
                    <p>Pricing data, competitive intelligence, and labor rates are classified as Covered Defense Information when associated with DoD contracts. These data types require NIST 800-171 protection and CUI portion marking.</p>
                  </div>
                  <div className="p-4 rounded-lg bg-slate-800/30 border border-slate-700/20">
                    <h4 className="text-amber-400 font-mono font-bold text-xs mb-2">MissionPulse CUI Data Types</h4>
                    <div className="grid grid-cols-2 gap-2 mt-2">
                      {['Labor rates & wrap rates','BOE pricing estimates','Fee/profit percentages','Competitor weaknesses (Black Hat)','Historical bid pricing','Rate escalation factors','B&P budget allocations','Per-opportunity ROI data'].map((d,i)=>(
                        <div key={i} className="flex items-center gap-2 text-xs"><span className="text-amber-400">ðŸ›¡</span><span className="text-slate-400">{d}</span></div>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            )}

            <div className="mt-8 flex items-center justify-center gap-4">
              <div className="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-amber-500/5 border border-amber-500/20"><svg className="w-3.5 h-3.5 text-amber-500 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg><span className="text-xs text-amber-500/80 font-mono">CUI // AUDIT DATA</span></div>
              <div className="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-amber-500/5 border border-amber-500/20"><svg className="w-3.5 h-3.5 text-amber-500 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg><span className="text-xs text-amber-500/80 font-mono">AI GENERATED â€” REQUIRES HUMAN REVIEW</span></div>
            </div>
          </div>
        </div>
      );
    };
    ReactDOM.render(<App/>,document.getElementById('root'));
  </script>
</body>
</html>
