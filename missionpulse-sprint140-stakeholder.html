<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse - Stakeholder Map</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>* { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: 'Space Grotesk', sans-serif; background: #00050F; min-height: 100vh; } .font-mono { font-family: 'JetBrains Mono', monospace; } @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } } .animate-fade-up { animation: fadeInUp 0.5s ease-out forwards; } .glass-card { background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(15, 23, 42, 0.7) 100%); backdrop-filter: blur(10px); border: 1px solid rgba(0, 229, 250, 0.2); }</style>
</head>
<body>
  <div id="root"></div>
  <script src="supabase-client.js"></script>
  <script type="text/babel">
    const { useState, useEffect } = React;
    const ROLES_ALLOWED = ['CEO','COO','CAP','PM','SA','FIN','CON','DEL','QA','Admin'];
    const DEMO = [
      { id: 'STK-001', name: 'COL James Mitchell', title: 'CIO, DHA', org: 'Defense Health Agency', influence: 'High', support: 'Champion', relationship: 'Strong', lastContact: '2025-02-10', opportunity: 'DHA EHR Modernization', notes: 'Key decision maker. Met at HIMSS 2024. Supports cloud-first approach.' },
      { id: 'STK-002', name: 'Dr. Patricia Hayes', title: 'Deputy CTO', org: 'VA OCTO', influence: 'High', support: 'Neutral', relationship: 'Developing', lastContact: '2025-01-28', opportunity: 'VA Claims Processing', notes: 'Interested in AI/ML but cautious about automation scope. Needs data on pilot results.' },
      { id: 'STK-003', name: 'Mark Stevens', title: 'Contracting Officer', org: 'DHA PEO', influence: 'Medium', support: 'Supportive', relationship: 'Established', lastContact: '2025-02-05', opportunity: 'DHA EHR Modernization', notes: 'Fair evaluator. Values compliance documentation. Responsive to technical questions.' },
      { id: 'STK-004', name: 'Lisa Chen', title: 'Program Manager', org: 'Incumbent (Leidos)', influence: 'Medium', support: 'Blocker', relationship: 'Adversarial', lastContact: '2024-12-15', opportunity: 'VA Claims Processing', notes: 'Will leverage incumbent advantage. Counter with innovation differentiation.' },
      { id: 'STK-005', name: 'Robert Kim', title: 'ISSO', org: 'DHA Cybersecurity', influence: 'Medium', support: 'Neutral', relationship: 'New', lastContact: '2025-02-12', opportunity: 'DHA EHR Modernization', notes: 'Focused on ATO timeline. Our CMMC L2 cert is a differentiator.' },
      { id: 'STK-006', name: 'Sarah Anderson', title: 'Deputy Director', org: 'CMS CMMI', influence: 'High', support: 'Supportive', relationship: 'Strong', lastContact: '2025-01-30', opportunity: 'CMS Data Analytics', notes: 'Former colleague of Mary. Strong advocate for data-driven innovation.' },
    ];
    const supportColors = { Champion: '#10B981', Supportive: '#00E5FA', Neutral: '#F59E0B', Blocker: '#EF4444' };
    const influenceSize = { High: 'text-lg', Medium: 'text-base', Low: 'text-sm' };

    const App = () => {
      const [stakeholders, setStakeholders] = useState(DEMO);
      const [filter, setFilter] = useState('all');
      const [expandedId, setExpandedId] = useState(null);
      const [connected, setConnected] = useState(false);

      useEffect(() => {
        const role = localStorage.getItem('missionpulse_role');
        if (role && !ROLES_ALLOWED.includes(role)) { window.location.href = 'index.html'; return; }
        const load = async () => { try { if (typeof sbClient !== 'undefined') { const { data } = await sbClient.from('stakeholders').select('*'); if (data?.length) { setStakeholders(data); setConnected(true); } } } catch (e) {} };
        load();
      }, []);

      const filtered = stakeholders.filter(s => filter === 'all' || s.support === filter);

      return React.createElement('div', { className: 'min-h-screen p-6', style: { background: '#00050F' } },
        React.createElement('div', { className: 'flex items-center justify-between mb-6' },
          React.createElement('div', null,
            React.createElement('h1', { className: 'text-2xl font-bold text-white' }, 'üó∫Ô∏è Stakeholder Map'),
            React.createElement('p', { className: 'text-gray-400 text-sm mt-1' }, 'Customer relationships ‚Ä¢ Influence mapping ‚Ä¢ Engagement tracking')
          ),
          React.createElement('div', { className: 'flex items-center gap-3' },
            React.createElement('div', { className: 'flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs', style: { background: connected ? 'rgba(16,185,129,0.15)' : 'rgba(245,158,11,0.15)', color: connected ? '#10B981' : '#F59E0B', border: `1px solid ${connected ? 'rgba(16,185,129,0.3)' : 'rgba(245,158,11,0.3)'}` } },
              React.createElement('span', { className: `w-2 h-2 rounded-full ${connected ? 'bg-green-500' : 'bg-yellow-500'}` }), connected ? 'Connected' : 'Demo Mode'
            ),
            React.createElement('a', { href: 'index.html', className: 'px-3 py-1.5 rounded-lg text-xs text-gray-400 hover:text-white', style: { border: '1px solid rgba(255,255,255,0.1)' } }, '‚Üê Dashboard')
          )
        ),
        React.createElement('div', { className: 'grid grid-cols-4 gap-4 mb-6' },
          [
            { label: 'Champions', value: stakeholders.filter(s => s.support === 'Champion').length, color: '#10B981' },
            { label: 'Supportive', value: stakeholders.filter(s => s.support === 'Supportive').length, color: '#00E5FA' },
            { label: 'Neutral', value: stakeholders.filter(s => s.support === 'Neutral').length, color: '#F59E0B' },
            { label: 'Blockers', value: stakeholders.filter(s => s.support === 'Blocker').length, color: '#EF4444' }
          ].map((s, i) => React.createElement('div', { key: i, className: 'glass-card rounded-lg p-4 text-center animate-fade-up', style: { animationDelay: `${i*0.1}s` } },
            React.createElement('div', { className: 'font-mono text-2xl font-bold', style: { color: s.color } }, s.value),
            React.createElement('div', { className: 'text-xs text-gray-400 mt-1' }, s.label)
          ))
        ),
        React.createElement('div', { className: 'flex gap-2 mb-6' },
          ['all', 'Champion', 'Supportive', 'Neutral', 'Blocker'].map(f =>
            React.createElement('button', { key: f, className: `px-3 py-2 rounded-lg text-xs font-medium ${filter === f ? 'text-white' : 'text-gray-400'}`, style: { background: filter === f ? 'rgba(0,229,250,0.15)' : 'transparent', border: `1px solid ${filter === f ? 'rgba(0,229,250,0.4)' : 'rgba(255,255,255,0.1)'}` }, onClick: () => setFilter(f) }, f === 'all' ? 'All' : f)
          )
        ),
        React.createElement('div', { className: 'space-y-3 mb-8' },
          filtered.map((s, i) => React.createElement('div', { key: s.id, className: 'glass-card rounded-lg overflow-hidden animate-fade-up', style: { animationDelay: `${i*0.05}s`, borderLeftWidth: '3px', borderLeftColor: supportColors[s.support] } },
            React.createElement('div', { className: 'p-4 cursor-pointer hover:bg-white/5', onClick: () => setExpandedId(expandedId === s.id ? null : s.id) },
              React.createElement('div', { className: 'flex items-center justify-between' },
                React.createElement('div', { className: 'flex items-center gap-3' },
                  React.createElement('div', { className: 'w-10 h-10 rounded-lg flex items-center justify-center font-bold text-sm text-white', style: { background: `${supportColors[s.support]}30` } }, s.name.split(' ').slice(-1)[0][0] + (s.name.split(' ')[1] || '')[0]),
                  React.createElement('div', null,
                    React.createElement('h3', { className: 'text-white font-semibold' }, s.name),
                    React.createElement('div', { className: 'text-xs text-gray-400' }, `${s.title} ‚Ä¢ ${s.org}`)
                  )
                ),
                React.createElement('div', { className: 'flex items-center gap-3' },
                  React.createElement('span', { className: 'px-2 py-0.5 rounded text-xs font-medium', style: { background: `${supportColors[s.support]}20`, color: supportColors[s.support] } }, s.support),
                  React.createElement('span', { className: 'text-xs text-gray-500' }, `Influence: ${s.influence}`),
                  React.createElement('span', { className: 'text-xs text-gray-500 font-mono' }, s.lastContact),
                  React.createElement('span', { className: 'text-gray-500' }, expandedId === s.id ? '‚ñæ' : '‚ñ∏')
                )
              )
            ),
            expandedId === s.id && React.createElement('div', { className: 'border-t border-gray-800 p-4' },
              React.createElement('div', { className: 'grid grid-cols-3 gap-3 mb-3' },
                [{ l: 'Opportunity', v: s.opportunity }, { l: 'Relationship', v: s.relationship }, { l: 'Last Contact', v: s.lastContact }].map((d, di) =>
                  React.createElement('div', { key: di, className: 'bg-gray-900/50 rounded p-2' },
                    React.createElement('div', { className: 'text-xs text-gray-500' }, d.l),
                    React.createElement('div', { className: 'text-sm text-white' }, d.v)
                  )
                )
              ),
              React.createElement('p', { className: 'text-sm text-gray-300 mb-3' }, s.notes),
              React.createElement('div', { className: 'flex gap-2' },
                React.createElement('button', { className: 'px-3 py-1.5 rounded text-xs font-medium', style: { background: 'rgba(0,229,250,0.15)', color: '#00E5FA', border: '1px solid rgba(0,229,250,0.3)' } }, 'üìß Log Contact'),
                React.createElement('button', { className: 'px-3 py-1.5 rounded text-xs font-medium', style: { background: 'rgba(99,102,241,0.15)', color: '#818CF8', border: '1px solid rgba(99,102,241,0.3)' } }, 'ü§ñ AI: Engagement Strategy')
              )
            )
          ))
        ),
        React.createElement('div', { className: 'text-center py-4 border-t border-gray-800' },
          React.createElement('p', { className: 'text-xs text-gray-600' }, '‚ö†Ô∏è AI GENERATED - REQUIRES HUMAN REVIEW ‚Ä¢ MissionPulse by Mission Meets Tech ‚Ä¢ NIST 800-171 Compliant')
        )
      );
    };
    ReactDOM.render(React.createElement(App), document.getElementById('root'));
  </script>
</body>
</html>
