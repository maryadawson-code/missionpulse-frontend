<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MissionPulse - Lessons Learned Repository</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'mp-navy': '#00050F',
                        'mp-cyan': '#00E5FA',
                        'mp-slate': '#0A1628'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        * { font-family: 'Inter', sans-serif; }
    </style>
  <script src="rbac-guard.js"></script>
</head>
<body class="bg-mp-navy min-h-screen text-white">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useMemo } = React;

        const lessonsData = [
            {
                id: 'LL-001',
                title: 'Early Key Personnel Commitment Critical',
                category: 'Staffing',
                outcome: 'win',
                opportunity: 'DHA EHR Modernization',
                agency: 'DHA',
                date: '2024-01-15',
                author: 'Dr. Sarah Chen',
                impact: 'high',
                description: 'Securing key personnel commitment letters 4 weeks before submission significantly strengthened our staffing plan credibility.',
                whatWorked: 'Started key personnel outreach during capture phase, not proposal phase. Had backup candidates identified for each position.',
                whatDidnt: 'Initial attempts to recruit externally were too slow. Internal candidates proved more reliable.',
                actionItems: ['Begin key personnel identification at capture kickoff', 'Maintain bench of qualified candidates', 'Get commitment letters minimum 3 weeks before due date'],
                tags: ['key personnel', 'staffing', 'planning', 'commitment letters'],
                votes: 15,
                views: 234
            },
            {
                id: 'LL-002',
                title: 'Compliance Matrix as Living Document',
                category: 'Compliance',
                outcome: 'win',
                opportunity: 'VA Cloud Migration',
                agency: 'VA',
                date: '2024-01-20',
                author: 'Marcus Thompson',
                impact: 'high',
                description: 'Treating the compliance matrix as a living document updated daily during proposal development prevented last-minute scrambles.',
                whatWorked: 'Daily 15-minute compliance standups. Color-coded status tracking. Volume leads responsible for their sections.',
                whatDidnt: 'Excel-based tracking became unwieldy. Moving to SharePoint improved collaboration.',
                actionItems: ['Implement daily compliance reviews', 'Use collaborative tools not spreadsheets', 'Assign clear ownership per section'],
                tags: ['compliance', 'section L', 'section M', 'tracking'],
                votes: 23,
                views: 312
            },
            {
                id: 'LL-003',
                title: 'Underestimated Pricing Complexity',
                category: 'Pricing',
                outcome: 'loss',
                opportunity: 'DoD Cyber Assessment',
                agency: 'DoD',
                date: '2024-02-10',
                author: 'Amanda Rodriguez',
                impact: 'critical',
                description: 'Cost volume was rushed due to late technical approach finalization, resulting in pricing inconsistencies that evaluators noted.',
                whatWorked: 'BOE template from previous wins provided good foundation.',
                whatDidnt: 'Started pricing too late. Technical-to-pricing handoff was unclear. No time for independent cost estimate review.',
                actionItems: ['Start pricing parallel to technical, not after', 'Define clear handoff milestones', 'Budget 5 days for ICE review', 'Lock technical approach 2 weeks before pricing due'],
                tags: ['pricing', 'BOE', 'cost volume', 'schedule'],
                votes: 31,
                views: 456
            },
            {
                id: 'LL-004',
                title: 'Customer Relationship Drove Win',
                category: 'Capture',
                outcome: 'win',
                opportunity: 'CMS Data Analytics',
                agency: 'CMS',
                date: '2024-02-05',
                author: 'Mary Womack',
                impact: 'high',
                description: 'Consistent customer engagement over 18 months before RFP release positioned us as trusted partner, not just bidder.',
                whatWorked: 'Monthly capability briefings. Responded to RFI thoughtfully. Attended every industry day. Built relationships at multiple levels.',
                whatDidnt: 'Early engagement with wrong office. Took time to identify actual decision makers.',
                actionItems: ['Map customer org chart early', 'Engage at technical and executive levels', 'Document all touchpoints in CRM', 'Plan 12-18 month pre-RFP engagement'],
                tags: ['capture', 'customer relationships', 'pre-RFP', 'industry day'],
                votes: 28,
                views: 389
            },
            {
                id: 'LL-005',
                title: 'Past Performance Relevancy Gaps',
                category: 'Past Performance',
                outcome: 'loss',
                opportunity: 'IHS Telehealth',
                agency: 'IHS',
                date: '2023-12-15',
                author: 'Jennifer Williams',
                impact: 'critical',
                description: 'Our past performance, while strong, did not clearly demonstrate relevancy to the specific telehealth requirements.',
                whatWorked: 'CPARS ratings were excellent. Customer references responded promptly.',
                whatDidnt: 'Failed to explicitly map our experience to PWS requirements. Evaluators had to infer relevancy.',
                actionItems: ['Create relevancy matrix for each PP ref', 'Explicitly address each evaluation factor', 'Include metrics that mirror PWS requirements', 'Get customer quotes specific to relevant capabilities'],
                tags: ['past performance', 'relevancy', 'CPARS', 'references'],
                votes: 19,
                views: 278
            },
            {
                id: 'LL-006',
                title: 'Graphics Drove Technical Understanding',
                category: 'Technical',
                outcome: 'win',
                opportunity: 'VA Cloud Migration',
                agency: 'VA',
                date: '2024-01-28',
                author: 'David Park',
                impact: 'medium',
                description: 'Investment in professional graphics and clear action captions significantly improved evaluator comprehension.',
                whatWorked: 'Dedicated graphics designer. Action caption format. Graphics storyboard before writing.',
                whatDidnt: 'Initial DIY approach produced cluttered, hard-to-read visuals.',
                actionItems: ['Budget for graphics support on all pursuits >$10M', 'Create graphics storyboard at pink team', 'Use action captions exclusively', 'Limit 3 key messages per graphic'],
                tags: ['graphics', 'technical approach', 'visuals', 'action captions'],
                votes: 22,
                views: 301
            }
        ];

        const categories = ['All', 'Capture', 'Technical', 'Pricing', 'Staffing', 'Past Performance', 'Compliance', 'Management'];
        const agencies = ['All', 'DHA', 'VA', 'CMS', 'DoD', 'IHS', 'HHS'];

        function LessonCard({ lesson, onSelect, isSelected }) {
            return (
                <div 
                    className={`bg-mp-slate rounded-xl p-4 cursor-pointer transition-all hover:bg-mp-slate/80 ${isSelected ? 'ring-2 ring-mp-cyan' : ''}`}
                    onClick={() => onSelect(lesson)}
                >
                    <div className="flex items-start justify-between mb-3">
                        <div className="flex-1">
                            <div className="flex items-center gap-2 mb-1">
                                <span className={`px-2 py-0.5 rounded text-xs font-medium ${
                                    lesson.outcome === 'win' ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'
                                }`}>
                                    {lesson.outcome.toUpperCase()}
                                </span>
                                <span className={`px-2 py-0.5 rounded text-xs ${
                                    lesson.impact === 'critical' ? 'bg-red-500/20 text-red-400' :
                                    lesson.impact === 'high' ? 'bg-orange-500/20 text-orange-400' :
                                    'bg-blue-500/20 text-blue-400'
                                }`}>
                                    {lesson.impact.toUpperCase()} IMPACT
                                </span>
                            </div>
                            <h3 className="font-semibold text-white">{lesson.title}</h3>
                            <p className="text-sm text-gray-400">{lesson.opportunity} ‚Ä¢ {lesson.agency}</p>
                        </div>
                    </div>

                    <p className="text-sm text-gray-300 mb-3 line-clamp-2">{lesson.description}</p>

                    <div className="flex flex-wrap gap-1 mb-3">
                        {lesson.tags.slice(0, 3).map((tag, idx) => (
                            <span key={idx} className="px-2 py-0.5 bg-mp-navy rounded text-xs text-gray-400">
                                #{tag}
                            </span>
                        ))}
                    </div>

                    <div className="flex items-center justify-between text-xs text-gray-400">
                        <span>By {lesson.author} ‚Ä¢ {lesson.date}</span>
                        <div className="flex items-center gap-3">
                            <span>üëç {lesson.votes}</span>
                            <span>üëÅ {lesson.views}</span>
                        </div>
                    </div>
                </div>
            );
        }

        function LessonDetail({ lesson }) {
            return (
                <div>
                    {/* Header */}
                    <div className="bg-mp-slate rounded-xl p-6 mb-6">
                        <div className="flex items-start justify-between mb-4">
                            <div>
                                <div className="flex items-center gap-2 mb-2">
                                    <span className={`px-2 py-1 rounded text-xs font-medium ${
                                        lesson.outcome === 'win' ? 'bg-green-500/20 text-green-400 border border-green-500' : 'bg-red-500/20 text-red-400 border border-red-500'
                                    }`}>
                                        {lesson.outcome === 'win' ? 'üèÜ WIN' : '‚ùå LOSS'}
                                    </span>
                                    <span className="px-2 py-1 bg-mp-navy rounded text-xs text-gray-400">
                                        {lesson.category}
                                    </span>
                                </div>
                                <h2 className="text-2xl font-bold text-white">{lesson.title}</h2>
                                <p className="text-gray-400 mt-1">{lesson.opportunity} ‚Ä¢ {lesson.agency} ‚Ä¢ {lesson.date}</p>
                            </div>
                            <div className="flex gap-2">
                                <button className="px-3 py-1.5 border border-gray-700 rounded-lg text-sm text-gray-400 hover:bg-mp-navy transition-colors">
                                    üëç {lesson.votes}
                                </button>
                                <button className="px-3 py-1.5 border border-gray-700 rounded-lg text-sm text-gray-400 hover:bg-mp-navy transition-colors">
                                    üîó Share
                                </button>
                            </div>
                        </div>

                        <p className="text-gray-300">{lesson.description}</p>

                        <div className="flex items-center gap-4 mt-4 pt-4 border-t border-gray-800">
                            <div className="flex items-center gap-2">
                                <div className="w-8 h-8 bg-mp-cyan rounded-full flex items-center justify-center text-mp-navy font-bold text-sm">
                                    {lesson.author.split(' ').map(n => n[0]).join('')}
                                </div>
                                <span className="text-sm text-gray-400">{lesson.author}</span>
                            </div>
                            <span className="text-sm text-gray-500">‚Ä¢</span>
                            <span className="text-sm text-gray-400">{lesson.views} views</span>
                        </div>
                    </div>

                    {/* What Worked */}
                    <div className="bg-green-500/10 border border-green-500/30 rounded-xl p-4 mb-4">
                        <h3 className="font-semibold text-green-400 mb-3 flex items-center gap-2">
                            <span>‚úÖ</span> What Worked
                        </h3>
                        <p className="text-gray-300">{lesson.whatWorked}</p>
                    </div>

                    {/* What Didn't Work */}
                    <div className="bg-red-500/10 border border-red-500/30 rounded-xl p-4 mb-4">
                        <h3 className="font-semibold text-red-400 mb-3 flex items-center gap-2">
                            <span>‚ùå</span> What Didn't Work
                        </h3>
                        <p className="text-gray-300">{lesson.whatDidnt}</p>
                    </div>

                    {/* Action Items */}
                    <div className="bg-mp-slate rounded-xl p-4 mb-4">
                        <h3 className="font-semibold text-white mb-3 flex items-center gap-2">
                            <span>üìã</span> Action Items
                        </h3>
                        <ul className="space-y-2">
                            {lesson.actionItems.map((item, idx) => (
                                <li key={idx} className="flex items-start gap-2 text-gray-300">
                                    <span className="text-mp-cyan mt-1">‚Üí</span>
                                    {item}
                                </li>
                            ))}
                        </ul>
                    </div>

                    {/* Tags */}
                    <div className="bg-mp-slate rounded-xl p-4">
                        <h3 className="font-semibold text-white mb-3">Tags</h3>
                        <div className="flex flex-wrap gap-2">
                            {lesson.tags.map((tag, idx) => (
                                <span key={idx} className="px-3 py-1.5 bg-mp-navy rounded-lg text-sm text-gray-300">
                                    #{tag}
                                </span>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        function App() {
            const [selectedLesson, setSelectedLesson] = useState(lessonsData[0]);
            const [filterCategory, setFilterCategory] = useState('All');
            const [filterAgency, setFilterAgency] = useState('All');
            const [filterOutcome, setFilterOutcome] = useState('all');
            const [searchQuery, setSearchQuery] = useState('');

            const filteredLessons = useMemo(() => {
                return lessonsData.filter(l => {
                    const matchesCategory = filterCategory === 'All' || l.category === filterCategory;
                    const matchesAgency = filterAgency === 'All' || l.agency === filterAgency;
                    const matchesOutcome = filterOutcome === 'all' || l.outcome === filterOutcome;
                    const matchesSearch = l.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                                         l.tags.some(t => t.toLowerCase().includes(searchQuery.toLowerCase()));
                    return matchesCategory && matchesAgency && matchesOutcome && matchesSearch;
                });
            }, [filterCategory, filterAgency, filterOutcome, searchQuery]);

            const metrics = useMemo(() => {
                const total = lessonsData.length;
                const wins = lessonsData.filter(l => l.outcome === 'win').length;
                const losses = lessonsData.filter(l => l.outcome === 'loss').length;
                const highImpact = lessonsData.filter(l => l.impact === 'critical' || l.impact === 'high').length;
                return { total, wins, losses, highImpact };
            }, []);

            return (
                <div className="min-h-screen bg-mp-navy">
                    {/* Header */}
                    <header className="bg-mp-slate border-b border-gray-800 px-6 py-4">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center gap-4">
                                <div className="w-10 h-10 bg-gradient-to-br from-mp-cyan to-blue-600 rounded-lg flex items-center justify-center">
                                    <span className="text-xl">üìñ</span>
                                </div>
                                <div>
                                    <h1 className="text-xl font-bold text-white">Lessons Learned Repository</h1>
                                    <p className="text-sm text-gray-400">Capture institutional knowledge</p>
                                </div>
                            </div>
                            <div className="flex items-center gap-4">
                                <input
                                    type="text"
                                    placeholder="Search lessons..."
                                    value={searchQuery}
                                    onChange={(e) => setSearchQuery(e.target.value)}
                                    className="bg-mp-navy border border-gray-700 rounded-lg px-4 py-2 text-sm text-white w-64"
                                />
                                <button className="bg-mp-cyan text-mp-navy px-4 py-2 rounded-lg font-medium hover:bg-mp-cyan/90 transition-colors">
                                    + Add Lesson
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* Metrics */}
                    <div className="px-6 py-4 border-b border-gray-800">
                        <div className="grid grid-cols-4 gap-4">
                            <div className="bg-mp-slate rounded-xl p-4 text-center">
                                <p className="text-3xl font-bold text-white">{metrics.total}</p>
                                <p className="text-sm text-gray-400">Total Lessons</p>
                            </div>
                            <div className="bg-mp-slate rounded-xl p-4 text-center">
                                <p className="text-3xl font-bold text-green-400">{metrics.wins}</p>
                                <p className="text-sm text-gray-400">From Wins</p>
                            </div>
                            <div className="bg-mp-slate rounded-xl p-4 text-center">
                                <p className="text-3xl font-bold text-red-400">{metrics.losses}</p>
                                <p className="text-sm text-gray-400">From Losses</p>
                            </div>
                            <div className="bg-mp-slate rounded-xl p-4 text-center">
                                <p className="text-3xl font-bold text-orange-400">{metrics.highImpact}</p>
                                <p className="text-sm text-gray-400">High Impact</p>
                            </div>
                        </div>
                    </div>

                    {/* Filters */}
                    <div className="px-6 py-3 border-b border-gray-800 flex items-center gap-4">
                        <select 
                            value={filterCategory}
                            onChange={(e) => setFilterCategory(e.target.value)}
                            className="bg-mp-navy border border-gray-700 rounded-lg px-3 py-2 text-sm text-white"
                        >
                            {categories.map(cat => (
                                <option key={cat} value={cat}>{cat}</option>
                            ))}
                        </select>
                        <select 
                            value={filterAgency}
                            onChange={(e) => setFilterAgency(e.target.value)}
                            className="bg-mp-navy border border-gray-700 rounded-lg px-3 py-2 text-sm text-white"
                        >
                            {agencies.map(a => (
                                <option key={a} value={a}>{a}</option>
                            ))}
                        </select>
                        <div className="flex gap-2 bg-mp-navy rounded-lg p-1">
                            {['all', 'win', 'loss'].map(o => (
                                <button
                                    key={o}
                                    onClick={() => setFilterOutcome(o)}
                                    className={`px-3 py-1 rounded-lg text-sm transition-colors ${
                                        filterOutcome === o ? 'bg-mp-cyan text-mp-navy' : 'text-gray-400 hover:text-white'
                                    }`}
                                >
                                    {o === 'all' ? 'All' : o === 'win' ? 'üèÜ Wins' : '‚ùå Losses'}
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Main Content */}
                    <div className="flex">
                        {/* Lesson List */}
                        <div className="w-1/3 border-r border-gray-800 p-4 space-y-4 max-h-[calc(100vh-280px)] overflow-y-auto">
                            {filteredLessons.map(lesson => (
                                <LessonCard
                                    key={lesson.id}
                                    lesson={lesson}
                                    isSelected={selectedLesson?.id === lesson.id}
                                    onSelect={setSelectedLesson}
                                />
                            ))}
                            {filteredLessons.length === 0 && (
                                <div className="text-center py-12 text-gray-400">
                                    <span className="text-4xl">üì≠</span>
                                    <p className="mt-2">No lessons found</p>
                                </div>
                            )}
                        </div>

                        {/* Lesson Detail */}
                        <div className="flex-1 p-6 max-h-[calc(100vh-280px)] overflow-y-auto">
                            {selectedLesson && <LessonDetail lesson={selectedLesson} />}
                        </div>
                    </div>

                    {/* Footer */}
                    <footer className="fixed bottom-0 left-0 right-0 bg-mp-slate border-t border-gray-800 px-6 py-3">
                        <div className="flex items-center justify-between text-sm text-gray-400">
                            <span>MissionPulse v12 ‚Ä¢ Lessons Learned Repository Module</span>
                            <span className="text-yellow-500">‚ö†Ô∏è AI GENERATED - REQUIRES HUMAN REVIEW</span>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
