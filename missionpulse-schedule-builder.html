<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse — Schedule Builder</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:#00050F;min-height:100vh;color:#e2e8f0}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(0,229,250,0.2);border-radius:3px}</style>
</head>
<body>
  <div id="missionpulse-sidebar"></div>
  <div class="main-content"><div id="root"></div></div>
  <script src="missionpulse-nav.js"></script>
  <script type="text/babel">
    const{useState,useEffect,useMemo}=React;
    const SB_URL='https://qdrtpnpnhkxvfmvfziop.supabase.co';const SB_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5MjMxNDMsImV4cCI6MjA1MzQ5OTE0M30.GFbjgRMgVhMMcnNaJMrLVnJI_u6yBGJOhO-LHKE8sZQ';
    var sbClient;try{sbClient=supabase.createClient(SB_URL,SB_KEY)}catch(e){sbClient=null}
    const ROLES_ALLOWED=['*'];

    const DEMO_WBS=[
      {id:'1.0',title:'Program Management',level:0,start:'2026-04-01',end:'2031-03-31',pct:0,critical:false,milestone:false,deps:[],owner:'Mary Womack'},
      {id:'1.1',title:'  Contract Kickoff',level:1,start:'2026-04-01',end:'2026-04-01',pct:0,critical:true,milestone:true,deps:[],owner:'Mary Womack'},
      {id:'1.2',title:'  PMO Standup',level:1,start:'2026-04-01',end:'2026-04-15',pct:0,critical:true,deps:['1.1'],owner:'Tom Patterson'},
      {id:'1.3',title:'  Monthly PMR',level:1,start:'2026-05-01',end:'2031-03-31',pct:0,critical:false,deps:['1.2'],owner:'Mary Womack'},
      {id:'2.0',title:'Transition',level:0,start:'2026-04-01',end:'2026-06-30',pct:0,critical:true,milestone:false,deps:[],owner:'Tom Patterson'},
      {id:'2.1',title:'  Phase 1: Mobilization',level:1,start:'2026-04-01',end:'2026-04-15',pct:0,critical:true,deps:['1.1'],owner:'Tom Patterson'},
      {id:'2.2',title:'  Phase 2: Knowledge Transfer',level:1,start:'2026-04-16',end:'2026-05-15',pct:0,critical:true,deps:['2.1'],owner:'Tom Patterson'},
      {id:'2.3',title:'  Phase 3: Parallel Ops',level:1,start:'2026-05-16',end:'2026-06-15',pct:0,critical:true,deps:['2.2'],owner:'Tom Patterson'},
      {id:'2.4',title:'  Phase 4: Full Operations',level:1,start:'2026-06-16',end:'2026-06-30',pct:0,critical:true,deps:['2.3'],owner:'Tom Patterson'},
      {id:'2.5',title:'  ★ FOC Declaration',level:1,start:'2026-06-30',end:'2026-06-30',pct:0,critical:true,milestone:true,deps:['2.4'],owner:'Mary Womack'},
      {id:'3.0',title:'Security & ATO',level:0,start:'2026-04-01',end:'2026-07-15',pct:0,critical:true,milestone:false,deps:[],owner:'Angela Foster'},
      {id:'3.1',title:'  RMF Step 1-2: Categorize & Select',level:1,start:'2026-04-01',end:'2026-04-30',pct:0,critical:true,deps:['1.1'],owner:'Angela Foster'},
      {id:'3.2',title:'  RMF Step 3: Implement Controls',level:1,start:'2026-05-01',end:'2026-06-15',pct:0,critical:true,deps:['3.1'],owner:'Angela Foster'},
      {id:'3.3',title:'  RMF Step 4: Assess',level:1,start:'2026-06-16',end:'2026-06-30',pct:0,critical:true,deps:['3.2'],owner:'Robert Jackson'},
      {id:'3.4',title:'  RMF Step 5: Authorize',level:1,start:'2026-07-01',end:'2026-07-15',pct:0,critical:true,deps:['3.3'],owner:'Angela Foster'},
      {id:'3.5',title:'  ★ ATO Granted',level:1,start:'2026-07-15',end:'2026-07-15',pct:0,critical:true,milestone:true,deps:['3.4'],owner:'Angela Foster'},
      {id:'4.0',title:'Technical Delivery',level:0,start:'2026-05-01',end:'2027-03-31',pct:0,critical:false,milestone:false,deps:[],owner:'Sarah Kim'},
      {id:'4.1',title:'  Sprint 1-4: Core Platform',level:1,start:'2026-05-01',end:'2026-06-30',pct:0,critical:false,deps:['2.2'],owner:'Sarah Kim'},
      {id:'4.2',title:'  Sprint 5-8: AI/ML Integration',level:1,start:'2026-07-01',end:'2026-08-31',pct:0,critical:false,deps:['4.1','3.5'],owner:'James Rodriguez'},
      {id:'4.3',title:'  Sprint 9-12: Data Migration',level:1,start:'2026-09-01',end:'2026-10-31',pct:0,critical:false,deps:['4.2'],owner:'Michelle Torres'},
      {id:'4.4',title:'  Sprint 13-16: UAT & Hardening',level:1,start:'2026-11-01',end:'2026-12-31',pct:0,critical:false,deps:['4.3'],owner:'Patricia Nguyen'},
      {id:'4.5',title:'  ★ Production Release',level:1,start:'2027-01-15',end:'2027-01-15',pct:0,critical:false,milestone:true,deps:['4.4'],owner:'Sarah Kim'},
      {id:'5.0',title:'Steady State Operations',level:0,start:'2027-01-15',end:'2031-03-31',pct:0,critical:false,milestone:false,deps:[],owner:'Mary Womack'},
      {id:'5.1',title:'  Help Desk & O&M',level:1,start:'2027-01-15',end:'2031-03-31',pct:0,critical:false,deps:['4.5'],owner:'Kevin Brown'},
      {id:'5.2',title:'  Continuous Monitoring',level:1,start:'2026-07-16',end:'2031-03-31',pct:0,critical:false,deps:['3.5'],owner:'Angela Foster'},
    ];

    const parseDate=d=>new Date(d+'T00:00:00');
    const daysBetween=(a,b)=>Math.round((parseDate(b)-parseDate(a))/(1000*60*60*24));
    const projectStart='2026-04-01';const projectEnd='2027-06-30';
    const totalDays=daysBetween(projectStart,projectEnd);
    const ConnectionDot=({c})=>(<div style={{display:'flex',alignItems:'center',gap:'6px',fontSize:'11px',color:c?'#00ff88':'#f59e0b'}}><div style={{width:'8px',height:'8px',borderRadius:'50%',background:c?'#00ff88':'#f59e0b',boxShadow:`0 0 6px ${c?'#00ff88':'#f59e0b'}`}}/>{c?'LIVE':'DEMO'}</div>);

    const months=useMemo=>{
      const m=[];let d=new Date('2026-04-01');
      while(d<=new Date('2027-06-01')){m.push({label:d.toLocaleString('default',{month:'short',year:'2-digit'}),offset:daysBetween(projectStart,d.toISOString().split('T')[0])});d.setMonth(d.getMonth()+1)}
      return m;
    };
    const monthHeaders=(()=>{const m=[];let d=new Date('2026-04-01');while(d<=new Date('2027-06-01')){m.push({label:d.toLocaleString('default',{month:'short',year:'2-digit'}),offset:daysBetween(projectStart,d.toISOString().split('T')[0])});d.setMonth(d.getMonth()+1)}return m})();

    const App=()=>{
      const[connected,setConnected]=useState(false);
      const[tab,setTab]=useState('gantt');

      useEffect(()=>{if(!sbClient)return;(async()=>{try{const{data,error}=await sbClient.from('opportunities').select('id');if(!error&&data&&data.length>0)setConnected(true)}catch{}})()},[]);

      const milestones=DEMO_WBS.filter(w=>w.milestone);
      const criticalPath=DEMO_WBS.filter(w=>w.critical);

      return(
        <div style={{padding:'24px 32px',maxWidth:'1600px'}}>
          <div style={{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'24px'}}>
            <div>
              <div style={{fontSize:'10px',fontWeight:700,color:'rgba(0,229,250,0.5)',letterSpacing:'2px',textTransform:'uppercase',marginBottom:'4px'}}>PROJECT SCHEDULING</div>
              <h1 style={{fontSize:'26px',fontWeight:800,color:'white',letterSpacing:'-0.5px',margin:0}}>Schedule Builder</h1>
              <div style={{fontSize:'12px',color:'#5a7a9a',marginTop:'4px'}}>DHA EHR Modernization • WBS • Gantt • Critical path • Dependencies</div>
            </div>
            <ConnectionDot c={connected}/>
          </div>

          <div style={{display:'flex',gap:'10px',flexWrap:'wrap',marginBottom:'20px'}}>
            {[
              {label:'WBS Items',value:DEMO_WBS.length,color:'#00E5FA'},
              {label:'Milestones',value:milestones.length,color:'#f59e0b'},
              {label:'Critical Path',value:criticalPath.length+' items',color:'#ef4444'},
              {label:'Duration',value:'5 years',color:'#a78bfa'},
              {label:'ATO Target',value:'Jul 15 \'26',color:'#00ff88'},
              {label:'FOC Target',value:'Jun 30 \'26',color:'#00ff88'},
            ].map(s=>(
              <div key={s.label} style={{background:'rgba(10,22,40,0.7)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'10px',padding:'10px 16px',minWidth:'120px'}}>
                <div style={{fontSize:'9px',fontWeight:700,color:'#5a7a9a',letterSpacing:'0.5px',textTransform:'uppercase'}}>{s.label}</div>
                <div style={{fontSize:'22px',fontWeight:800,color:s.color,letterSpacing:'-0.5px'}}>{s.value}</div>
              </div>
            ))}
          </div>

          <div style={{display:'flex',gap:'4px',marginBottom:'16px'}}>
            {[{k:'gantt',l:'Gantt Chart'},{k:'wbs',l:'WBS Table'},{k:'milestones',l:'Milestones'},{k:'critical',l:'Critical Path'}].map(t=>(
              <button key={t.k} onClick={()=>setTab(t.k)} style={{padding:'7px 16px',fontSize:'12px',fontWeight:600,borderRadius:'8px',border:'none',cursor:'pointer',background:tab===t.k?'rgba(0,229,250,0.15)':'rgba(10,22,40,0.5)',color:tab===t.k?'#00E5FA':'#5a7a9a'}}>{t.l}</button>
            ))}
          </div>

          {/* GANTT */}
          {tab==='gantt'&&(
            <div style={{background:'rgba(10,22,40,0.5)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'12px',overflow:'auto'}}>
              <div style={{display:'flex',minWidth:'1200px'}}>
                <div style={{width:'280px',flexShrink:0,borderRight:'1px solid rgba(0,229,250,0.08)'}}>
                  <div style={{padding:'8px 10px',borderBottom:'1px solid rgba(0,229,250,0.08)',fontSize:'9px',fontWeight:700,color:'#5a7a9a'}}>TASK</div>
                  {DEMO_WBS.map(w=>(
                    <div key={w.id} style={{padding:'5px 10px',borderBottom:'1px solid rgba(0,229,250,0.03)',fontSize:w.level===0?'11px':'10px',fontWeight:w.level===0?700:400,color:w.level===0?'white':w.milestone?'#f59e0b':'#94a3b8',height:'28px',display:'flex',alignItems:'center'}}>
                      <span style={{fontFamily:'monospace',fontSize:'9px',color:'#3e4f63',marginRight:'6px',minWidth:'28px'}}>{w.id}</span>{w.title.trim()}
                    </div>
                  ))}
                </div>
                <div style={{flex:1,position:'relative'}}>
                  {/* Month headers */}
                  <div style={{display:'flex',borderBottom:'1px solid rgba(0,229,250,0.08)',height:'28px',position:'relative'}}>
                    {monthHeaders.map((m,i)=>(
                      <div key={i} style={{position:'absolute',left:`${(m.offset/totalDays)*100}%`,fontSize:'9px',color:'#5a7a9a',padding:'6px 4px',borderLeft:'1px solid rgba(0,229,250,0.06)'}}>{m.label}</div>
                    ))}
                  </div>
                  {/* Bars */}
                  {DEMO_WBS.map(w=>{
                    const startOff=Math.max(0,daysBetween(projectStart,w.start));
                    const endOff=Math.min(totalDays,daysBetween(projectStart,w.end>projectEnd?projectEnd:w.end));
                    const left=(startOff/totalDays)*100;
                    const width=Math.max(0.3,((endOff-startOff)/totalDays)*100);
                    const barColor=w.milestone?'#f59e0b':w.critical?'#ef4444':w.level===0?'#00E5FA':'#0088cc';
                    return(
                      <div key={w.id} style={{height:'28px',position:'relative',borderBottom:'1px solid rgba(0,229,250,0.03)'}}>
                        {w.milestone?(
                          <div style={{position:'absolute',left:`${left}%`,top:'8px',width:'12px',height:'12px',background:barColor,transform:'rotate(45deg) translateX(-50%)',borderRadius:'2px'}}/>
                        ):(
                          <div style={{position:'absolute',left:`${left}%`,top:'9px',width:`${width}%`,height:w.level===0?'10px':'8px',background:barColor,borderRadius:'3px',opacity:w.level===0?0.7:0.9,minWidth:'4px'}}/>
                        )}
                      </div>
                    );
                  })}
                </div>
              </div>
              <div style={{padding:'8px 12px',display:'flex',gap:'12px',fontSize:'10px',borderTop:'1px solid rgba(0,229,250,0.06)'}}>
                <span style={{display:'flex',alignItems:'center',gap:'4px'}}><div style={{width:'14px',height:'6px',borderRadius:'2px',background:'#ef4444'}}/>Critical Path</span>
                <span style={{display:'flex',alignItems:'center',gap:'4px'}}><div style={{width:'14px',height:'6px',borderRadius:'2px',background:'#0088cc'}}/>Task</span>
                <span style={{display:'flex',alignItems:'center',gap:'4px'}}><div style={{width:'8px',height:'8px',borderRadius:'1px',background:'#f59e0b',transform:'rotate(45deg)'}}/>Milestone</span>
              </div>
            </div>
          )}

          {/* WBS TABLE */}
          {tab==='wbs'&&(
            <div style={{background:'rgba(10,22,40,0.5)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'12px',overflow:'auto'}}>
              <table style={{width:'100%',borderCollapse:'collapse',fontSize:'12px'}}>
                <thead><tr style={{borderBottom:'1px solid rgba(0,229,250,0.1)'}}>
                  {['WBS','Task','Start','End','Days','Deps','Owner','CP'].map(h=>(
                    <th key={h} style={{padding:'10px 8px',textAlign:'left',color:'#5a7a9a',fontWeight:700,fontSize:'10px',letterSpacing:'0.5px'}}>{h}</th>
                  ))}
                </tr></thead>
                <tbody>
                  {DEMO_WBS.map(w=>(
                    <tr key={w.id} style={{borderBottom:'1px solid rgba(0,229,250,0.04)',background:w.level===0?'rgba(0,229,250,0.02)':'transparent'}}>
                      <td style={{padding:'7px 8px',fontFamily:'monospace',fontSize:'10px',color:'#00E5FA',fontWeight:700}}>{w.id}</td>
                      <td style={{padding:'7px 8px',fontWeight:w.level===0?700:400,color:w.milestone?'#f59e0b':'white'}}>{w.milestone?'★ ':''}{w.title.trim()}</td>
                      <td style={{padding:'7px 8px',fontSize:'10px',color:'#94a3b8'}}>{w.start}</td>
                      <td style={{padding:'7px 8px',fontSize:'10px',color:'#94a3b8'}}>{w.end}</td>
                      <td style={{padding:'7px 8px',fontSize:'10px',color:'#5a7a9a',textAlign:'center'}}>{daysBetween(w.start,w.end)||'—'}</td>
                      <td style={{padding:'7px 8px',fontFamily:'monospace',fontSize:'9px',color:'#3e4f63'}}>{w.deps.join(', ')||'—'}</td>
                      <td style={{padding:'7px 8px',fontSize:'10px',color:'#94a3b8'}}>{w.owner}</td>
                      <td style={{padding:'7px 8px',textAlign:'center'}}>{w.critical?<span style={{color:'#ef4444',fontWeight:700}}>●</span>:''}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}

          {/* MILESTONES */}
          {tab==='milestones'&&(
            <div style={{display:'flex',flexDirection:'column',gap:'8px'}}>
              {milestones.map(m=>(
                <div key={m.id} style={{background:'rgba(10,22,40,0.5)',border:'1px solid rgba(245,158,11,0.12)',borderRadius:'10px',padding:'14px 18px',display:'flex',alignItems:'center',gap:'14px'}}>
                  <div style={{width:'40px',height:'40px',borderRadius:'8px',background:'rgba(245,158,11,0.08)',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'18px',flexShrink:0}}>★</div>
                  <div style={{flex:1}}>
                    <div style={{fontSize:'14px',fontWeight:700,color:'#f59e0b'}}>{m.title.trim()}</div>
                    <div style={{display:'flex',gap:'12px',marginTop:'3px',fontSize:'11px',color:'#5a7a9a'}}>
                      <span>Date: <strong style={{color:'#e2e8f0'}}>{m.start}</strong></span>
                      <span>Owner: {m.owner}</span>
                      <span>Deps: {m.deps.join(', ')||'None'}</span>
                      {m.critical&&<span style={{color:'#ef4444',fontWeight:600}}>● Critical Path</span>}
                    </div>
                  </div>
                </div>
              ))}
            </div>
          )}

          {/* CRITICAL PATH */}
          {tab==='critical'&&(
            <div style={{display:'flex',flexDirection:'column',gap:'0'}}>
              <div style={{fontSize:'12px',fontWeight:700,color:'#ef4444',marginBottom:'10px'}}>Critical Path — {criticalPath.length} items driving the schedule</div>
              {criticalPath.map((w,i)=>(
                <div key={w.id} style={{display:'flex',gap:'12px',alignItems:'flex-start',paddingLeft:'20px',paddingBottom:'8px',position:'relative'}}>
                  {i<criticalPath.length-1&&<div style={{position:'absolute',left:'10px',top:'14px',bottom:'0',width:'2px',background:'rgba(239,68,68,0.2)'}}/>}
                  <div style={{position:'absolute',left:'4px',top:'4px',width:'14px',height:'14px',borderRadius:'50%',background:w.milestone?'#f59e0b':'rgba(239,68,68,0.15)',border:`2px solid ${w.milestone?'#f59e0b':'#ef4444'}`,zIndex:1}}/>
                  <div style={{flex:1,background:'rgba(10,22,40,0.5)',border:'1px solid rgba(239,68,68,0.08)',borderRadius:'8px',padding:'8px 12px',marginLeft:'10px'}}>
                    <div style={{display:'flex',alignItems:'center',gap:'6px'}}>
                      <span style={{fontFamily:'monospace',fontSize:'10px',fontWeight:700,color:'#ef4444'}}>{w.id}</span>
                      <span style={{fontSize:'12px',fontWeight:600,color:'white'}}>{w.title.trim()}</span>
                      {w.milestone&&<span style={{fontSize:'9px',padding:'1px 5px',borderRadius:'3px',background:'rgba(245,158,11,0.12)',color:'#f59e0b'}}>MILESTONE</span>}
                    </div>
                    <div style={{fontSize:'10px',color:'#5a7a9a',marginTop:'2px'}}>{w.start} → {w.end} | {w.owner} | Deps: {w.deps.join(', ')||'None'}</div>
                  </div>
                </div>
              ))}
            </div>
          )}

          <div style={{textAlign:'center',padding:'20px 0',marginTop:'28px',borderTop:'1px solid rgba(0,229,250,0.06)',fontSize:'10px',color:'rgba(148,163,184,0.4)',lineHeight:'1.8'}}>⚠️ AI GENERATED — REQUIRES HUMAN REVIEW<br/>MissionPulse v12.0 — Mission Meets Tech | CMMC 2.0 L2 Compliant</div>
        </div>
      );
    };
    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  </script>
</body>
</html>
