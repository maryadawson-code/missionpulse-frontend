<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M14 Post-Award Dashboard | MissionPulse v12</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'pulse-cyan': '#00E5FA',
                        'deep-navy': '#00050F',
                        'navy-light': '#0a1628',
                        'navy-mid': '#162033',
                        'success': '#10B981',
                        'warning': '#F59E0B',
                        'danger': '#EF4444',
                        'info': '#3B82F6'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .glass-card {
            background: linear-gradient(135deg, rgba(22, 32, 51, 0.9) 0%, rgba(10, 22, 40, 0.95) 100%);
            border: 1px solid rgba(0, 229, 250, 0.2);
            backdrop-filter: blur(10px);
        }
        .glass-card:hover {
            border-color: rgba(0, 229, 250, 0.4);
            box-shadow: 0 0 30px rgba(0, 229, 250, 0.1);
        }
        .pulse-glow {
            box-shadow: 0 0 20px rgba(0, 229, 250, 0.3);
        }
        .progress-ring {
            transition: stroke-dashoffset 0.5s ease-in-out;
        }
        @keyframes pulse-ring {
            0% { box-shadow: 0 0 0 0 rgba(0, 229, 250, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0, 229, 250, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 229, 250, 0); }
        }
        .alert-pulse {
            animation: pulse-ring 2s infinite;
        }
        .tab-active {
            border-bottom: 2px solid #00E5FA;
            color: #00E5FA;
        }
    </style>
</head>
<body class="bg-deep-navy min-h-screen text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // ============ DEMO DATA ============
        const DEMO_CONTRACT = {
            id: 'DHA-EMR-2024-001',
            name: 'DHA Electronic Medical Records Modernization',
            agency: 'Defense Health Agency',
            type: 'IDIQ Task Order',
            value: 12500000,
            startDate: '2024-06-01',
            endDate: '2027-05-31',
            pop: '36 months',
            coName: 'Jennifer Martinez',
            coEmail: 'jennifer.martinez@dha.mil',
            corName: 'Michael Chen',
            corEmail: 'michael.chen@dha.mil',
            status: 'Active',
            currentPhase: 'Phase 2 - Development',
            percentComplete: 35
        };

        const DEMO_MILESTONES = [
            { id: 'MS001', name: 'Kickoff Meeting', dueDate: '2024-06-15', status: 'Completed', actualDate: '2024-06-15', deliverables: ['Kickoff Presentation', 'Project Charter'] },
            { id: 'MS002', name: 'Requirements Analysis', dueDate: '2024-08-01', status: 'Completed', actualDate: '2024-07-28', deliverables: ['Requirements Document', 'Use Cases'] },
            { id: 'MS003', name: 'System Design Review', dueDate: '2024-10-15', status: 'Completed', actualDate: '2024-10-18', deliverables: ['Architecture Document', 'Design Specs'] },
            { id: 'MS004', name: 'Alpha Release', dueDate: '2025-01-15', status: 'In Progress', actualDate: null, deliverables: ['Alpha Software', 'Test Plan'] },
            { id: 'MS005', name: 'User Acceptance Testing', dueDate: '2025-04-01', status: 'Upcoming', actualDate: null, deliverables: ['UAT Report', 'Defect Log'] },
            { id: 'MS006', name: 'Beta Release', dueDate: '2025-07-01', status: 'Upcoming', actualDate: null, deliverables: ['Beta Software', 'Training Materials'] },
            { id: 'MS007', name: 'Production Deployment', dueDate: '2025-10-01', status: 'Upcoming', actualDate: null, deliverables: ['Production System', 'Operations Guide'] },
            { id: 'MS008', name: 'Phase 2 Complete', dueDate: '2026-01-31', status: 'Upcoming', actualDate: null, deliverables: ['Phase 2 Report', 'Lessons Learned'] }
        ];

        const DEMO_INVOICES = [
            { id: 'INV-001', period: 'Jun 2024', amount: 425000, submitted: '2024-07-05', status: 'Paid', paidDate: '2024-07-28' },
            { id: 'INV-002', period: 'Jul 2024', amount: 512000, submitted: '2024-08-05', status: 'Paid', paidDate: '2024-08-25' },
            { id: 'INV-003', period: 'Aug 2024', amount: 498000, submitted: '2024-09-05', status: 'Paid', paidDate: '2024-09-22' },
            { id: 'INV-004', period: 'Sep 2024', amount: 535000, submitted: '2024-10-05', status: 'Paid', paidDate: '2024-10-30' },
            { id: 'INV-005', period: 'Oct 2024', amount: 521000, submitted: '2024-11-05', status: 'Paid', paidDate: '2024-11-27' },
            { id: 'INV-006', period: 'Nov 2024', amount: 548000, submitted: '2024-12-05', status: 'Processing', paidDate: null },
            { id: 'INV-007', period: 'Dec 2024', amount: 562000, submitted: '2025-01-06', status: 'Submitted', paidDate: null }
        ];

        const DEMO_KEY_PERSONNEL = [
            { id: 'KP001', name: 'Dr. Sarah Mitchell', role: 'Program Manager', laborCat: 'PM III', status: 'Active', startDate: '2024-06-01', utilization: 95, certifications: ['PMP', 'ITIL'], keyPerson: true },
            { id: 'KP002', name: 'James Rodriguez', role: 'Technical Lead', laborCat: 'SA IV', status: 'Active', startDate: '2024-06-01', utilization: 100, certifications: ['AWS SA Pro', 'CISSP'], keyPerson: true },
            { id: 'KP003', name: 'Emily Chen', role: 'Lead Developer', laborCat: 'SE III', status: 'Active', startDate: '2024-06-15', utilization: 100, certifications: ['AWS Dev', 'Scrum Master'], keyPerson: true },
            { id: 'KP004', name: 'Michael Thompson', role: 'Security Engineer', laborCat: 'SE II', status: 'Active', startDate: '2024-07-01', utilization: 85, certifications: ['CISSP', 'CEH'], keyPerson: false },
            { id: 'KP005', name: 'Amanda Foster', role: 'Business Analyst', laborCat: 'BA II', status: 'Active', startDate: '2024-06-01', utilization: 90, certifications: ['CBAP'], keyPerson: false },
            { id: 'KP006', name: 'David Kim', role: 'QA Lead', laborCat: 'QA III', status: 'Transition', startDate: '2024-06-15', utilization: 75, certifications: ['ISTQB'], keyPerson: false, note: 'Transitioning to new role Feb 2025' }
        ];

        const DEMO_SUBCONTRACTORS = [
            { 
                id: 'SUB001', 
                name: 'CyberShield Solutions', 
                role: 'Security Services',
                workShare: 15,
                invoiced: 485000,
                budget: 625000,
                performance: { quality: 94, schedule: 96, cost: 92 },
                status: 'On Track'
            },
            { 
                id: 'SUB002', 
                name: 'Federal Cloud Systems', 
                role: 'Cloud Infrastructure',
                workShare: 12,
                invoiced: 320000,
                budget: 500000,
                performance: { quality: 98, schedule: 100, cost: 95 },
                status: 'Exceeding'
            },
            { 
                id: 'SUB003', 
                name: 'HealthTech Dynamics', 
                role: 'EMR Integration',
                workShare: 8,
                invoiced: 195000,
                budget: 320000,
                performance: { quality: 78, schedule: 72, cost: 85 },
                status: 'At Risk'
            }
        ];

        const CPARS_CATEGORIES = [
            { id: 'quality', name: 'Quality of Product/Service', weight: 25, currentScore: 4, trend: 'stable', evidence: ['Zero critical defects', 'Client praised deliverable quality', '98% first-pass acceptance'] },
            { id: 'schedule', name: 'Schedule', weight: 20, currentScore: 4, trend: 'up', evidence: ['3 of 3 milestones on time', 'Proactive risk mitigation', 'Buffer maintained for Phase 2'] },
            { id: 'cost', name: 'Cost Control', weight: 20, currentScore: 5, trend: 'stable', evidence: ['8% under budget YTD', 'No unauthorized changes', 'Accurate monthly forecasting'] },
            { id: 'management', name: 'Management', weight: 15, currentScore: 4, trend: 'stable', evidence: ['Weekly status reports delivered', 'Issues escalated appropriately', 'Strong CO/COR relationship'] },
            { id: 'staffing', name: 'Staffing', weight: 10, currentScore: 4, trend: 'down', evidence: ['Key personnel retained', 'One transition in progress', 'Backfill plan approved'] },
            { id: 'regulatory', name: 'Regulatory Compliance', weight: 10, currentScore: 5, trend: 'stable', evidence: ['100% HIPAA compliant', 'All security audits passed', 'Documentation current'] }
        ];

        const CPARS_CHECKLIST = [
            { id: 'CHK001', item: 'Collect performance evidence monthly', status: 'Complete', dueDate: 'Monthly' },
            { id: 'CHK002', item: 'Document customer compliments/complaints', status: 'Complete', dueDate: 'Ongoing' },
            { id: 'CHK003', item: 'Update risk register', status: 'Complete', dueDate: 'Weekly' },
            { id: 'CHK004', item: 'Review subcontractor performance', status: 'In Progress', dueDate: '2025-01-31' },
            { id: 'CHK005', item: 'Prepare draft self-assessment', status: 'Not Started', dueDate: '2025-02-15' },
            { id: 'CHK006', item: 'Schedule COR mid-year review', status: 'Not Started', dueDate: '2025-02-28' },
            { id: 'CHK007', item: 'Compile deliverable acceptance records', status: 'In Progress', dueDate: '2025-01-31' },
            { id: 'CHK008', item: 'Document lessons learned', status: 'In Progress', dueDate: 'Ongoing' }
        ];

        // ============ RBAC CONFIGURATION ============
        const ROLES = {
            CEO: { label: 'CEO', access: 'executive', canEdit: false, viewFinancial: true, viewPersonnel: true, viewCPARS: true },
            COO: { label: 'COO', access: 'executive', canEdit: false, viewFinancial: true, viewPersonnel: true, viewCPARS: true },
            CAP: { label: 'Capture Lead', access: 'limited', canEdit: false, viewFinancial: false, viewPersonnel: false, viewCPARS: true },
            PM: { label: 'Program Manager', access: 'full', canEdit: true, viewFinancial: true, viewPersonnel: true, viewCPARS: true },
            SA: { label: 'Solution Architect', access: 'limited', canEdit: false, viewFinancial: false, viewPersonnel: false, viewCPARS: false },
            FIN: { label: 'Finance', access: 'limited', canEdit: true, viewFinancial: true, viewPersonnel: false, viewCPARS: false },
            CON: { label: 'Contracts', access: 'limited', canEdit: true, viewFinancial: true, viewPersonnel: false, viewCPARS: true },
            DEL: { label: 'Delivery Lead', access: 'full', canEdit: true, viewFinancial: true, viewPersonnel: true, viewCPARS: true },
            SME: { label: 'Subject Matter Expert', access: 'minimal', canEdit: false, viewFinancial: false, viewPersonnel: false, viewCPARS: false },
            WRITE: { label: 'Proposal Writer', access: 'minimal', canEdit: false, viewFinancial: false, viewPersonnel: false, viewCPARS: false },
            VIEW: { label: 'Viewer', access: 'minimal', canEdit: false, viewFinancial: false, viewPersonnel: false, viewCPARS: false }
        };

        // ============ UTILITY FUNCTIONS ============
        const formatCurrency = (amount) => {
            return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(amount);
        };

        const formatDate = (dateStr) => {
            if (!dateStr) return '‚Äî';
            return new Date(dateStr).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        };

        const getStatusBadge = (status) => {
            const styles = {
                'Completed': 'bg-success/20 text-success border-success/30',
                'In Progress': 'bg-pulse-cyan/20 text-pulse-cyan border-pulse-cyan/30',
                'Upcoming': 'bg-gray-500/20 text-gray-400 border-gray-500/30',
                'At Risk': 'bg-danger/20 text-danger border-danger/30',
                'Paid': 'bg-success/20 text-success border-success/30',
                'Processing': 'bg-warning/20 text-warning border-warning/30',
                'Submitted': 'bg-info/20 text-info border-info/30',
                'Active': 'bg-success/20 text-success border-success/30',
                'Transition': 'bg-warning/20 text-warning border-warning/30',
                'On Track': 'bg-success/20 text-success border-success/30',
                'Exceeding': 'bg-pulse-cyan/20 text-pulse-cyan border-pulse-cyan/30',
                'Complete': 'bg-success/20 text-success border-success/30',
                'Not Started': 'bg-gray-500/20 text-gray-400 border-gray-500/30'
            };
            return styles[status] || 'bg-gray-500/20 text-gray-400 border-gray-500/30';
        };

        const getCPARSColor = (score) => {
            if (score >= 5) return 'text-pulse-cyan';
            if (score >= 4) return 'text-success';
            if (score >= 3) return 'text-warning';
            return 'text-danger';
        };

        const getCPARSLabel = (score) => {
            if (score >= 5) return 'Exceptional';
            if (score >= 4) return 'Very Good';
            if (score >= 3) return 'Satisfactory';
            if (score >= 2) return 'Marginal';
            return 'Unsatisfactory';
        };

        // ============ COMPONENTS ============

        // Header Component
        const Header = ({ currentRole, setCurrentRole }) => (
            <header className="bg-navy-light border-b border-pulse-cyan/20 sticky top-0 z-50">
                <div className="max-w-7xl mx-auto px-4 py-3">
                    <div className="flex items-center justify-between">
                        <div className="flex items-center gap-4">
                            <div className="flex items-center gap-2">
                                <div className="w-10 h-10 rounded-lg bg-gradient-to-br from-pulse-cyan to-blue-500 flex items-center justify-center">
                                    <svg className="w-6 h-6 text-deep-navy" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                                    </svg>
                                </div>
                                <div>
                                    <h1 className="text-lg font-bold text-white">MissionPulse</h1>
                                    <p className="text-xs text-pulse-cyan">M14 Post-Award Dashboard</p>
                                </div>
                            </div>
                        </div>
                        
                        <div className="flex items-center gap-4">
                            <div className="flex items-center gap-2">
                                <span className="text-xs text-gray-400">Role:</span>
                                <select 
                                    value={currentRole}
                                    onChange={(e) => setCurrentRole(e.target.value)}
                                    className="bg-navy-mid border border-pulse-cyan/30 rounded-lg px-3 py-1.5 text-sm text-white focus:outline-none focus:border-pulse-cyan"
                                >
                                    {Object.entries(ROLES).map(([key, role]) => (
                                        <option key={key} value={key}>{role.label}</option>
                                    ))}
                                </select>
                            </div>
                            <div className={`px-3 py-1 rounded-full text-xs font-medium ${
                                ROLES[currentRole].access === 'full' ? 'bg-success/20 text-success' :
                                ROLES[currentRole].access === 'executive' ? 'bg-purple-500/20 text-purple-400' :
                                ROLES[currentRole].access === 'limited' ? 'bg-warning/20 text-warning' :
                                'bg-gray-500/20 text-gray-400'
                            }`}>
                                {ROLES[currentRole].access.toUpperCase()} ACCESS
                            </div>
                        </div>
                    </div>
                </div>
            </header>
        );

        // Contract Overview Card
        const ContractOverview = ({ contract }) => (
            <div className="glass-card rounded-xl p-6">
                <div className="flex items-start justify-between mb-4">
                    <div>
                        <h2 className="text-xl font-bold text-white">{contract.name}</h2>
                        <p className="text-sm text-gray-400">{contract.id} ‚Ä¢ {contract.type}</p>
                    </div>
                    <span className={`px-3 py-1 rounded-full text-xs font-medium border ${getStatusBadge(contract.status)}`}>
                        {contract.status}
                    </span>
                </div>
                
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                    <div>
                        <p className="text-xs text-gray-400">Agency</p>
                        <p className="text-sm text-white font-medium">{contract.agency}</p>
                    </div>
                    <div>
                        <p className="text-xs text-gray-400">Contract Value</p>
                        <p className="text-sm text-pulse-cyan font-bold">{formatCurrency(contract.value)}</p>
                    </div>
                    <div>
                        <p className="text-xs text-gray-400">Period of Performance</p>
                        <p className="text-sm text-white">{formatDate(contract.startDate)} - {formatDate(contract.endDate)}</p>
                    </div>
                    <div>
                        <p className="text-xs text-gray-400">Current Phase</p>
                        <p className="text-sm text-white">{contract.currentPhase}</p>
                    </div>
                </div>
                
                <div className="mb-2">
                    <div className="flex items-center justify-between text-xs mb-1">
                        <span className="text-gray-400">Overall Progress</span>
                        <span className="text-pulse-cyan font-medium">{contract.percentComplete}%</span>
                    </div>
                    <div className="h-2 bg-gray-700 rounded-full overflow-hidden">
                        <div 
                            className="h-full bg-gradient-to-r from-pulse-cyan to-blue-500 rounded-full transition-all duration-500"
                            style={{ width: `${contract.percentComplete}%` }}
                        />
                    </div>
                </div>
                
                <div className="grid grid-cols-2 gap-4 pt-4 border-t border-gray-700 mt-4">
                    <div>
                        <p className="text-xs text-gray-400">Contracting Officer</p>
                        <p className="text-sm text-white">{contract.coName}</p>
                        <p className="text-xs text-pulse-cyan">{contract.coEmail}</p>
                    </div>
                    <div>
                        <p className="text-xs text-gray-400">COR</p>
                        <p className="text-sm text-white">{contract.corName}</p>
                        <p className="text-xs text-pulse-cyan">{contract.corEmail}</p>
                    </div>
                </div>
            </div>
        );

        // Milestones Timeline
        const MilestonesTimeline = ({ milestones, canEdit }) => {
            const [expanded, setExpanded] = useState(null);
            
            return (
                <div className="glass-card rounded-xl p-6">
                    <div className="flex items-center justify-between mb-4">
                        <h3 className="text-lg font-semibold text-white flex items-center gap-2">
                            <span>üìÖ</span> Milestones & Deliverables
                        </h3>
                        {canEdit && (
                            <button className="px-3 py-1 bg-pulse-cyan/20 text-pulse-cyan rounded-lg text-xs hover:bg-pulse-cyan/30">
                                + Add Milestone
                            </button>
                        )}
                    </div>
                    
                    <div className="space-y-3 max-h-96 overflow-y-auto">
                        {milestones.map((milestone, idx) => (
                            <div 
                                key={milestone.id}
                                className={`p-4 rounded-lg border transition-all cursor-pointer ${
                                    milestone.status === 'Completed' ? 'bg-success/5 border-success/20' :
                                    milestone.status === 'In Progress' ? 'bg-pulse-cyan/5 border-pulse-cyan/20' :
                                    'bg-gray-800/50 border-gray-700'
                                }`}
                                onClick={() => setExpanded(expanded === milestone.id ? null : milestone.id)}
                            >
                                <div className="flex items-center gap-3">
                                    <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${
                                        milestone.status === 'Completed' ? 'bg-success text-white' :
                                        milestone.status === 'In Progress' ? 'bg-pulse-cyan text-deep-navy' :
                                        'bg-gray-700 text-gray-400'
                                    }`}>
                                        {milestone.status === 'Completed' ? '‚úì' : idx + 1}
                                    </div>
                                    
                                    <div className="flex-1">
                                        <div className="flex items-center justify-between">
                                            <h4 className="text-sm font-medium text-white">{milestone.name}</h4>
                                            <span className={`px-2 py-0.5 rounded text-xs border ${getStatusBadge(milestone.status)}`}>
                                                {milestone.status}
                                            </span>
                                        </div>
                                        <div className="flex items-center gap-4 mt-1 text-xs text-gray-400">
                                            <span>Due: {formatDate(milestone.dueDate)}</span>
                                            {milestone.actualDate && (
                                                <span className={milestone.actualDate > milestone.dueDate ? 'text-danger' : 'text-success'}>
                                                    Actual: {formatDate(milestone.actualDate)}
                                                </span>
                                            )}
                                        </div>
                                    </div>
                                </div>
                                
                                {expanded === milestone.id && (
                                    <div className="mt-3 pt-3 border-t border-gray-700">
                                        <p className="text-xs text-gray-400 mb-2">Deliverables:</p>
                                        <div className="flex flex-wrap gap-2">
                                            {milestone.deliverables.map((del, i) => (
                                                <span key={i} className="px-2 py-1 bg-navy-mid rounded text-xs text-gray-300">
                                                    üìÑ {del}
                                                </span>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // Invoice Tracker
        const InvoiceTracker = ({ invoices, canEdit, canView }) => {
            if (!canView) {
                return (
                    <div className="glass-card rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white flex items-center gap-2 mb-4">
                            <span>üí∞</span> Invoice Status
                        </h3>
                        <div className="text-center py-8 text-gray-400">
                            <span className="text-4xl mb-2 block">üîí</span>
                            <p>Financial data restricted for your role</p>
                        </div>
                    </div>
                );
            }
            
            const totalInvoiced = invoices.reduce((sum, inv) => sum + inv.amount, 0);
            const totalPaid = invoices.filter(inv => inv.status === 'Paid').reduce((sum, inv) => sum + inv.amount, 0);
            const pending = invoices.filter(inv => inv.status !== 'Paid').reduce((sum, inv) => sum + inv.amount, 0);
            
            return (
                <div className="glass-card rounded-xl p-6">
                    <div className="flex items-center justify-between mb-4">
                        <h3 className="text-lg font-semibold text-white flex items-center gap-2">
                            <span>üí∞</span> Invoice Status
                        </h3>
                        {canEdit && (
                            <button className="px-3 py-1 bg-pulse-cyan/20 text-pulse-cyan rounded-lg text-xs hover:bg-pulse-cyan/30">
                                + New Invoice
                            </button>
                        )}
                    </div>
                    
                    <div className="grid grid-cols-3 gap-3 mb-4">
                        <div className="p-3 bg-navy-mid rounded-lg">
                            <p className="text-xs text-gray-400">Total Invoiced</p>
                            <p className="text-lg font-bold text-white">{formatCurrency(totalInvoiced)}</p>
                        </div>
                        <div className="p-3 bg-navy-mid rounded-lg">
                            <p className="text-xs text-gray-400">Paid</p>
                            <p className="text-lg font-bold text-success">{formatCurrency(totalPaid)}</p>
                        </div>
                        <div className="p-3 bg-navy-mid rounded-lg">
                            <p className="text-xs text-gray-400">Pending</p>
                            <p className="text-lg font-bold text-warning">{formatCurrency(pending)}</p>
                        </div>
                    </div>
                    
                    <div className="space-y-2 max-h-64 overflow-y-auto">
                        {invoices.slice().reverse().map(invoice => (
                            <div key={invoice.id} className="flex items-center justify-between p-3 bg-navy-mid rounded-lg">
                                <div>
                                    <p className="text-sm text-white font-medium">{invoice.id}</p>
                                    <p className="text-xs text-gray-400">{invoice.period} ‚Ä¢ Submitted {formatDate(invoice.submitted)}</p>
                                </div>
                                <div className="text-right">
                                    <p className="text-sm text-white font-medium">{formatCurrency(invoice.amount)}</p>
                                    <span className={`px-2 py-0.5 rounded text-xs border ${getStatusBadge(invoice.status)}`}>
                                        {invoice.status}
                                    </span>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // CPARS Predictor
        const CPARSPredictor = ({ categories, checklist, canView }) => {
            if (!canView) {
                return (
                    <div className="glass-card rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white flex items-center gap-2 mb-4">
                            <span>‚≠ê</span> CPARS Prediction
                        </h3>
                        <div className="text-center py-8 text-gray-400">
                            <span className="text-4xl mb-2 block">üîí</span>
                            <p>CPARS data restricted for your role</p>
                        </div>
                    </div>
                );
            }
            
            const weightedScore = categories.reduce((sum, cat) => sum + (cat.currentScore * cat.weight), 0) / 100;
            const predictedRating = getCPARSLabel(weightedScore);
            
            const getTrendIcon = (trend) => {
                if (trend === 'up') return 'üìà';
                if (trend === 'down') return 'üìâ';
                return '‚û°Ô∏è';
            };
            
            const completedChecks = checklist.filter(c => c.status === 'Complete').length;
            
            return (
                <div className="glass-card rounded-xl p-6">
                    <h3 className="text-lg font-semibold text-white flex items-center gap-2 mb-4">
                        <span>‚≠ê</span> CPARS Prediction & Prep
                    </h3>
                    
                    {/* Overall Score */}
                    <div className="text-center mb-6 p-4 bg-navy-mid rounded-lg">
                        <p className="text-xs text-gray-400 mb-1">Predicted Rating</p>
                        <p className={`text-3xl font-bold ${getCPARSColor(weightedScore)}`}>
                            {weightedScore.toFixed(1)} / 5.0
                        </p>
                        <p className={`text-lg font-medium ${getCPARSColor(weightedScore)}`}>
                            {predictedRating}
                        </p>
                    </div>
                    
                    {/* Category Breakdown */}
                    <div className="space-y-3 mb-6">
                        {categories.map(cat => (
                            <div key={cat.id} className="p-3 bg-navy-mid rounded-lg">
                                <div className="flex items-center justify-between mb-2">
                                    <div className="flex items-center gap-2">
                                        <span className="text-sm text-white">{cat.name}</span>
                                        <span className="text-xs text-gray-500">({cat.weight}%)</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <span className="text-xs">{getTrendIcon(cat.trend)}</span>
                                        <span className={`text-sm font-bold ${getCPARSColor(cat.currentScore)}`}>
                                            {cat.currentScore}/5
                                        </span>
                                    </div>
                                </div>
                                <div className="h-1.5 bg-gray-700 rounded-full overflow-hidden">
                                    <div 
                                        className={`h-full rounded-full ${
                                            cat.currentScore >= 4 ? 'bg-success' :
                                            cat.currentScore >= 3 ? 'bg-warning' : 'bg-danger'
                                        }`}
                                        style={{ width: `${(cat.currentScore / 5) * 100}%` }}
                                    />
                                </div>
                            </div>
                        ))}
                    </div>
                    
                    {/* Prep Checklist */}
                    <div>
                        <div className="flex items-center justify-between mb-3">
                            <h4 className="text-sm font-medium text-white">Prep Checklist</h4>
                            <span className="text-xs text-gray-400">
                                {completedChecks}/{checklist.length} complete
                            </span>
                        </div>
                        <div className="space-y-2 max-h-48 overflow-y-auto">
                            {checklist.map(item => (
                                <div key={item.id} className="flex items-center gap-3 p-2 bg-navy-light rounded">
                                    <div className={`w-5 h-5 rounded-full flex items-center justify-center text-xs ${
                                        item.status === 'Complete' ? 'bg-success text-white' :
                                        item.status === 'In Progress' ? 'bg-warning text-white' :
                                        'bg-gray-700 text-gray-400'
                                    }`}>
                                        {item.status === 'Complete' ? '‚úì' : item.status === 'In Progress' ? '‚Ä¶' : '‚óã'}
                                    </div>
                                    <div className="flex-1">
                                        <p className="text-xs text-white">{item.item}</p>
                                        <p className="text-xs text-gray-500">Due: {item.dueDate}</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // Key Personnel Panel
        const KeyPersonnelPanel = ({ personnel, canView, canEdit }) => {
            if (!canView) {
                return (
                    <div className="glass-card rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white flex items-center gap-2 mb-4">
                            <span>üë•</span> Key Personnel
                        </h3>
                        <div className="text-center py-8 text-gray-400">
                            <span className="text-4xl mb-2 block">üîí</span>
                            <p>Personnel data restricted for your role</p>
                        </div>
                    </div>
                );
            }
            
            return (
                <div className="glass-card rounded-xl p-6">
                    <div className="flex items-center justify-between mb-4">
                        <h3 className="text-lg font-semibold text-white flex items-center gap-2">
                            <span>üë•</span> Key Personnel
                        </h3>
                        {canEdit && (
                            <button className="px-3 py-1 bg-pulse-cyan/20 text-pulse-cyan rounded-lg text-xs hover:bg-pulse-cyan/30">
                                + Add Personnel
                            </button>
                        )}
                    </div>
                    
                    <div className="space-y-3 max-h-96 overflow-y-auto">
                        {personnel.map(person => (
                            <div key={person.id} className="p-4 bg-navy-mid rounded-lg">
                                <div className="flex items-start justify-between">
                                    <div className="flex items-center gap-3">
                                        <div className={`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold ${
                                            person.keyPerson ? 'bg-pulse-cyan text-deep-navy' : 'bg-gray-700 text-gray-300'
                                        }`}>
                                            {person.name.split(' ').map(n => n[0]).join('')}
                                        </div>
                                        <div>
                                            <div className="flex items-center gap-2">
                                                <p className="text-sm font-medium text-white">{person.name}</p>
                                                {person.keyPerson && (
                                                    <span className="px-1.5 py-0.5 bg-pulse-cyan/20 text-pulse-cyan rounded text-xs">
                                                        Key
                                                    </span>
                                                )}
                                            </div>
                                            <p className="text-xs text-gray-400">{person.role} ‚Ä¢ {person.laborCat}</p>
                                        </div>
                                    </div>
                                    <span className={`px-2 py-0.5 rounded text-xs border ${getStatusBadge(person.status)}`}>
                                        {person.status}
                                    </span>
                                </div>
                                
                                <div className="mt-3 grid grid-cols-2 gap-3">
                                    <div>
                                        <p className="text-xs text-gray-500">Utilization</p>
                                        <div className="flex items-center gap-2">
                                            <div className="flex-1 h-1.5 bg-gray-700 rounded-full overflow-hidden">
                                                <div 
                                                    className={`h-full rounded-full ${
                                                        person.utilization >= 90 ? 'bg-success' :
                                                        person.utilization >= 75 ? 'bg-warning' : 'bg-danger'
                                                    }`}
                                                    style={{ width: `${person.utilization}%` }}
                                                />
                                            </div>
                                            <span className="text-xs text-gray-300">{person.utilization}%</span>
                                        </div>
                                    </div>
                                    <div>
                                        <p className="text-xs text-gray-500">Start Date</p>
                                        <p className="text-xs text-gray-300">{formatDate(person.startDate)}</p>
                                    </div>
                                </div>
                                
                                {person.certifications.length > 0 && (
                                    <div className="mt-2 flex flex-wrap gap-1">
                                        {person.certifications.map((cert, i) => (
                                            <span key={i} className="px-1.5 py-0.5 bg-gray-700 rounded text-xs text-gray-400">
                                                {cert}
                                            </span>
                                        ))}
                                    </div>
                                )}
                                
                                {person.note && (
                                    <div className="mt-2 p-2 bg-warning/10 border border-warning/30 rounded text-xs text-warning">
                                        ‚ö†Ô∏è {person.note}
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // Subcontractor Performance
        const SubcontractorPerformance = ({ subcontractors, canView }) => {
            if (!canView) {
                return (
                    <div className="glass-card rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white flex items-center gap-2 mb-4">
                            <span>üè¢</span> Subcontractor Performance
                        </h3>
                        <div className="text-center py-8 text-gray-400">
                            <span className="text-4xl mb-2 block">üîí</span>
                            <p>Subcontractor data restricted for your role</p>
                        </div>
                    </div>
                );
            }
            
            return (
                <div className="glass-card rounded-xl p-6">
                    <h3 className="text-lg font-semibold text-white flex items-center gap-2 mb-4">
                        <span>üè¢</span> Subcontractor Performance
                    </h3>
                    
                    <div className="space-y-4">
                        {subcontractors.map(sub => {
                            const avgPerf = Math.round((sub.performance.quality + sub.performance.schedule + sub.performance.cost) / 3);
                            const burnRate = Math.round((sub.invoiced / sub.budget) * 100);
                            
                            return (
                                <div key={sub.id} className={`p-4 rounded-lg border ${
                                    sub.status === 'At Risk' ? 'bg-danger/5 border-danger/30' :
                                    sub.status === 'Exceeding' ? 'bg-pulse-cyan/5 border-pulse-cyan/30' :
                                    'bg-navy-mid border-gray-700'
                                }`}>
                                    <div className="flex items-start justify-between mb-3">
                                        <div>
                                            <h4 className="text-sm font-medium text-white">{sub.name}</h4>
                                            <p className="text-xs text-gray-400">{sub.role} ‚Ä¢ {sub.workShare}% work share</p>
                                        </div>
                                        <span className={`px-2 py-0.5 rounded text-xs border ${getStatusBadge(sub.status)}`}>
                                            {sub.status}
                                        </span>
                                    </div>
                                    
                                    <div className="grid grid-cols-3 gap-2 mb-3">
                                        <div className="text-center p-2 bg-gray-800/50 rounded">
                                            <p className="text-xs text-gray-500">Quality</p>
                                            <p className={`text-sm font-bold ${sub.performance.quality >= 90 ? 'text-success' : sub.performance.quality >= 75 ? 'text-warning' : 'text-danger'}`}>
                                                {sub.performance.quality}%
                                            </p>
                                        </div>
                                        <div className="text-center p-2 bg-gray-800/50 rounded">
                                            <p className="text-xs text-gray-500">Schedule</p>
                                            <p className={`text-sm font-bold ${sub.performance.schedule >= 90 ? 'text-success' : sub.performance.schedule >= 75 ? 'text-warning' : 'text-danger'}`}>
                                                {sub.performance.schedule}%
                                            </p>
                                        </div>
                                        <div className="text-center p-2 bg-gray-800/50 rounded">
                                            <p className="text-xs text-gray-500">Cost</p>
                                            <p className={`text-sm font-bold ${sub.performance.cost >= 90 ? 'text-success' : sub.performance.cost >= 75 ? 'text-warning' : 'text-danger'}`}>
                                                {sub.performance.cost}%
                                            </p>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <div className="flex items-center justify-between text-xs mb-1">
                                            <span className="text-gray-400">Budget Burn: {formatCurrency(sub.invoiced)} / {formatCurrency(sub.budget)}</span>
                                            <span className="text-gray-300">{burnRate}%</span>
                                        </div>
                                        <div className="h-1.5 bg-gray-700 rounded-full overflow-hidden">
                                            <div 
                                                className={`h-full rounded-full ${burnRate > 90 ? 'bg-danger' : burnRate > 75 ? 'bg-warning' : 'bg-success'}`}
                                                style={{ width: `${Math.min(burnRate, 100)}%` }}
                                            />
                                        </div>
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                </div>
            );
        };

        // Main App Component
        const PostAwardDashboard = () => {
            const [currentRole, setCurrentRole] = useState('PM');
            const [activeTab, setActiveTab] = useState('overview');
            
            const roleConfig = ROLES[currentRole];
            
            const tabs = [
                { id: 'overview', label: 'Overview', icon: 'üìä' },
                { id: 'milestones', label: 'Milestones', icon: 'üìÖ' },
                { id: 'financial', label: 'Financial', icon: 'üí∞', restricted: !roleConfig.viewFinancial },
                { id: 'personnel', label: 'Personnel', icon: 'üë•', restricted: !roleConfig.viewPersonnel },
                { id: 'cpars', label: 'CPARS', icon: '‚≠ê', restricted: !roleConfig.viewCPARS }
            ];
            
            return (
                <div className="min-h-screen bg-deep-navy">
                    <Header currentRole={currentRole} setCurrentRole={setCurrentRole} />
                    
                    <main className="max-w-7xl mx-auto px-4 py-6 space-y-6">
                        {/* Page Title */}
                        <div>
                            <h1 className="text-2xl font-bold text-white flex items-center gap-3">
                                üèÜ Post-Award Dashboard
                            </h1>
                            <p className="text-sm text-gray-400 mt-1">
                                Contract Execution, Deliverables & CPARS Management
                            </p>
                        </div>
                        
                        {/* Contract Overview */}
                        <ContractOverview contract={DEMO_CONTRACT} />
                        
                        {/* Tab Navigation */}
                        <div className="flex items-center gap-1 border-b border-gray-700">
                            {tabs.map(tab => (
                                <button
                                    key={tab.id}
                                    onClick={() => !tab.restricted && setActiveTab(tab.id)}
                                    className={`px-4 py-3 text-sm font-medium transition-colors ${
                                        activeTab === tab.id ? 'tab-active' : 
                                        tab.restricted ? 'text-gray-600 cursor-not-allowed' : 
                                        'text-gray-400 hover:text-white'
                                    }`}
                                    disabled={tab.restricted}
                                >
                                    <span className="mr-2">{tab.icon}</span>
                                    {tab.label}
                                    {tab.restricted && <span className="ml-1">üîí</span>}
                                </button>
                            ))}
                        </div>
                        
                        {/* Tab Content */}
                        {activeTab === 'overview' && (
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <MilestonesTimeline milestones={DEMO_MILESTONES} canEdit={roleConfig.canEdit} />
                                <div className="space-y-6">
                                    <InvoiceTracker invoices={DEMO_INVOICES} canEdit={roleConfig.canEdit} canView={roleConfig.viewFinancial} />
                                    <SubcontractorPerformance subcontractors={DEMO_SUBCONTRACTORS} canView={roleConfig.viewFinancial} />
                                </div>
                            </div>
                        )}
                        
                        {activeTab === 'milestones' && (
                            <MilestonesTimeline milestones={DEMO_MILESTONES} canEdit={roleConfig.canEdit} />
                        )}
                        
                        {activeTab === 'financial' && (
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <InvoiceTracker invoices={DEMO_INVOICES} canEdit={roleConfig.canEdit} canView={roleConfig.viewFinancial} />
                                <SubcontractorPerformance subcontractors={DEMO_SUBCONTRACTORS} canView={roleConfig.viewFinancial} />
                            </div>
                        )}
                        
                        {activeTab === 'personnel' && (
                            <KeyPersonnelPanel personnel={DEMO_KEY_PERSONNEL} canView={roleConfig.viewPersonnel} canEdit={roleConfig.canEdit} />
                        )}
                        
                        {activeTab === 'cpars' && (
                            <CPARSPredictor categories={CPARS_CATEGORIES} checklist={CPARS_CHECKLIST} canView={roleConfig.viewCPARS} />
                        )}
                        
                        {/* Access Notice */}
                        {roleConfig.access !== 'full' && roleConfig.access !== 'executive' && (
                            <div className="glass-card rounded-xl p-4 border-warning/30">
                                <div className="flex items-center gap-3">
                                    <span className="text-xl">üîí</span>
                                    <div>
                                        <p className="text-sm text-warning font-medium">Limited Access Mode</p>
                                        <p className="text-xs text-gray-400">
                                            Your role ({roleConfig.label}) has restricted access. 
                                            {!roleConfig.viewFinancial && ' Financial data hidden.'}
                                            {!roleConfig.viewPersonnel && ' Personnel data hidden.'}
                                            {!roleConfig.viewCPARS && ' CPARS data hidden.'}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>
                    
                    {/* Footer */}
                    <footer className="border-t border-pulse-cyan/10 mt-12">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <div className="flex items-center justify-between text-xs text-gray-500">
                                <div className="flex items-center gap-4">
                                    <span>MissionPulse v12 ‚Ä¢ M14 Post-Award Dashboard</span>
                                    <span>‚Ä¢</span>
                                    <span>Shield & Pulse UX v8.0</span>
                                </div>
                                <div className="px-3 py-1 bg-warning/10 border border-warning/30 rounded text-warning">
                                    AI GENERATED - REQUIRES HUMAN REVIEW
                                </div>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        // Render
        ReactDOM.createRoot(document.getElementById('root')).render(<PostAwardDashboard />);
    </script>
</body>
</html>
