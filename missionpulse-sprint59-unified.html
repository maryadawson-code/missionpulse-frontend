<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#00050F">
  <meta name="description" content="MissionPulse - AI-Powered Federal Proposal Management">
  <title>MissionPulse v12.0 - Complete Platform</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', sans-serif; background: #00050F; min-height: 100vh; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .animate-pulse { animation: pulse 2s ease-in-out infinite; }
    .animate-spin { animation: spin 1s linear infinite; }
    .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
    .animate-slideIn { animation: slideIn 0.3s ease-out; }
    .animate-slideUp { animation: slideUp 0.3s ease-out; }
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: #1e293b; }
    ::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #64748b; }
    
    /* Sidebar transitions */
    .sidebar-item { transition: all 0.2s ease; }
    .sidebar-item:hover { background: rgba(0, 229, 250, 0.1); }
    .sidebar-item.active { background: rgba(0, 229, 250, 0.15); border-right: 3px solid #00E5FA; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, useCallback, createContext, useContext, useRef } = React;

    // ============================================
    // SUPABASE CLIENT
    // ============================================
    const SUPABASE_URL = 'https://qdrtpnpnhkxvfmvfziop.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc1NjcyNjUsImV4cCI6MjA1MzE0MzI2NX0.gVAHNpfDJjQdXy1E9AAKX_xJDJX8cKbKcsM6v0';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // ============================================
    // API METHODS
    // ============================================
    const API = {
      async getOpportunities() {
        const { data, error } = await supabase.from('opportunities').select('*').order('created_at', { ascending: false });
        return error ? [] : data;
      },
      async getOpportunity(id) {
        const { data, error } = await supabase.from('opportunities').select('*').eq('id', id).single();
        return error ? null : data;
      },
      async getCompetitors(oppId) {
        let query = supabase.from('competitors').select('*');
        if (oppId) query = query.eq('opportunity_id', oppId);
        const { data, error } = await query;
        return error ? [] : data;
      },
      async getPricingItems(oppId) {
        let query = supabase.from('pricing_items').select('*');
        if (oppId) query = query.eq('opportunity_id', oppId);
        const { data, error } = await query;
        return error ? [] : data;
      },
      async getComplianceItems(oppId) {
        let query = supabase.from('compliance_items').select('*');
        if (oppId) query = query.eq('opportunity_id', oppId);
        const { data, error } = await query;
        return error ? [] : data;
      },
      async getTeamAssignments(oppId) {
        let query = supabase.from('team_assignments').select('*');
        if (oppId) query = query.eq('opportunity_id', oppId);
        const { data, error } = await query;
        return error ? [] : data;
      },
      async getAuditLogs(limit = 50) {
        const { data, error } = await supabase.from('audit_logs').select('*').order('created_at', { ascending: false }).limit(limit);
        return error ? [] : data;
      },
      async logAudit(action, details, module = 'system') {
        await supabase.from('audit_logs').insert({ action, details, module });
      }
    };

    // ============================================
    // ICONS
    // ============================================
    const Icons = {
      shield: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>,
      home: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>,
      target: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" strokeWidth={2}/><circle cx="12" cy="12" r="6" strokeWidth={2}/><circle cx="12" cy="12" r="2" strokeWidth={2}/></svg>,
      cpu: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" /></svg>,
      fileText: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>,
      users: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" /></svg>,
      eye: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>,
      calculator: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>,
      clipboard: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" /></svg>,
      shieldCheck: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>,
      presentation: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" /></svg>,
      rocket: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>,
      settings: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>,
      bell: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" /></svg>,
      menu: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" /></svg>,
      x: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>,
      chevronRight: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" /></svg>,
      chevronDown: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" /></svg>,
      loader: () => <svg className="w-full h-full animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>,
      check: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>,
      search: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>,
      plus: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" /></svg>,
      dollarSign: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
      trendingUp: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg>,
      alertTriangle: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>,
      clock: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" strokeWidth={2}/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6l4 2" /></svg>,
      download: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>,
      send: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg>,
      user: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>,
      logout: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>,
      zap: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>,
      database: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><ellipse cx="12" cy="5" rx="9" ry="3" strokeWidth={2}/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" /></svg>,
      activity: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M22 12h-4l-3 9L9 3l-3 9H2" /></svg>,
    };

    const Icon = ({ name, className = "w-5 h-5" }) => {
      const IconComponent = Icons[name];
      return IconComponent ? <span className={`inline-block ${className}`}><IconComponent /></span> : null;
    };

    // ============================================
    // UI COMPONENTS
    // ============================================
    const Card = ({ children, className = '', onClick, glow = false }) => (
      <div 
        onClick={onClick}
        className={`bg-slate-800/50 backdrop-blur border border-slate-700/50 rounded-xl ${onClick ? 'cursor-pointer hover:border-cyan-500/30 transition-all' : ''} ${glow ? 'shadow-lg shadow-cyan-500/10 border-cyan-500/30' : ''} ${className}`}
      >
        {children}
      </div>
    );

    const Button = ({ children, onClick, variant = 'primary', size = 'md', icon, disabled, loading, className = '', fullWidth = false }) => {
      const variants = {
        primary: 'bg-gradient-to-r from-cyan-500 to-teal-500 text-white hover:from-cyan-400 hover:to-teal-400',
        secondary: 'bg-slate-700 text-white hover:bg-slate-600 border border-slate-600',
        ghost: 'text-slate-400 hover:text-white hover:bg-slate-700/50',
        danger: 'bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/50',
        success: 'bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30 border border-emerald-500/50',
      };
      const sizes = { xs: 'px-2 py-1 text-xs', sm: 'px-3 py-1.5 text-sm', md: 'px-4 py-2 text-sm', lg: 'px-6 py-3 text-base' };
      return (
        <button 
          onClick={onClick} 
          disabled={disabled || loading}
          className={`inline-flex items-center justify-center gap-2 font-medium rounded-lg transition-all ${variants[variant]} ${sizes[size]} ${disabled || loading ? 'opacity-50 cursor-not-allowed' : ''} ${fullWidth ? 'w-full' : ''} ${className}`}
        >
          {loading ? <Icon name="loader" className="w-4 h-4" /> : icon && <Icon name={icon} className="w-4 h-4" />}
          {children}
        </button>
      );
    };

    const Badge = ({ children, variant = 'default', size = 'sm', icon }) => {
      const variants = {
        default: 'bg-slate-700 text-slate-300',
        primary: 'bg-cyan-500/20 text-cyan-400 border border-cyan-500/30',
        success: 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30',
        warning: 'bg-amber-500/20 text-amber-400 border border-amber-500/30',
        danger: 'bg-red-500/20 text-red-400 border border-red-500/30',
      };
      const sizes = { xs: 'px-1.5 py-0.5 text-xs', sm: 'px-2 py-1 text-xs', md: 'px-3 py-1.5 text-sm' };
      return (
        <span className={`inline-flex items-center gap-1 rounded-full font-medium ${variants[variant]} ${sizes[size]}`}>
          {icon && <Icon name={icon} className="w-3 h-3" />}
          {children}
        </span>
      );
    };

    // Toast System
    const ToastContext = createContext();
    const ToastProvider = ({ children }) => {
      const [toasts, setToasts] = useState([]);
      const addToast = useCallback((message, type = 'info') => {
        const id = Date.now();
        setToasts(prev => [...prev, { id, message, type }]);
        setTimeout(() => setToasts(prev => prev.filter(t => t.id !== id)), 4000);
      }, []);
      return (
        <ToastContext.Provider value={{ addToast }}>
          {children}
          <div className="fixed bottom-4 right-4 z-50 space-y-2">
            {toasts.map(toast => (
              <div key={toast.id} className={`px-4 py-3 rounded-lg shadow-lg border backdrop-blur animate-slideUp ${
                toast.type === 'success' ? 'bg-emerald-500/20 border-emerald-500/50 text-emerald-400' :
                toast.type === 'error' ? 'bg-red-500/20 border-red-500/50 text-red-400' :
                'bg-cyan-500/20 border-cyan-500/50 text-cyan-400'
              }`}>
                {toast.message}
              </div>
            ))}
          </div>
        </ToastContext.Provider>
      );
    };
    const useToast = () => useContext(ToastContext);

    // ============================================
    // NAVIGATION CONFIG
    // ============================================
    const NAV_ITEMS = [
      { id: 'dashboard', label: 'Dashboard', icon: 'home', section: 'main' },
      { id: 'pipeline', label: 'Pipeline', icon: 'target', section: 'main' },
      { id: 'warroom', label: 'War Room', icon: 'activity', section: 'main' },
      { id: 'divider1', type: 'divider', label: 'Intelligence' },
      { id: 'agents', label: 'AI Agents', icon: 'cpu', section: 'intel', badge: '8' },
      { id: 'blackhat', label: 'Black Hat', icon: 'eye', section: 'intel' },
      { id: 'frenemy', label: 'Frenemy Intel', icon: 'users', section: 'intel' },
      { id: 'divider2', type: 'divider', label: 'Proposal' },
      { id: 'compliance', label: 'Compliance', icon: 'clipboard', section: 'proposal' },
      { id: 'pricing', label: 'Pricing', icon: 'calculator', section: 'proposal' },
      { id: 'irondome', label: 'Iron Dome', icon: 'shieldCheck', section: 'proposal' },
      { id: 'orals', label: 'Orals Studio', icon: 'presentation', section: 'proposal' },
      { id: 'divider3', type: 'divider', label: 'Tools' },
      { id: 'reports', label: 'Reports', icon: 'fileText', section: 'tools' },
      { id: 'launch', label: 'Launch Pad', icon: 'rocket', section: 'tools' },
      { id: 'audit', label: 'Audit Log', icon: 'database', section: 'tools' },
    ];

    // ============================================
    // SIDEBAR COMPONENT
    // ============================================
    const Sidebar = ({ currentPage, setCurrentPage, collapsed, setCollapsed }) => {
      return (
        <aside className={`fixed left-0 top-0 h-full bg-slate-900/95 backdrop-blur border-r border-slate-800 z-40 transition-all duration-300 ${collapsed ? 'w-16' : 'w-64'}`}>
          {/* Logo */}
          <div className="h-16 flex items-center justify-between px-4 border-b border-slate-800">
            <div className="flex items-center gap-3">
              <div className="w-9 h-9 rounded-lg bg-gradient-to-br from-cyan-500 to-teal-500 flex items-center justify-center flex-shrink-0">
                <Icon name="shield" className="w-5 h-5 text-white" />
              </div>
              {!collapsed && <span className="font-bold text-white">MissionPulse</span>}
            </div>
            <button 
              onClick={() => setCollapsed(!collapsed)}
              className="p-1.5 rounded-lg hover:bg-slate-800 text-slate-400 hover:text-white transition-colors"
            >
              <Icon name={collapsed ? 'chevronRight' : 'x'} className="w-4 h-4" />
            </button>
          </div>

          {/* Navigation */}
          <nav className="p-2 space-y-1 overflow-y-auto h-[calc(100%-8rem)]">
            {NAV_ITEMS.map((item) => {
              if (item.type === 'divider') {
                return collapsed ? (
                  <div key={item.id} className="my-2 border-t border-slate-800" />
                ) : (
                  <div key={item.id} className="pt-4 pb-2 px-3">
                    <span className="text-xs font-medium text-slate-500 uppercase tracking-wider">{item.label}</span>
                  </div>
                );
              }

              const isActive = currentPage === item.id;
              return (
                <button
                  key={item.id}
                  onClick={() => setCurrentPage(item.id)}
                  className={`sidebar-item w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left ${
                    isActive ? 'active text-cyan-400' : 'text-slate-400 hover:text-white'
                  }`}
                  title={collapsed ? item.label : undefined}
                >
                  <Icon name={item.icon} className="w-5 h-5 flex-shrink-0" />
                  {!collapsed && (
                    <>
                      <span className="flex-1 font-medium">{item.label}</span>
                      {item.badge && <Badge variant="primary" size="xs">{item.badge}</Badge>}
                    </>
                  )}
                </button>
              );
            })}
          </nav>

          {/* User Section */}
          <div className="absolute bottom-0 left-0 right-0 p-3 border-t border-slate-800">
            <button 
              onClick={() => setCurrentPage('settings')}
              className={`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 transition-colors ${currentPage === 'settings' ? 'bg-slate-800 text-white' : ''}`}
            >
              <div className="w-8 h-8 rounded-full bg-gradient-to-br from-cyan-500 to-teal-500 flex items-center justify-center flex-shrink-0">
                <Icon name="user" className="w-4 h-4 text-white" />
              </div>
              {!collapsed && (
                <div className="flex-1 text-left">
                  <p className="text-sm font-medium text-white">Mary Womack</p>
                  <p className="text-xs text-slate-500">Administrator</p>
                </div>
              )}
            </button>
          </div>
        </aside>
      );
    };

    // ============================================
    // HEADER COMPONENT
    // ============================================
    const Header = ({ title, subtitle, sidebarCollapsed }) => {
      const { addToast } = useToast();
      const [searchOpen, setSearchOpen] = useState(false);

      return (
        <header className={`fixed top-0 right-0 h-16 bg-slate-900/80 backdrop-blur border-b border-slate-800 z-30 transition-all duration-300 ${sidebarCollapsed ? 'left-16' : 'left-64'}`}>
          <div className="h-full flex items-center justify-between px-6">
            <div>
              <h1 className="text-lg font-bold text-white">{title}</h1>
              {subtitle && <p className="text-sm text-slate-400">{subtitle}</p>}
            </div>

            <div className="flex items-center gap-3">
              {/* Search */}
              <div className="relative">
                <button 
                  onClick={() => setSearchOpen(!searchOpen)}
                  className="p-2 rounded-lg hover:bg-slate-800 text-slate-400 hover:text-white transition-colors"
                >
                  <Icon name="search" className="w-5 h-5" />
                </button>
                {searchOpen && (
                  <div className="absolute right-0 top-12 w-80 bg-slate-800 border border-slate-700 rounded-xl shadow-xl p-2 animate-fadeIn">
                    <input 
                      type="text"
                      placeholder="Search opportunities, agents..."
                      className="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white placeholder-slate-500 focus:outline-none focus:border-cyan-500"
                      autoFocus
                    />
                  </div>
                )}
              </div>

              {/* Notifications */}
              <button 
                onClick={() => addToast('No new notifications', 'info')}
                className="relative p-2 rounded-lg hover:bg-slate-800 text-slate-400 hover:text-white transition-colors"
              >
                <Icon name="bell" className="w-5 h-5" />
                <span className="absolute top-1 right-1 w-2 h-2 bg-cyan-500 rounded-full"></span>
              </button>

              {/* Quick Add */}
              <Button size="sm" icon="plus">
                New
              </Button>
            </div>
          </div>
        </header>
      );
    };

    // ============================================
    // PAGE COMPONENTS
    // ============================================

    // Dashboard Page
    const DashboardPage = () => {
      const { addToast } = useToast();
      const [loading, setLoading] = useState(true);
      const [opportunities, setOpportunities] = useState([]);

      useEffect(() => {
        const load = async () => {
          const opps = await API.getOpportunities();
          setOpportunities(opps);
          setLoading(false);
        };
        load();
      }, []);

      const totalPipeline = opportunities.reduce((sum, o) => sum + (o.value || 0), 0);
      const activeOpps = opportunities.filter(o => !['won', 'lost'].includes(o.status?.toLowerCase())).length;
      const avgPwin = opportunities.length > 0 ? Math.round(opportunities.reduce((sum, o) => sum + (o.pwin || o.win_probability || 0), 0) / opportunities.length) : 0;

      const formatCurrency = (value) => {
        if (value >= 1000000) return `$${(value / 1000000).toFixed(1)}M`;
        if (value >= 1000) return `$${(value / 1000).toFixed(0)}K`;
        return `$${value?.toLocaleString() || 0}`;
      };

      if (loading) {
        return (
          <div className="flex items-center justify-center h-64">
            <Icon name="loader" className="w-8 h-8 text-cyan-400" />
          </div>
        );
      }

      return (
        <div className="space-y-6 animate-fadeIn">
          {/* Stats Grid */}
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <Card className="p-5" glow>
              <div className="flex items-center justify-between">
                <div>
                  <p className="text-slate-400 text-sm">Total Pipeline</p>
                  <p className="text-2xl font-bold text-white mt-1">{formatCurrency(totalPipeline)}</p>
                </div>
                <div className="w-12 h-12 rounded-xl bg-cyan-500/20 flex items-center justify-center">
                  <Icon name="dollarSign" className="w-6 h-6 text-cyan-400" />
                </div>
              </div>
              <p className="text-xs text-emerald-400 mt-2 flex items-center gap-1">
                <Icon name="trendingUp" className="w-3 h-3" /> +12% from last month
              </p>
            </Card>

            <Card className="p-5">
              <div className="flex items-center justify-between">
                <div>
                  <p className="text-slate-400 text-sm">Active Opportunities</p>
                  <p className="text-2xl font-bold text-white mt-1">{activeOpps}</p>
                </div>
                <div className="w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center">
                  <Icon name="target" className="w-6 h-6 text-purple-400" />
                </div>
              </div>
              <p className="text-xs text-slate-500 mt-2">{opportunities.length} total tracked</p>
            </Card>

            <Card className="p-5">
              <div className="flex items-center justify-between">
                <div>
                  <p className="text-slate-400 text-sm">Average pWin</p>
                  <p className="text-2xl font-bold text-white mt-1">{avgPwin}%</p>
                </div>
                <div className="w-12 h-12 rounded-xl bg-emerald-500/20 flex items-center justify-center">
                  <Icon name="trendingUp" className="w-6 h-6 text-emerald-400" />
                </div>
              </div>
              <div className="mt-2 w-full h-2 bg-slate-700 rounded-full overflow-hidden">
                <div className="h-full bg-gradient-to-r from-cyan-500 to-teal-500 rounded-full" style={{ width: `${avgPwin}%` }} />
              </div>
            </Card>

            <Card className="p-5">
              <div className="flex items-center justify-between">
                <div>
                  <p className="text-slate-400 text-sm">Due This Week</p>
                  <p className="text-2xl font-bold text-white mt-1">
                    {opportunities.filter(o => {
                      const due = new Date(o.due_date);
                      const now = new Date();
                      const diff = (due - now) / (1000 * 60 * 60 * 24);
                      return diff > 0 && diff <= 7;
                    }).length}
                  </p>
                </div>
                <div className="w-12 h-12 rounded-xl bg-amber-500/20 flex items-center justify-center">
                  <Icon name="clock" className="w-6 h-6 text-amber-400" />
                </div>
              </div>
              <p className="text-xs text-amber-400 mt-2 flex items-center gap-1">
                <Icon name="alertTriangle" className="w-3 h-3" /> Action required
              </p>
            </Card>
          </div>

          {/* Recent Opportunities */}
          <Card className="p-6">
            <div className="flex items-center justify-between mb-4">
              <h2 className="text-lg font-semibold text-white">Recent Opportunities</h2>
              <Button variant="ghost" size="sm">View All</Button>
            </div>
            <div className="space-y-3">
              {opportunities.slice(0, 5).map((opp, i) => (
                <div key={opp.id || i} className="flex items-center justify-between p-3 rounded-lg bg-slate-900/50 hover:bg-slate-800/50 transition-colors">
                  <div className="flex-1 min-w-0">
                    <p className="text-white font-medium truncate">{opp.title || opp.name}</p>
                    <p className="text-slate-400 text-sm">{opp.agency}</p>
                  </div>
                  <div className="flex items-center gap-4">
                    <Badge variant={opp.status === 'won' ? 'success' : opp.status === 'lost' ? 'danger' : 'primary'} size="sm">
                      {opp.status}
                    </Badge>
                    <span className="text-cyan-400 font-semibold">{formatCurrency(opp.value)}</span>
                    <span className="text-white font-medium w-12 text-right">{opp.pwin || 0}%</span>
                  </div>
                </div>
              ))}
              {opportunities.length === 0 && (
                <div className="text-center py-8 text-slate-500">
                  No opportunities found. Add your first opportunity to get started.
                </div>
              )}
            </div>
          </Card>

          {/* Quick Actions */}
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
            {[
              { label: 'AI Capture Agent', icon: 'cpu', color: 'cyan' },
              { label: 'Generate Report', icon: 'fileText', color: 'purple' },
              { label: 'Black Hat Review', icon: 'eye', color: 'red' },
              { label: 'Pricing Analysis', icon: 'calculator', color: 'emerald' },
            ].map((action, i) => (
              <Card key={i} className="p-4 cursor-pointer hover:border-cyan-500/30 transition-all" onClick={() => addToast(`${action.label} coming soon`, 'info')}>
                <div className={`w-10 h-10 rounded-lg bg-${action.color}-500/20 flex items-center justify-center mb-3`}>
                  <Icon name={action.icon} className={`w-5 h-5 text-${action.color}-400`} />
                </div>
                <p className="text-white font-medium">{action.label}</p>
              </Card>
            ))}
          </div>
        </div>
      );
    };

    // Pipeline Page
    const PipelinePage = () => {
      const [opportunities, setOpportunities] = useState([]);
      const [loading, setLoading] = useState(true);
      const [filter, setFilter] = useState('all');

      useEffect(() => {
        const load = async () => {
          const opps = await API.getOpportunities();
          setOpportunities(opps);
          setLoading(false);
        };
        load();
      }, []);

      const filteredOpps = filter === 'all' ? opportunities : opportunities.filter(o => o.status?.toLowerCase() === filter);

      const formatCurrency = (value) => {
        if (value >= 1000000) return `$${(value / 1000000).toFixed(1)}M`;
        if (value >= 1000) return `$${(value / 1000).toFixed(0)}K`;
        return `$${value?.toLocaleString() || 0}`;
      };

      const stages = ['all', 'identification', 'qualification', 'capture', 'proposal', 'submitted', 'won', 'lost'];

      if (loading) {
        return <div className="flex items-center justify-center h-64"><Icon name="loader" className="w-8 h-8 text-cyan-400" /></div>;
      }

      return (
        <div className="space-y-6 animate-fadeIn">
          {/* Filters */}
          <div className="flex items-center gap-2 overflow-x-auto pb-2">
            {stages.map(stage => (
              <button
                key={stage}
                onClick={() => setFilter(stage)}
                className={`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-colors ${
                  filter === stage ? 'bg-cyan-500/20 text-cyan-400 border border-cyan-500/30' : 'bg-slate-800 text-slate-400 hover:text-white'
                }`}
              >
                {stage === 'all' ? 'All' : stage.charAt(0).toUpperCase() + stage.slice(1)}
                {stage !== 'all' && (
                  <span className="ml-2 text-xs opacity-70">
                    ({opportunities.filter(o => o.status?.toLowerCase() === stage).length})
                  </span>
                )}
              </button>
            ))}
          </div>

          {/* Opportunities List */}
          <div className="space-y-3">
            {filteredOpps.map((opp, i) => (
              <Card key={opp.id || i} className="p-5 hover:border-cyan-500/30 cursor-pointer transition-all">
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <div className="flex items-center gap-3 mb-2">
                      <h3 className="text-lg font-semibold text-white">{opp.title || opp.name}</h3>
                      <Badge variant={opp.status === 'won' ? 'success' : opp.status === 'lost' ? 'danger' : 'primary'}>
                        {opp.status}
                      </Badge>
                    </div>
                    <p className="text-slate-400 text-sm mb-3">{opp.agency} • {opp.contract_type || 'IDIQ'}</p>
                    <div className="flex items-center gap-6 text-sm">
                      <span className="text-slate-400">Value: <span className="text-cyan-400 font-semibold">{formatCurrency(opp.value)}</span></span>
                      <span className="text-slate-400">pWin: <span className="text-white font-semibold">{opp.pwin || 0}%</span></span>
                      <span className="text-slate-400">Due: <span className="text-white">{opp.due_date ? new Date(opp.due_date).toLocaleDateString() : 'TBD'}</span></span>
                    </div>
                  </div>
                  <div className="flex items-center gap-2">
                    <Button variant="ghost" size="sm" icon="eye">View</Button>
                    <Button variant="secondary" size="sm" icon="cpu">Analyze</Button>
                  </div>
                </div>
              </Card>
            ))}
            {filteredOpps.length === 0 && (
              <div className="text-center py-12 text-slate-500">
                No opportunities found for this filter.
              </div>
            )}
          </div>
        </div>
      );
    };

    // AI Agents Page
    const AgentsPage = () => {
      const { addToast } = useToast();
      const [selectedAgent, setSelectedAgent] = useState(null);
      const [messages, setMessages] = useState([]);
      const [input, setInput] = useState('');
      const [loading, setLoading] = useState(false);

      const agents = [
        { id: 'capture', name: 'Capture Agent', icon: 'target', color: '#00E5FA', desc: 'Win strategy and opportunity analysis' },
        { id: 'strategy', name: 'Strategy Agent', icon: 'zap', color: '#8B5CF6', desc: 'Technical approach and solutioning' },
        { id: 'blackhat', name: 'Black Hat Agent', icon: 'eye', color: '#EF4444', desc: 'Competitive intelligence' },
        { id: 'pricing', name: 'Pricing Agent', icon: 'calculator', color: '#10B981', desc: 'Cost analysis and pricing' },
        { id: 'compliance', name: 'Compliance Agent', icon: 'shieldCheck', color: '#F59E0B', desc: 'RFP requirements analysis' },
        { id: 'writer', name: 'Writer Agent', icon: 'fileText', color: '#EC4899', desc: 'Proposal content development' },
        { id: 'contracts', name: 'Contracts Agent', icon: 'clipboard', color: '#6366F1', desc: 'Contract terms analysis' },
        { id: 'orals', name: 'Orals Agent', icon: 'presentation', color: '#14B8A6', desc: 'Presentation preparation' },
      ];

      const handleSend = async () => {
        if (!input.trim() || !selectedAgent) return;
        
        const userMsg = { role: 'user', content: input };
        setMessages(prev => [...prev, userMsg]);
        setInput('');
        setLoading(true);

        // Simulate AI response
        await new Promise(r => setTimeout(r, 1500));
        
        const responses = {
          capture: `Based on my analysis, here's my recommendation:\n\n**Win Strategy:**\n• Lead with your proven healthcare IT experience\n• Ghost incumbent on outdated technology\n• Emphasize AI-powered analytics\n\n*Confidence: 87%*`,
          strategy: `**Technical Approach:**\n\n• Cloud-native on AWS GovCloud\n• Zero-trust security architecture\n• FHIR-compliant data layer\n\n**Key Discriminators:**\n1. Real-time analytics\n2. ML predictive modeling\n3. 99.99% uptime SLA`,
          blackhat: `**Competitive Assessment:**\n\n• Incumbent likely to emphasize relationship\n• Counter with innovation narrative\n• Target their 2019 technology stack\n\n*Recommend ghost strategy*`,
          pricing: `**Pricing Analysis:**\n\n• Blended rate target: $145/hr\n• Labor mix: Sr 40% / Mid 35% / Jr 25%\n• Consider 8% fee reduction for competition\n\n*Total estimate pending LCAT mapping*`,
          default: `I've analyzed your request. Here's what I recommend...\n\n*This is a simulated response. Connect to Claude API for live analysis.*`,
        };

        const aiMsg = { role: 'assistant', content: responses[selectedAgent.id] || responses.default };
        setMessages(prev => [...prev, aiMsg]);
        setLoading(false);
      };

      if (!selectedAgent) {
        return (
          <div className="space-y-6 animate-fadeIn">
            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
              {agents.map(agent => (
                <Card 
                  key={agent.id}
                  className="p-5 cursor-pointer hover:border-cyan-500/30 transition-all"
                  onClick={() => setSelectedAgent(agent)}
                >
                  <div className="w-12 h-12 rounded-xl flex items-center justify-center mb-3" style={{ backgroundColor: `${agent.color}20` }}>
                    <div style={{ color: agent.color }}>
                      <Icon name={agent.icon} className="w-6 h-6" />
                    </div>
                  </div>
                  <h3 className="font-semibold text-white mb-1">{agent.name}</h3>
                  <p className="text-slate-400 text-xs">{agent.desc}</p>
                </Card>
              ))}
            </div>
          </div>
        );
      }

      return (
        <div className="h-[calc(100vh-10rem)] flex flex-col animate-fadeIn">
          {/* Agent Header */}
          <div className="flex items-center justify-between mb-4">
            <div className="flex items-center gap-3">
              <Button variant="ghost" size="sm" icon="chevronRight" onClick={() => { setSelectedAgent(null); setMessages([]); }} className="rotate-180" />
              <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{ backgroundColor: `${selectedAgent.color}20` }}>
                <div style={{ color: selectedAgent.color }}>
                  <Icon name={selectedAgent.icon} className="w-5 h-5" />
                </div>
              </div>
              <div>
                <h2 className="font-semibold text-white">{selectedAgent.name}</h2>
                <p className="text-slate-400 text-xs">{selectedAgent.desc}</p>
              </div>
            </div>
          </div>

          {/* Messages */}
          <Card className="flex-1 p-4 overflow-y-auto mb-4">
            {messages.length === 0 ? (
              <div className="h-full flex flex-col items-center justify-center text-center">
                <div className="w-16 h-16 rounded-2xl flex items-center justify-center mb-4" style={{ backgroundColor: `${selectedAgent.color}20` }}>
                  <div style={{ color: selectedAgent.color }}>
                    <Icon name={selectedAgent.icon} className="w-8 h-8" />
                  </div>
                </div>
                <h3 className="text-lg font-semibold text-white mb-2">Start a conversation</h3>
                <p className="text-slate-400 text-sm max-w-md">{selectedAgent.desc}. Ask me anything about your opportunities.</p>
                <div className="flex flex-wrap justify-center gap-2 mt-4">
                  {['Analyze this opportunity', 'What are the key risks?', 'Generate a strategy'].map(prompt => (
                    <button key={prompt} onClick={() => setInput(prompt)} className="px-3 py-1.5 text-sm bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-full border border-slate-700 transition-colors">
                      {prompt}
                    </button>
                  ))}
                </div>
              </div>
            ) : (
              <div className="space-y-4">
                {messages.map((msg, i) => (
                  <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                    <div className={`max-w-[80%] p-4 rounded-xl ${msg.role === 'user' ? 'bg-cyan-500/20 border border-cyan-500/30' : 'bg-slate-800/50 border border-slate-700/50'}`}>
                      <p className="text-white text-sm whitespace-pre-wrap">{msg.content}</p>
                    </div>
                  </div>
                ))}
                {loading && (
                  <div className="flex justify-start">
                    <div className="bg-slate-800/50 border border-slate-700/50 rounded-xl p-4">
                      <Icon name="loader" className="w-5 h-5 text-cyan-400" />
                    </div>
                  </div>
                )}
              </div>
            )}
          </Card>

          {/* Input */}
          <div className="flex gap-3">
            <input
              type="text"
              value={input}
              onChange={(e) => setInput(e.target.value)}
              onKeyPress={(e) => e.key === 'Enter' && handleSend()}
              placeholder={`Ask ${selectedAgent.name}...`}
              className="flex-1 bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white placeholder-slate-500 focus:outline-none focus:border-cyan-500"
            />
            <Button onClick={handleSend} disabled={loading || !input.trim()} icon="send">Send</Button>
          </div>
        </div>
      );
    };

    // Reports Page
    const ReportsPage = () => {
      const { addToast } = useToast();
      const reports = [
        { id: 'executive', name: 'Executive Summary', icon: 'fileText', color: '#00E5FA' },
        { id: 'pipeline', name: 'Pipeline Report', icon: 'target', color: '#8B5CF6' },
        { id: 'compliance', name: 'Compliance Matrix', icon: 'clipboard', color: '#10B981' },
        { id: 'pricing', name: 'Pricing Summary', icon: 'calculator', color: '#F59E0B' },
        { id: 'competitive', name: 'Competitive Analysis', icon: 'eye', color: '#EF4444' },
        { id: 'team', name: 'Team Assignments', icon: 'users', color: '#EC4899' },
      ];

      return (
        <div className="space-y-6 animate-fadeIn">
          <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
            {reports.map(report => (
              <Card 
                key={report.id}
                className="p-5 cursor-pointer hover:border-cyan-500/30 transition-all"
                onClick={() => addToast(`Generating ${report.name}...`, 'info')}
              >
                <div className="w-12 h-12 rounded-xl flex items-center justify-center mb-3" style={{ backgroundColor: `${report.color}20` }}>
                  <div style={{ color: report.color }}>
                    <Icon name={report.icon} className="w-6 h-6" />
                  </div>
                </div>
                <h3 className="font-semibold text-white mb-1">{report.name}</h3>
                <p className="text-slate-400 text-xs">Generate detailed report</p>
              </Card>
            ))}
          </div>
        </div>
      );
    };

    // Audit Log Page
    const AuditPage = () => {
      const [logs, setLogs] = useState([]);
      const [loading, setLoading] = useState(true);

      useEffect(() => {
        const load = async () => {
          const data = await API.getAuditLogs(50);
          setLogs(data);
          setLoading(false);
        };
        load();
      }, []);

      if (loading) {
        return <div className="flex items-center justify-center h-64"><Icon name="loader" className="w-8 h-8 text-cyan-400" /></div>;
      }

      return (
        <div className="space-y-4 animate-fadeIn">
          <Card className="overflow-hidden">
            <table className="w-full">
              <thead className="bg-slate-800/50">
                <tr className="text-left text-sm text-slate-400">
                  <th className="px-4 py-3">Action</th>
                  <th className="px-4 py-3">Module</th>
                  <th className="px-4 py-3">Details</th>
                  <th className="px-4 py-3">Timestamp</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-slate-800">
                {logs.map((log, i) => (
                  <tr key={log.id || i} className="text-sm hover:bg-slate-800/30">
                    <td className="px-4 py-3 text-white font-medium">{log.action}</td>
                    <td className="px-4 py-3"><Badge variant="default" size="xs">{log.module}</Badge></td>
                    <td className="px-4 py-3 text-slate-400 truncate max-w-xs">{JSON.stringify(log.details)}</td>
                    <td className="px-4 py-3 text-slate-500">{new Date(log.created_at).toLocaleString()}</td>
                  </tr>
                ))}
                {logs.length === 0 && (
                  <tr><td colSpan="4" className="px-4 py-8 text-center text-slate-500">No audit logs found</td></tr>
                )}
              </tbody>
            </table>
          </Card>
        </div>
      );
    };

    // Settings Page
    const SettingsPage = () => {
      return (
        <div className="max-w-2xl space-y-6 animate-fadeIn">
          <Card className="p-6">
            <div className="flex items-center gap-4 mb-6">
              <div className="w-16 h-16 rounded-full bg-gradient-to-br from-cyan-500 to-teal-500 flex items-center justify-center">
                <Icon name="user" className="w-8 h-8 text-white" />
              </div>
              <div>
                <h2 className="text-xl font-bold text-white">Mary Womack</h2>
                <p className="text-slate-400">maryadawson@gmail.com</p>
                <Badge variant="primary" size="sm">Administrator</Badge>
              </div>
            </div>
            <div className="space-y-4">
              <div className="flex items-center justify-between p-3 rounded-lg bg-slate-900/50">
                <span className="text-slate-300">Company</span>
                <span className="text-white font-medium">Mission Meets Tech</span>
              </div>
              <div className="flex items-center justify-between p-3 rounded-lg bg-slate-900/50">
                <span className="text-slate-300">Role</span>
                <span className="text-white font-medium">CEO</span>
              </div>
              <div className="flex items-center justify-between p-3 rounded-lg bg-slate-900/50">
                <span className="text-slate-300">Session Status</span>
                <span className="text-emerald-400 font-medium flex items-center gap-2">
                  <span className="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                  Active
                </span>
              </div>
            </div>
          </Card>
          <Button variant="danger" icon="logout" fullWidth>Sign Out</Button>
        </div>
      );
    };

    // Placeholder Page
    const PlaceholderPage = ({ title }) => (
      <div className="flex flex-col items-center justify-center h-64 text-center animate-fadeIn">
        <Icon name="rocket" className="w-12 h-12 text-slate-600 mb-4" />
        <h2 className="text-xl font-semibold text-white mb-2">{title}</h2>
        <p className="text-slate-400">This module is coming soon.</p>
      </div>
    );

    // ============================================
    // MAIN APP
    // ============================================
    const App = () => {
      const [currentPage, setCurrentPage] = useState('dashboard');
      const [sidebarCollapsed, setSidebarCollapsed] = useState(false);

      const getPageTitle = () => {
        const item = NAV_ITEMS.find(n => n.id === currentPage);
        return item?.label || currentPage.charAt(0).toUpperCase() + currentPage.slice(1);
      };

      const renderPage = () => {
        switch (currentPage) {
          case 'dashboard': return <DashboardPage />;
          case 'pipeline': return <PipelinePage />;
          case 'agents': return <AgentsPage />;
          case 'reports': return <ReportsPage />;
          case 'audit': return <AuditPage />;
          case 'settings': return <SettingsPage />;
          default: return <PlaceholderPage title={getPageTitle()} />;
        }
      };

      return (
        <ToastProvider>
          <div className="min-h-screen bg-[#00050F]">
            <Sidebar 
              currentPage={currentPage} 
              setCurrentPage={setCurrentPage}
              collapsed={sidebarCollapsed}
              setCollapsed={setSidebarCollapsed}
            />
            <Header 
              title={getPageTitle()}
              sidebarCollapsed={sidebarCollapsed}
            />
            <main className={`pt-24 pb-8 px-6 transition-all duration-300 ${sidebarCollapsed ? 'ml-16' : 'ml-64'}`}>
              {renderPage()}
            </main>
            <footer className={`fixed bottom-0 right-0 p-2 text-xs text-slate-600 transition-all duration-300 ${sidebarCollapsed ? 'left-16' : 'left-64'}`}>
              <div className="text-center">AI GENERATED - REQUIRES HUMAN REVIEW • MissionPulse v12.0</div>
            </footer>
          </div>
        </ToastProvider>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
