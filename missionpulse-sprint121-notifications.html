<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MissionPulse - Notification Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'mp-navy': '#00050F',
                        'mp-cyan': '#00E5FA',
                        'mp-slate': '#0A1628'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        * { font-family: 'Inter', sans-serif; }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .notification-enter { animation: slideIn 0.3s ease-out; }
    </style>
  <script src="rbac-guard.js"></script>
</head>
<body class="bg-mp-navy min-h-screen text-white">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useMemo } = React;

        const notificationsData = [
            {
                id: 1,
                type: 'deadline',
                priority: 'critical',
                title: 'URGENT: Proposal Due in 3 Days',
                message: 'CMS Data Analytics Platform proposal due February 28. Cost volume still incomplete.',
                opportunity: 'CMS Data Analytics Platform',
                timestamp: '2024-02-25T14:30:00',
                read: false,
                actionRequired: true,
                actionLabel: 'View Proposal'
            },
            {
                id: 2,
                type: 'approval',
                priority: 'high',
                title: 'HITL Approval Required',
                message: 'AI-generated pricing analysis for VA Cloud Migration requires your review and approval.',
                opportunity: 'VA Cloud Migration',
                timestamp: '2024-02-25T13:15:00',
                read: false,
                actionRequired: true,
                actionLabel: 'Review Now'
            },
            {
                id: 3,
                type: 'review',
                priority: 'high',
                title: 'Gold Team Review Scheduled',
                message: 'DHA EHR Modernization Gold Team review scheduled for March 1, 9:00 AM. Please confirm attendance.',
                opportunity: 'DHA EHR Modernization',
                timestamp: '2024-02-25T11:00:00',
                read: false,
                actionRequired: true,
                actionLabel: 'Confirm Attendance'
            },
            {
                id: 4,
                type: 'team',
                priority: 'medium',
                title: 'New Team Assignment',
                message: 'You have been assigned as Technical Lead for the IHS Telehealth opportunity.',
                opportunity: 'IHS Telehealth',
                timestamp: '2024-02-25T09:30:00',
                read: true,
                actionRequired: false
            },
            {
                id: 5,
                type: 'update',
                priority: 'medium',
                title: 'Amendment Released',
                message: 'VA Cloud Migration Amendment #3 released. FedRAMP High requirement added.',
                opportunity: 'VA Cloud Migration',
                timestamp: '2024-02-24T16:45:00',
                read: true,
                actionRequired: true,
                actionLabel: 'View Amendment'
            },
            {
                id: 6,
                type: 'milestone',
                priority: 'low',
                title: 'Milestone Completed',
                message: 'Technical Approach draft completed for DHA EHR Modernization.',
                opportunity: 'DHA EHR Modernization',
                timestamp: '2024-02-24T15:20:00',
                read: true,
                actionRequired: false
            },
            {
                id: 7,
                type: 'compliance',
                priority: 'high',
                title: 'Compliance Check Failed',
                message: 'Section L response for CMS Data Analytics missing required elements. 3 issues found.',
                opportunity: 'CMS Data Analytics Platform',
                timestamp: '2024-02-24T14:00:00',
                read: false,
                actionRequired: true,
                actionLabel: 'View Issues'
            },
            {
                id: 8,
                type: 'system',
                priority: 'low',
                title: 'System Maintenance',
                message: 'Scheduled maintenance on February 27, 2:00 AM - 4:00 AM EST. Brief service interruption expected.',
                timestamp: '2024-02-24T10:00:00',
                read: true,
                actionRequired: false
            },
            {
                id: 9,
                type: 'win',
                priority: 'high',
                title: 'üéâ Contract Award!',
                message: 'Congratulations! VA Cloud Services Task Order 3 has been awarded. Value: $18.5M.',
                opportunity: 'VA Cloud Services',
                timestamp: '2024-02-23T11:30:00',
                read: true,
                actionRequired: false
            },
            {
                id: 10,
                type: 'deadline',
                priority: 'medium',
                title: 'Q&A Deadline Tomorrow',
                message: 'Questions for VA Cloud Migration must be submitted by February 26, 5:00 PM.',
                opportunity: 'VA Cloud Migration',
                timestamp: '2024-02-25T08:00:00',
                read: false,
                actionRequired: true,
                actionLabel: 'View Questions'
            }
        ];

        const notificationConfig = {
            deadline: { icon: '‚è∞', color: 'text-red-400', bgColor: 'bg-red-500/10', borderColor: 'border-red-500' },
            approval: { icon: '‚úÖ', color: 'text-yellow-400', bgColor: 'bg-yellow-500/10', borderColor: 'border-yellow-500' },
            review: { icon: 'üìã', color: 'text-blue-400', bgColor: 'bg-blue-500/10', borderColor: 'border-blue-500' },
            team: { icon: 'üë•', color: 'text-purple-400', bgColor: 'bg-purple-500/10', borderColor: 'border-purple-500' },
            update: { icon: 'üì¢', color: 'text-orange-400', bgColor: 'bg-orange-500/10', borderColor: 'border-orange-500' },
            milestone: { icon: 'üéØ', color: 'text-green-400', bgColor: 'bg-green-500/10', borderColor: 'border-green-500' },
            compliance: { icon: '‚ö†Ô∏è', color: 'text-red-400', bgColor: 'bg-red-500/10', borderColor: 'border-red-500' },
            system: { icon: '‚öôÔ∏è', color: 'text-gray-400', bgColor: 'bg-gray-500/10', borderColor: 'border-gray-500' },
            win: { icon: 'üèÜ', color: 'text-green-400', bgColor: 'bg-green-500/10', borderColor: 'border-green-500' }
        };

        function formatTimestamp(timestamp) {
            const date = new Date(timestamp);
            const now = new Date('2024-02-25T15:00:00');
            const diffHours = Math.floor((now - date) / (1000 * 60 * 60));
            
            if (diffHours < 1) return 'Just now';
            if (diffHours < 24) return `${diffHours}h ago`;
            if (diffHours < 48) return 'Yesterday';
            return date.toLocaleDateString();
        }

        function NotificationCard({ notification, onMarkRead, onAction }) {
            const config = notificationConfig[notification.type] || notificationConfig.system;
            
            return (
                <div 
                    className={`${config.bgColor} border-l-4 ${config.borderColor} rounded-r-xl p-4 transition-all hover:bg-opacity-20 ${!notification.read ? 'notification-enter' : ''}`}
                >
                    <div className="flex items-start gap-4">
                        <span className={`text-2xl ${config.color}`}>{config.icon}</span>
                        <div className="flex-1">
                            <div className="flex items-start justify-between mb-1">
                                <div>
                                    <h3 className={`font-semibold ${notification.read ? 'text-gray-300' : 'text-white'}`}>
                                        {notification.title}
                                    </h3>
                                    {notification.opportunity && (
                                        <p className="text-xs text-gray-500">{notification.opportunity}</p>
                                    )}
                                </div>
                                <div className="flex items-center gap-2">
                                    {!notification.read && (
                                        <span className="w-2 h-2 bg-mp-cyan rounded-full"></span>
                                    )}
                                    <span className="text-xs text-gray-500">{formatTimestamp(notification.timestamp)}</span>
                                </div>
                            </div>
                            
                            <p className={`text-sm ${notification.read ? 'text-gray-400' : 'text-gray-300'} mb-3`}>
                                {notification.message}
                            </p>

                            <div className="flex items-center gap-3">
                                {notification.actionRequired && (
                                    <button 
                                        onClick={() => onAction(notification)}
                                        className="px-3 py-1.5 bg-mp-cyan text-mp-navy rounded-lg text-sm font-medium hover:bg-mp-cyan/90 transition-colors"
                                    >
                                        {notification.actionLabel}
                                    </button>
                                )}
                                {!notification.read && (
                                    <button 
                                        onClick={() => onMarkRead(notification.id)}
                                        className="px-3 py-1.5 border border-gray-700 rounded-lg text-sm text-gray-400 hover:bg-mp-navy transition-colors"
                                    >
                                        Mark as Read
                                    </button>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        function NotificationPreferences() {
            const [prefs, setPrefs] = useState({
                deadlines: true,
                approvals: true,
                reviews: true,
                team: true,
                updates: true,
                system: false,
                emailDigest: 'daily'
            });

            return (
                <div className="bg-mp-slate rounded-xl p-4">
                    <h3 className="font-semibold text-white mb-4">Notification Preferences</h3>
                    <div className="space-y-3">
                        {[
                            { key: 'deadlines', label: 'Deadline Alerts', icon: '‚è∞' },
                            { key: 'approvals', label: 'Approval Requests', icon: '‚úÖ' },
                            { key: 'reviews', label: 'Review Notifications', icon: 'üìã' },
                            { key: 'team', label: 'Team Updates', icon: 'üë•' },
                            { key: 'updates', label: 'Amendment Alerts', icon: 'üì¢' },
                            { key: 'system', label: 'System Notices', icon: '‚öôÔ∏è' }
                        ].map(item => (
                            <label key={item.key} className="flex items-center justify-between cursor-pointer">
                                <span className="flex items-center gap-2 text-sm text-gray-300">
                                    <span>{item.icon}</span>
                                    {item.label}
                                </span>
                                <input 
                                    type="checkbox"
                                    checked={prefs[item.key]}
                                    onChange={(e) => setPrefs({...prefs, [item.key]: e.target.checked})}
                                    className="rounded"
                                />
                            </label>
                        ))}
                    </div>
                    
                    <div className="mt-4 pt-4 border-t border-gray-800">
                        <label className="block text-sm text-gray-400 mb-2">Email Digest</label>
                        <select 
                            value={prefs.emailDigest}
                            onChange={(e) => setPrefs({...prefs, emailDigest: e.target.value})}
                            className="w-full bg-mp-navy border border-gray-700 rounded-lg px-3 py-2 text-sm text-white"
                        >
                            <option value="realtime">Real-time</option>
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="none">None</option>
                        </select>
                    </div>
                </div>
            );
        }

        function App() {
            const [notifications, setNotifications] = useState(notificationsData);
            const [filterType, setFilterType] = useState('all');
            const [showUnreadOnly, setShowUnreadOnly] = useState(false);
            const [showPrefs, setShowPrefs] = useState(false);

            const filteredNotifications = useMemo(() => {
                return notifications
                    .filter(n => filterType === 'all' || n.type === filterType)
                    .filter(n => !showUnreadOnly || !n.read)
                    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            }, [notifications, filterType, showUnreadOnly]);

            const metrics = useMemo(() => {
                const unread = notifications.filter(n => !n.read).length;
                const actionRequired = notifications.filter(n => n.actionRequired && !n.read).length;
                const critical = notifications.filter(n => n.priority === 'critical' && !n.read).length;
                return { unread, actionRequired, critical };
            }, [notifications]);

            const handleMarkRead = (id) => {
                setNotifications(notifications.map(n => 
                    n.id === id ? {...n, read: true} : n
                ));
            };

            const handleMarkAllRead = () => {
                setNotifications(notifications.map(n => ({...n, read: true})));
            };

            const handleAction = (notification) => {
                console.log('Action for:', notification.title);
                handleMarkRead(notification.id);
            };

            return (
                <div className="min-h-screen bg-mp-navy">
                    {/* Header */}
                    <header className="bg-mp-slate border-b border-gray-800 px-6 py-4">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center gap-4">
                                <div className="w-10 h-10 bg-gradient-to-br from-mp-cyan to-blue-600 rounded-lg flex items-center justify-center relative">
                                    <span className="text-xl">üîî</span>
                                    {metrics.unread > 0 && (
                                        <span className="absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-xs flex items-center justify-center font-bold">
                                            {metrics.unread}
                                        </span>
                                    )}
                                </div>
                                <div>
                                    <h1 className="text-xl font-bold text-white">Notification Center</h1>
                                    <p className="text-sm text-gray-400">Stay on top of deadlines and updates</p>
                                </div>
                            </div>
                            <div className="flex items-center gap-4">
                                <button 
                                    onClick={handleMarkAllRead}
                                    className="text-sm text-mp-cyan hover:underline"
                                >
                                    Mark All Read
                                </button>
                                <button 
                                    onClick={() => setShowPrefs(!showPrefs)}
                                    className="px-4 py-2 border border-gray-700 rounded-lg text-sm text-gray-400 hover:bg-mp-navy transition-colors"
                                >
                                    ‚öôÔ∏è Settings
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* Metrics */}
                    <div className="px-6 py-4 border-b border-gray-800">
                        <div className="grid grid-cols-4 gap-4">
                            <div className="bg-mp-slate rounded-xl p-4 text-center">
                                <p className="text-3xl font-bold text-white">{notifications.length}</p>
                                <p className="text-sm text-gray-400">Total</p>
                            </div>
                            <div className="bg-mp-slate rounded-xl p-4 text-center">
                                <p className="text-3xl font-bold text-mp-cyan">{metrics.unread}</p>
                                <p className="text-sm text-gray-400">Unread</p>
                            </div>
                            <div className="bg-mp-slate rounded-xl p-4 text-center">
                                <p className="text-3xl font-bold text-yellow-400">{metrics.actionRequired}</p>
                                <p className="text-sm text-gray-400">Action Required</p>
                            </div>
                            <div className="bg-mp-slate rounded-xl p-4 text-center">
                                <p className="text-3xl font-bold text-red-400">{metrics.critical}</p>
                                <p className="text-sm text-gray-400">Critical</p>
                            </div>
                        </div>
                    </div>

                    {/* Filters */}
                    <div className="px-6 py-3 border-b border-gray-800 flex items-center justify-between">
                        <div className="flex gap-2 flex-wrap">
                            {['all', 'deadline', 'approval', 'review', 'team', 'update', 'compliance'].map(type => (
                                <button
                                    key={type}
                                    onClick={() => setFilterType(type)}
                                    className={`px-3 py-1.5 rounded-lg text-sm transition-colors ${
                                        filterType === type 
                                            ? 'bg-mp-cyan text-mp-navy font-medium' 
                                            : 'bg-mp-slate text-gray-400 hover:text-white'
                                    }`}
                                >
                                    {type === 'all' ? 'All' : type.charAt(0).toUpperCase() + type.slice(1)}
                                </button>
                            ))}
                        </div>
                        <label className="flex items-center gap-2 cursor-pointer">
                            <input 
                                type="checkbox"
                                checked={showUnreadOnly}
                                onChange={(e) => setShowUnreadOnly(e.target.checked)}
                                className="rounded"
                            />
                            <span className="text-sm text-gray-400">Unread only</span>
                        </label>
                    </div>

                    {/* Main Content */}
                    <div className="flex">
                        {/* Notifications List */}
                        <div className={`${showPrefs ? 'w-2/3' : 'w-full'} p-6 space-y-4 max-h-[calc(100vh-280px)] overflow-y-auto`}>
                            {filteredNotifications.map(notification => (
                                <NotificationCard
                                    key={notification.id}
                                    notification={notification}
                                    onMarkRead={handleMarkRead}
                                    onAction={handleAction}
                                />
                            ))}
                            {filteredNotifications.length === 0 && (
                                <div className="text-center py-12 text-gray-400">
                                    <span className="text-4xl">üì≠</span>
                                    <p className="mt-2">No notifications</p>
                                </div>
                            )}
                        </div>

                        {/* Preferences Sidebar */}
                        {showPrefs && (
                            <div className="w-1/3 border-l border-gray-800 p-6">
                                <NotificationPreferences />
                            </div>
                        )}
                    </div>

                    {/* Footer */}
                    <footer className="fixed bottom-0 left-0 right-0 bg-mp-slate border-t border-gray-800 px-6 py-3">
                        <div className="flex items-center justify-between text-sm text-gray-400">
                            <span>MissionPulse v12 ‚Ä¢ Notification Center Module</span>
                            <span className="text-yellow-500">‚ö†Ô∏è AI GENERATED - REQUIRES HUMAN REVIEW</span>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
