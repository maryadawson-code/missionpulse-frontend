<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse M3 - Shipley Phase Swimlane Board</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'pulse-cyan': '#00E5FA',
            'shield-navy': '#00050F',
            'shield-dark': '#0a0f1a',
            'shield-panel': '#0d1526',
          }
        }
      }
    }
  </script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', sans-serif; background: #00050F; min-height: 100vh; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
    .animate-pulse { animation: pulse 2s ease-in-out infinite; }
    .animate-shimmer { 
      background: linear-gradient(90deg, transparent, rgba(0,229,250,0.1), transparent);
      background-size: 200% 100%;
      animation: shimmer 2s infinite;
    }
    .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
    .scrollbar-thin::-webkit-scrollbar-track { background: #1e293b; border-radius: 3px; }
    .scrollbar-thin::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
    .scrollbar-thin::-webkit-scrollbar-thumb:hover { background: #00E5FA; }
    .drag-handle { cursor: grab; }
    .drag-handle:active { cursor: grabbing; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Icons
    const Icons = {
      grip: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 8h16M4 16h16" /></svg>,
      chevronRight: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" /></svg>,
      check: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>,
      clock: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" strokeWidth={2}/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6l4 2" /></svg>,
      users: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" /></svg>,
      target: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" strokeWidth={2}/><circle cx="12" cy="12" r="6" strokeWidth={2}/><circle cx="12" cy="12" r="2" strokeWidth={2}/></svg>,
      shield: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>,
      dollar: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
      alert: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>,
      arrowRight: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>,
      // Sidebar Icons
      chevronLeft: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" /></svg>,
      chevronDown: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" /></svg>,
      home: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>,
      filter: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" /></svg>,
      swords: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 6l6 6m0 0l6-6m-6 6v12M4 4l16 16M20 4L4 20" /></svg>,
      kanban: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2" /></svg>,
      edit: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" /></svg>,
      scale: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" /></svg>,
      eyeOff: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" /></svg>,
      calculator: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>,
      mic: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" /></svg>,
      rocket: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>,
      handshake: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" /></svg>,
      book: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>,
      settings: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>,
      clipboard: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" /></svg>,
    };

    const Icon = ({ name, className = "w-4 h-4", style = {} }) => {
      const IconComponent = Icons[name];
      return IconComponent ? <span className={`inline-block ${className}`} style={style}><IconComponent /></span> : null;
    };

    // Navigation Data
    const NAV_MODULES = [
      { id: 'index', name: 'Navigation Hub', href: 'index.html', icon: 'home', color: '#00E5FA', category: 'Command' },
      { id: 'm1', name: 'Pipeline Intel', href: 'missionpulse-m1-enhanced.html', icon: 'filter', color: '#3B82F6', category: 'Strategy' },
      { id: 'm2', name: 'War Room', href: 'missionpulse-m2-warroom-enhanced.html', icon: 'swords', color: '#8B5CF6', category: 'Strategy' },
      { id: 'm3', name: 'Swimlane Board', href: 'missionpulse-m3-swimlane-board.html', icon: 'kanban', color: '#00D29F', category: 'Strategy' },
      { id: 'm4', name: 'Proposal Writer', href: 'missionpulse-m4-proposal-writer.html', icon: 'edit', color: '#EC4899', category: 'Intelligence' },
      { id: 'm5', name: 'Contract Scanner', href: 'missionpulse-m5-contracts-enhanced.html', icon: 'scale', color: '#F59E0B', category: 'Intelligence' },
      { id: 'm6', name: 'Iron Dome', href: 'missionpulse-m6-iron-dome.html', icon: 'shield', color: '#EF4444', category: 'Intelligence', badge: 'CUI' },
      { id: 'm7', name: 'Black Hat', href: 'missionpulse-m7-blackhat-enhanced.html', icon: 'eyeOff', color: '#DC2626', category: 'Intelligence', badge: 'PRIVATE' },
      { id: 'm8', name: 'Pricing Engine', href: 'missionpulse-m8-pricing.html', icon: 'calculator', color: '#10B981', category: 'Delivery', badge: 'CUI' },
      { id: 'm9', name: 'Orals Coach', href: 'missionpulse-m9-hitl-enhanced.html', icon: 'mic', color: '#F472B6', category: 'Delivery', badge: 'PRIVATE' },
      { id: 'm11', name: 'Partner Wall', href: 'missionpulse-m11-frenemy-protocol.html', icon: 'users', color: '#F97316', category: 'Delivery' },
      { id: 'm13', name: 'Launch & ROI', href: 'missionpulse-m13-launch-roi.html', icon: 'rocket', color: '#A855F7', category: 'Command' },
      { id: 'm14', name: 'Post-Award', href: 'missionpulse-m14-post-award.html', icon: 'handshake', color: '#00BDAE', category: 'Command' },
      { id: 'm15', name: 'Lessons Playbook', href: 'missionpulse-m15-lessons-playbook.html', icon: 'book', color: '#6366F1', category: 'Command' },
      { id: 'm16', name: 'RBAC Config', href: 'missionpulse-task16-rbac.html', icon: 'settings', color: '#64748B', category: 'Admin', badge: 'ADMIN' }
    ];
    const MODULE_CATEGORIES = [
      { id: 'Command', name: 'Command Center' },
      { id: 'Strategy', name: 'Strategy Phase' },
      { id: 'Intelligence', name: 'Intelligence' },
      { id: 'Delivery', name: 'Delivery' },
      { id: 'Admin', name: 'Administration' }
    ];
    const CURRENT_ROLE = { id: 'PM', name: 'Proposal Manager', fullName: 'Proposal Manager', icon: 'clipboard', color: '#3B82F6' };

    // Sidebar Component
    const Sidebar = ({ currentModule = 'm3' }) => {
      const [collapsed, setCollapsed] = useState(() => { try { return JSON.parse(localStorage.getItem('mp_sidebar_collapsed')) || false; } catch { return false; } });
      const [expandedCats, setExpandedCats] = useState(['Command', 'Strategy', 'Intelligence', 'Delivery', 'Admin']);
      useEffect(() => { localStorage.setItem('mp_sidebar_collapsed', JSON.stringify(collapsed)); }, [collapsed]);
      const toggleCat = (catId) => setExpandedCats(prev => prev.includes(catId) ? prev.filter(c => c !== catId) : [...prev, catId]);
      const modulesByCat = MODULE_CATEGORIES.reduce((acc, cat) => { acc[cat.id] = NAV_MODULES.filter(m => m.category === cat.id); return acc; }, {});
      return (
        <aside className={`fixed left-0 top-0 h-screen bg-slate-900/95 backdrop-blur-sm border-r border-slate-800 flex flex-col transition-all duration-300 z-50 ${collapsed ? 'w-16' : 'w-64'}`}>
          <div className="p-4 border-b border-slate-800">
            <div className="flex items-center justify-between">
              <div className={`flex items-center gap-2 ${collapsed ? 'justify-center w-full' : ''}`}>
                <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-500 to-teal-400 flex items-center justify-center flex-shrink-0"><span className="text-white font-bold text-sm">MP</span></div>
                {!collapsed && <div><h1 className="text-sm font-bold text-white">MissionPulse</h1><p className="text-[10px] text-slate-500">v12.0 Ultimate</p></div>}
              </div>
              {!collapsed && <button onClick={() => setCollapsed(true)} className="p-1.5 rounded-lg hover:bg-slate-800 text-slate-400"><Icon name="chevronLeft" className="w-4 h-4" /></button>}
            </div>
          </div>
          <div className={`p-3 border-b border-slate-800 ${collapsed ? 'flex justify-center' : ''}`}>
            <div className="flex items-center gap-2">
              <div className="w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0" style={{ backgroundColor: `${CURRENT_ROLE.color}20` }}><Icon name={CURRENT_ROLE.icon} className="w-4 h-4" style={{ color: CURRENT_ROLE.color }} /></div>
              {!collapsed && <div><p className="text-sm font-medium text-white">{CURRENT_ROLE.fullName}</p><p className="text-xs text-slate-400">{CURRENT_ROLE.name}</p></div>}
            </div>
          </div>
          <nav className="flex-1 overflow-y-auto p-3 space-y-1">
            {MODULE_CATEGORIES.map(cat => {
              const mods = modulesByCat[cat.id] || [];
              if (mods.length === 0) return null;
              const isExp = expandedCats.includes(cat.id);
              return (
                <div key={cat.id} className="mb-2">
                  {!collapsed && <button onClick={() => toggleCat(cat.id)} className="w-full flex items-center justify-between px-2 py-1.5 text-[10px] uppercase font-semibold text-slate-500 hover:text-slate-300"><span>{cat.name}</span><Icon name={isExp ? 'chevronDown' : 'chevronRight'} className="w-3 h-3" /></button>}
                  {(isExp || collapsed) && (
                    <div className="space-y-0.5">
                      {mods.map(mod => {
                        const isActive = currentModule === mod.id;
                        return (
                          <a key={mod.id} href={mod.href} className={`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all ${isActive ? 'bg-gradient-to-r from-cyan-500/20 to-transparent border-l-2 border-cyan-400' : 'hover:bg-slate-800/50'}`}>
                            <div className="w-7 h-7 rounded-lg flex items-center justify-center flex-shrink-0" style={{ backgroundColor: isActive ? `${mod.color}30` : `${mod.color}15` }}><Icon name={mod.icon} className="w-3.5 h-3.5" style={{ color: mod.color }} /></div>
                            {!collapsed && <><span className={`flex-1 text-sm font-medium text-left ${isActive ? 'text-white' : 'text-slate-300'}`}>{mod.name}</span>{mod.badge && <span className={`px-1.5 py-0.5 text-[9px] font-semibold rounded ${mod.badge === 'PRIVATE' ? 'bg-red-500/20 text-red-400' : mod.badge === 'CUI' ? 'bg-amber-500/20 text-amber-400' : 'bg-purple-500/20 text-purple-400'}`}>{mod.badge}</span>}</>}
                          </a>
                        );
                      })}
                    </div>
                  )}
                </div>
              );
            })}
          </nav>
          {collapsed && <div className="p-3 border-t border-slate-800"><button onClick={() => setCollapsed(false)} className="w-full p-2 rounded-lg hover:bg-slate-800 text-slate-400 flex justify-center"><Icon name="chevronRight" className="w-4 h-4" /></button></div>}
          <div className={`p-3 border-t border-slate-800 ${collapsed ? 'text-center' : ''}`}>
            <div className="flex items-center gap-2 px-2"><span className="w-2 h-2 rounded-full bg-emerald-400 animate-pulse" />{!collapsed && <span className="text-[10px] text-slate-400">FedRAMP Moderate</span>}</div>
            {!collapsed && <p className="text-[9px] text-slate-600 mt-2 px-2">AI GENERATED - REQUIRES HUMAN REVIEW</p>}
          </div>
        </aside>
      );
    };

    // Shipley Phases with colors and descriptions
    const SHIPLEY_PHASES = [
      { id: 'gate1', name: 'Gate 1', shortName: 'G1', color: '#6366F1', description: 'Go/No-Go Decision' },
      { id: 'blue', name: 'Blue Team', shortName: 'BT', color: '#3B82F6', description: 'Strategy Review' },
      { id: 'kickoff', name: 'Kickoff', shortName: 'KO', color: '#8B5CF6', description: '48hr from RFP' },
      { id: 'pink', name: 'Pink Team', shortName: 'PT', color: '#EC4899', description: '30% Draft Review' },
      { id: 'red', name: 'Red Team', shortName: 'RT', color: '#EF4444', description: '70% Compliance' },
      { id: 'gold', name: 'Gold Team', shortName: 'GT', color: '#F59E0B', description: '90% Final Review' },
      { id: 'white', name: 'White Glove', shortName: 'WG', color: '#F8FAFC', description: 'QC & Production' },
      { id: 'submit', name: 'Submission', shortName: 'SUB', color: '#10B981', description: 'Final Delivery' },
    ];

    // Demo opportunities data
    const DEMO_OPPORTUNITIES = [
      {
        id: 'opp1',
        name: 'DHA Healthcare Data Platform',
        value: '$100M',
        priority: 'P-0',
        phase: 'red',
        dueDate: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000), // 2 days
        winProb: 72,
        owner: 'Sarah Chen',
        team: ['PM', 'SA', 'CON'],
      },
      {
        id: 'opp2',
        name: 'VA EHR Modernization',
        value: '$45M',
        priority: 'P-1',
        phase: 'pink',
        dueDate: new Date(Date.now() + 8 * 24 * 60 * 60 * 1000), // 8 days
        winProb: 58,
        owner: 'Mike Johnson',
        team: ['CAP', 'PM'],
      },
      {
        id: 'opp3',
        name: 'Army MedLog Support',
        value: '$28M',
        priority: 'P-1',
        phase: 'gold',
        dueDate: new Date(Date.now() + 1 * 24 * 60 * 60 * 1000), // 1 day
        winProb: 85,
        owner: 'Lisa Park',
        team: ['PM', 'SA', 'FIN', 'CON'],
      },
      {
        id: 'opp4',
        name: 'DISA Cloud Migration',
        value: '$65M',
        priority: 'P-0',
        phase: 'blue',
        dueDate: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000), // 14 days
        winProb: 45,
        owner: 'David Kim',
        team: ['CEO', 'CAP'],
      },
      {
        id: 'opp5',
        name: 'NIH Research Portal',
        value: '$18M',
        priority: 'P-2',
        phase: 'kickoff',
        dueDate: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000), // 5 days
        winProb: 62,
        owner: 'Amy Wright',
        team: ['PM', 'SA'],
      },
      {
        id: 'opp6',
        name: 'CDC Analytics Platform',
        value: '$35M',
        priority: 'P-1',
        phase: 'gate1',
        dueDate: new Date(Date.now() + 21 * 24 * 60 * 60 * 1000), // 21 days
        winProb: 38,
        owner: 'Tom Rivera',
        team: ['CEO', 'COO'],
      },
      {
        id: 'opp7',
        name: 'FEMA Response System',
        value: '$22M',
        priority: 'P-2',
        phase: 'white',
        dueDate: new Date(Date.now() + 0.5 * 24 * 60 * 60 * 1000), // 12 hours
        winProb: 91,
        owner: 'Rachel Green',
        team: ['PM', 'DEL'],
      },
      {
        id: 'opp8',
        name: 'SSA Fraud Detection',
        value: '$55M',
        priority: 'P-1',
        phase: 'submit',
        dueDate: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000), // Submitted yesterday
        winProb: 78,
        owner: 'James Wilson',
        team: ['PM', 'SA', 'CON', 'FIN'],
      },
    ];

    // Get days until due
    const getDaysUntil = (date) => {
      const now = new Date();
      const diff = date - now;
      return Math.ceil(diff / (1000 * 60 * 60 * 24));
    };

    // Get due date color based on urgency
    const getDueDateColor = (dueDate) => {
      const days = getDaysUntil(dueDate);
      if (days < 0) return { bg: 'bg-slate-600', text: 'text-slate-300', label: 'Submitted' };
      if (days < 3) return { bg: 'bg-red-500/20', text: 'text-red-400', border: 'border-red-500/50' };
      if (days <= 7) return { bg: 'bg-amber-500/20', text: 'text-amber-400', border: 'border-amber-500/50' };
      return { bg: 'bg-emerald-500/20', text: 'text-emerald-400', border: 'border-emerald-500/50' };
    };

    // Priority badge colors
    const getPriorityColor = (priority) => {
      switch (priority) {
        case 'P-0': return 'bg-red-500/20 text-red-400 border-red-500/50';
        case 'P-1': return 'bg-amber-500/20 text-amber-400 border-amber-500/50';
        case 'P-2': return 'bg-slate-600/50 text-slate-300 border-slate-500/50';
        default: return 'bg-slate-700 text-slate-400';
      }
    };

    // Opportunity Card Component
    const OpportunityCard = ({ opportunity, onMoveNext, phaseIndex }) => {
      const dueColors = getDueDateColor(opportunity.dueDate);
      const days = getDaysUntil(opportunity.dueDate);
      const isLastPhase = phaseIndex === SHIPLEY_PHASES.length - 1;

      return (
        <div className="bg-slate-800/70 border border-slate-700/50 rounded-xl p-3 mb-3 hover:border-cyan-500/30 transition-all group">
          {/* Header with drag handle */}
          <div className="flex items-start justify-between mb-2">
            <div className="flex items-center gap-2">
              <div className="drag-handle p-1 rounded hover:bg-slate-700/50 text-slate-500 hover:text-slate-300">
                <Icon name="grip" className="w-3.5 h-3.5" />
              </div>
              <span className={`px-2 py-0.5 rounded text-xs font-semibold border ${getPriorityColor(opportunity.priority)}`}>
                {opportunity.priority}
              </span>
            </div>
            <span className="text-emerald-400 font-bold text-sm">{opportunity.value}</span>
          </div>

          {/* Opportunity Name */}
          <h4 className="text-white font-semibold text-sm mb-2 line-clamp-2">{opportunity.name}</h4>

          {/* Win Probability */}
          <div className="mb-2">
            <div className="flex items-center justify-between text-xs mb-1">
              <span className="text-slate-400">Win Probability</span>
              <span className={`font-semibold ${opportunity.winProb >= 70 ? 'text-emerald-400' : opportunity.winProb >= 50 ? 'text-amber-400' : 'text-red-400'}`}>
                {opportunity.winProb}%
              </span>
            </div>
            <div className="h-1.5 bg-slate-700 rounded-full overflow-hidden">
              <div 
                className={`h-full rounded-full transition-all ${opportunity.winProb >= 70 ? 'bg-emerald-500' : opportunity.winProb >= 50 ? 'bg-amber-500' : 'bg-red-500'}`}
                style={{ width: `${opportunity.winProb}%` }}
              />
            </div>
          </div>

          {/* Due Date */}
          <div className={`flex items-center gap-2 px-2 py-1.5 rounded-lg ${dueColors.bg} ${dueColors.border ? `border ${dueColors.border}` : ''} mb-2`}>
            <Icon name="clock" className={`w-3.5 h-3.5 ${dueColors.text}`} />
            <span className={`text-xs font-medium ${dueColors.text}`}>
              {days < 0 ? 'Submitted' : days === 0 ? 'Due Today!' : days === 1 ? 'Due Tomorrow' : `${days} days left`}
            </span>
          </div>

          {/* Team & Owner */}
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-1">
              {opportunity.team.slice(0, 3).map((role, i) => (
                <span key={i} className="w-6 h-6 rounded-full bg-slate-700 flex items-center justify-center text-xs text-slate-300 font-medium border border-slate-600">
                  {role.charAt(0)}
                </span>
              ))}
              {opportunity.team.length > 3 && (
                <span className="text-xs text-slate-500">+{opportunity.team.length - 3}</span>
              )}
            </div>
            <span className="text-xs text-slate-500">{opportunity.owner.split(' ')[0]}</span>
          </div>

          {/* Move to Next Phase Button */}
          {!isLastPhase && (
            <button
              onClick={() => onMoveNext(opportunity.id)}
              className="w-full mt-3 py-1.5 px-3 bg-cyan-500/10 hover:bg-cyan-500/20 border border-cyan-500/30 rounded-lg text-cyan-400 text-xs font-semibold flex items-center justify-center gap-1.5 opacity-0 group-hover:opacity-100 transition-all"
            >
              <span>Move to Next Phase</span>
              <Icon name="arrowRight" className="w-3.5 h-3.5" />
            </button>
          )}
        </div>
      );
    };

    // Phase Column Component
    const PhaseColumn = ({ phase, opportunities, onMoveNext, phaseIndex }) => {
      const phaseOpps = opportunities.filter(o => o.phase === phase.id);
      const totalValue = phaseOpps.reduce((sum, o) => {
        const numValue = parseFloat(o.value.replace(/[$M]/g, ''));
        return sum + numValue;
      }, 0);

      // Calculate phase progress based on average win probability
      const avgWinProb = phaseOpps.length > 0 
        ? Math.round(phaseOpps.reduce((sum, o) => sum + o.winProb, 0) / phaseOpps.length)
        : 0;

      return (
        <div className="flex-shrink-0 w-64 flex flex-col">
          {/* Column Header */}
          <div 
            className="rounded-t-xl p-3 border-b-2"
            style={{ 
              backgroundColor: `${phase.color}15`,
              borderColor: phase.color 
            }}
          >
            <div className="flex items-center justify-between mb-1">
              <div className="flex items-center gap-2">
                <span 
                  className="w-7 h-7 rounded-lg flex items-center justify-center text-xs font-bold"
                  style={{ backgroundColor: phase.color, color: phase.color === '#F8FAFC' ? '#0f172a' : '#fff' }}
                >
                  {phase.shortName}
                </span>
                <div>
                  <h3 className="font-semibold text-white text-sm">{phase.name}</h3>
                  <p className="text-xs text-slate-500">{phase.description}</p>
                </div>
              </div>
              <span className="text-lg font-bold text-white">{phaseOpps.length}</span>
            </div>

            {/* Progress indicator */}
            <div className="mt-2">
              <div className="flex items-center justify-between text-xs mb-1">
                <span className="text-slate-400">Phase Progress</span>
                <span style={{ color: phase.color }}>{avgWinProb}%</span>
              </div>
              <div className="h-1 bg-slate-700/50 rounded-full overflow-hidden">
                <div 
                  className="h-full rounded-full transition-all"
                  style={{ width: `${avgWinProb}%`, backgroundColor: phase.color }}
                />
              </div>
            </div>

            {/* Total pipeline value */}
            {phaseOpps.length > 0 && (
              <div className="mt-2 flex items-center gap-1 text-xs">
                <Icon name="dollar" className="w-3 h-3 text-emerald-400" />
                <span className="text-emerald-400 font-semibold">${totalValue}M</span>
                <span className="text-slate-500">pipeline</span>
              </div>
            )}
          </div>

          {/* Cards Container */}
          <div className="flex-1 bg-slate-900/30 border-x border-slate-700/30 p-2 overflow-y-auto scrollbar-thin min-h-[400px]">
            {phaseOpps.length === 0 ? (
              <div className="h-full flex items-center justify-center">
                <div className="text-center p-4">
                  <div 
                    className="w-10 h-10 rounded-full mx-auto mb-2 flex items-center justify-center opacity-30"
                    style={{ backgroundColor: `${phase.color}30` }}
                  >
                    <Icon name="target" className="w-5 h-5" style={{ color: phase.color }} />
                  </div>
                  <p className="text-xs text-slate-600">No opportunities</p>
                </div>
              </div>
            ) : (
              phaseOpps.map(opp => (
                <OpportunityCard 
                  key={opp.id} 
                  opportunity={opp} 
                  onMoveNext={onMoveNext}
                  phaseIndex={phaseIndex}
                />
              ))
            )}
          </div>

          {/* Column Footer */}
          <div className="bg-slate-800/50 border border-slate-700/30 border-t-0 rounded-b-xl p-2">
            <button className="w-full py-1.5 text-xs text-slate-500 hover:text-cyan-400 hover:bg-slate-700/30 rounded-lg transition-all">
              + Add Opportunity
            </button>
          </div>
        </div>
      );
    };

    // Main Swimlane Board Component
    const ShipleySwimLaneBoard = () => {
      const [opportunities, setOpportunities] = useState(DEMO_OPPORTUNITIES);
      const [filter, setFilter] = useState('all');
      const scrollRef = useRef(null);

      // Move opportunity to next phase
      const handleMoveNext = (oppId) => {
        setOpportunities(prev => prev.map(opp => {
          if (opp.id === oppId) {
            const currentIndex = SHIPLEY_PHASES.findIndex(p => p.id === opp.phase);
            if (currentIndex < SHIPLEY_PHASES.length - 1) {
              return { ...opp, phase: SHIPLEY_PHASES[currentIndex + 1].id };
            }
          }
          return opp;
        }));
      };

      // Filter opportunities
      const filteredOpportunities = filter === 'all' 
        ? opportunities 
        : opportunities.filter(o => o.priority === filter);

      // Stats
      const totalPipeline = opportunities.reduce((sum, o) => {
        const numValue = parseFloat(o.value.replace(/[$M]/g, ''));
        return sum + numValue;
      }, 0);

      const urgentCount = opportunities.filter(o => getDaysUntil(o.dueDate) <= 3 && getDaysUntil(o.dueDate) >= 0).length;

      return (
        <div className="min-h-screen bg-[#00050F]">
          {/* Collapsible Sidebar */}
          <Sidebar currentModule="m3" />
          
          {/* Main Content */}
          <div className="ml-64 transition-all duration-300">
            {/* Header */}
            <header className="bg-slate-900/80 border-b border-slate-700/50 px-6 py-4">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-cyan-500 to-teal-500 flex items-center justify-center">
                    <Icon name="kanban" className="w-6 h-6 text-white" />
                  </div>
                  <div>
                    <h1 className="text-xl font-bold text-white">Shipley Pipeline Board</h1>
                    <p className="text-sm text-slate-400">8 phases • {opportunities.length} opportunities • ${totalPipeline}M total pipeline</p>
                  </div>
                </div>

                {/* Quick Stats */}
                <div className="flex items-center gap-4">
                  {urgentCount > 0 && (
                    <div className="flex items-center gap-2 px-3 py-1.5 bg-red-500/20 border border-red-500/30 rounded-lg">
                      <Icon name="alert" className="w-4 h-4 text-red-400" />
                      <span className="text-red-400 text-sm font-semibold">{urgentCount} urgent</span>
                    </div>
                  )}
                  <div className="flex items-center gap-2 bg-slate-800 rounded-lg p-1">
                    {['all', 'P-0', 'P-1', 'P-2'].map(f => (
                      <button
                        key={f}
                      onClick={() => setFilter(f)}
                      className={`px-3 py-1.5 rounded-md text-xs font-semibold transition-all ${
                        filter === f 
                          ? 'bg-cyan-500 text-white' 
                          : 'text-slate-400 hover:text-white hover:bg-slate-700'
                      }`}
                    >
                      {f === 'all' ? 'All' : f}
                    </button>
                  ))}
                </div>
              </div>
            </div>
          </header>

          {/* Phase Legend */}
          <div className="bg-slate-800/30 border-b border-slate-700/30 px-6 py-3">
            <div className="flex items-center gap-2 overflow-x-auto scrollbar-thin">
              <span className="text-xs text-slate-500 mr-2">Phases:</span>
              {SHIPLEY_PHASES.map((phase, i) => (
                <React.Fragment key={phase.id}>
                  <div className="flex items-center gap-1.5 px-2 py-1 rounded-lg bg-slate-800/50">
                    <div 
                      className="w-2 h-2 rounded-full"
                      style={{ backgroundColor: phase.color }}
                    />
                    <span className="text-xs text-slate-300 whitespace-nowrap">{phase.name}</span>
                  </div>
                  {i < SHIPLEY_PHASES.length - 1 && (
                    <Icon name="chevronRight" className="w-3 h-3 text-slate-600 flex-shrink-0" />
                  )}
                </React.Fragment>
              ))}
            </div>
          </div>

          {/* Swimlane Board */}
          <div 
            ref={scrollRef}
            className="flex gap-4 p-6 overflow-x-auto scrollbar-thin"
            style={{ minHeight: 'calc(100vh - 160px)' }}
          >
            {SHIPLEY_PHASES.map((phase, index) => (
              <PhaseColumn
                key={phase.id}
                phase={phase}
                opportunities={filteredOpportunities}
                onMoveNext={handleMoveNext}
                phaseIndex={index}
              />
            ))}
          </div>

          {/* Footer */}
          <footer className="fixed bottom-0 left-64 right-0 bg-slate-900/95 border-t border-slate-700/50 px-6 py-2 transition-all duration-300">
            <div className="flex items-center justify-between">
              <span className="text-xs text-slate-500">MissionPulse • Shipley Phase Board v12</span>
              <span className="text-xs text-slate-600">AI GENERATED - REQUIRES HUMAN REVIEW</span>
            </div>
          </footer>
          </div>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<ShipleySwimLaneBoard />);
  </script>
</body>
</html>
