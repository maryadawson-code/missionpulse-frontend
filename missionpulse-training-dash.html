<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse S136 - Training Dashboard</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Space Grotesk',sans-serif;background:#00050F;min-height:100vh}.font-mono{font-family:'JetBrains Mono',monospace}@keyframes slideIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}@keyframes barFill{from{width:0%}}.animate-slide-in{animation:slideIn .4s ease-out forwards}.animate-pulse{animation:pulse 2s ease-in-out infinite}.animate-bar{animation:barFill .8s ease-out forwards}.glass-card{background:linear-gradient(135deg,rgba(15,23,42,.9) 0%,rgba(15,23,42,.7) 100%);backdrop-filter:blur(10px);border:1px solid rgba(0,229,250,.15)}.glass-card:hover{border-color:rgba(0,229,250,.3)}
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const{useState,useEffect}=React;
    const SUPABASE_URL='https://qdrtpnpnhkxvfmvfziop.supabase.co';
    const SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc4MjMwMTgsImV4cCI6MjA1MzM5OTAxOH0.gFHBoGjPMWjCGuJNdxMGPOBmGMHBp0jSTbxxcFKqkPQ';
    var sbClient;try{sbClient=supabase.createClient(SUPABASE_URL,SUPABASE_KEY)}catch(e){sbClient=null}

    const Icons={
      academic:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 14l9-5-9-5-9 5 9 5z"/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"/></svg>,
      check:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7"/></svg>,
      shield:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>,
      clock:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" strokeWidth={2}/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6l4 2"/></svg>,
      alert:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>,
      users:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/></svg>,
    };
    const Icon=({name,className="w-4 h-4"})=>{const C=Icons[name];return C?<span className={`inline-block ${className}`}><C/></span>:null};

    const TEAM=[
      {id:1,name:'Sarah Chen',role:'SA Lead',certifications:[{name:'AWS Solutions Architect Pro',status:'current',expires:'2027-03'},{name:'CompTIA Security+',status:'current',expires:'2026-11'},{name:'Shipley Capture Management',status:'current',expires:null}],compliance:[{name:'CUI Awareness',status:'complete',due:'2026-06'},{name:'Insider Threat',status:'complete',due:'2026-04'},{name:'Cyber Awareness FY26',status:'complete',due:'2026-09'}],shipley:[{course:'BD-100 Business Development',progress:100},{course:'CM-200 Capture Management',progress:100},{course:'PM-300 Proposal Management',progress:75}]},
      {id:2,name:'James Rivera',role:'PM Lead',certifications:[{name:'PMP',status:'current',expires:'2027-06'},{name:'SAFe Agilist',status:'current',expires:'2026-08'},{name:'ITIL v4 Foundation',status:'expiring',expires:'2026-04'}],compliance:[{name:'CUI Awareness',status:'complete',due:'2026-06'},{name:'Insider Threat',status:'overdue',due:'2026-01'},{name:'Cyber Awareness FY26',status:'complete',due:'2026-09'}],shipley:[{course:'BD-100 Business Development',progress:100},{course:'PM-300 Proposal Management',progress:100},{course:'OE-400 Orals Excellence',progress:50}]},
      {id:3,name:'Diana Kim',role:'CAP Manager',certifications:[{name:'Shipley Certified Capture Manager',status:'current',expires:null},{name:'PMP',status:'current',expires:'2028-01'}],compliance:[{name:'CUI Awareness',status:'complete',due:'2026-06'},{name:'Insider Threat',status:'complete',due:'2026-04'},{name:'Cyber Awareness FY26',status:'complete',due:'2026-09'}],shipley:[{course:'BD-100 Business Development',progress:100},{course:'CM-200 Capture Management',progress:100},{course:'PM-300 Proposal Management',progress:100},{course:'OE-400 Orals Excellence',progress:100}]},
      {id:4,name:'Marcus Johnson',role:'Pricing Lead',certifications:[{name:'CPA',status:'current',expires:null},{name:'CDFM',status:'current',expires:'2027-12'}],compliance:[{name:'CUI Awareness',status:'complete',due:'2026-06'},{name:'Insider Threat',status:'complete',due:'2026-04'},{name:'Cyber Awareness FY26',status:'in_progress',due:'2026-09'}],shipley:[{course:'BD-100 Business Development',progress:100},{course:'PR-250 Pricing to Win',progress:80}]},
      {id:5,name:'Emily Zhao',role:'Compliance Lead',certifications:[{name:'CISSP',status:'current',expires:'2027-09'},{name:'CISM',status:'current',expires:'2027-03'},{name:'CompTIA Security+',status:'current',expires:'2027-05'}],compliance:[{name:'CUI Awareness',status:'complete',due:'2026-06'},{name:'Insider Threat',status:'complete',due:'2026-04'},{name:'Cyber Awareness FY26',status:'complete',due:'2026-09'}],shipley:[{course:'BD-100 Business Development',progress:60}]},
    ];

    const ConnectionIndicator=({connected})=>(
      <div className="flex items-center gap-2 px-3 py-1 rounded-full text-xs font-mono" style={{background:connected?'rgba(0,255,136,0.1)':'rgba(255,184,0,0.1)',border:`1px solid ${connected?'rgba(0,255,136,0.3)':'rgba(255,184,0,0.3)'}`}}>
        <div className={`w-2 h-2 rounded-full ${connected?'bg-green-400':'bg-amber-400 animate-pulse'}`}/>
        <span style={{color:connected?'#00ff88':'#ffb800'}}>{connected?'LIVE':'DEMO'}</span>
      </div>
    );

    const App=()=>{
      const[connected,setConnected]=useState(false);
      const[userRole]=useState('CEO');
      const[activeTab,setActiveTab]=useState('certs');
      const[expandedPerson,setExpandedPerson]=useState(null);

      useEffect(()=>{const a=['CEO','COO','PM','Admin'];if(!a.includes(userRole))return},[userRole]);
      useEffect(()=>{if(!sbClient)return;(async()=>{try{const{data}=await sbClient.from('opportunities').select('id').limit(1);if(data)setConnected(true)}catch(e){}})()},[]);

      const totalCerts=TEAM.reduce((s,t)=>s+t.certifications.length,0);
      const currentCerts=TEAM.reduce((s,t)=>s+t.certifications.filter(c=>c.status==='current').length,0);
      const overdue=TEAM.reduce((s,t)=>s+t.compliance.filter(c=>c.status==='overdue').length,0);
      const avgShipley=Math.round(TEAM.reduce((s,t)=>s+t.shipley.reduce((a,c)=>a+c.progress,0)/t.shipley.length,0)/TEAM.length);

      const StatusDot=({status})=>{
        const c={current:'#00ff88',complete:'#00ff88',expiring:'#ffb800',in_progress:'#00E5FA',overdue:'#ff4444'};
        return <div className="w-2 h-2 rounded-full shrink-0" style={{background:c[status]||'#64748b'}}/>;
      };

      const tabs=[{key:'certs',label:'Certifications'},{key:'compliance',label:'Compliance Training'},{key:'shipley',label:'Shipley Courses'}];

      return(
        <div className="min-h-screen" style={{background:'#00050F'}}>
          <div className="max-w-7xl mx-auto p-6">
            <div className="flex items-center justify-between mb-6">
              <div><div className="flex items-center gap-3 mb-1"><h1 className="text-2xl font-bold text-white">Training Dashboard</h1><ConnectionIndicator connected={connected}/></div>
              <p className="text-sm text-slate-400">Team certifications, compliance training & Shipley course progress</p></div>
            </div>

            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
              {[{label:'Total Certs',value:totalCerts,color:'#00E5FA'},{label:'Current',value:currentCerts,color:'#00ff88'},{label:'Overdue Training',value:overdue,color:'#ff4444'},{label:'Avg Shipley',value:`${avgShipley}%`,color:'#a78bfa'}].map((k,i)=>(
                <div key={i} className="glass-card rounded-xl p-4 animate-slide-in" style={{animationDelay:`${i*.05}s`}}>
                  <span className="text-xs text-slate-500 font-mono uppercase">{k.label}</span>
                  <div className="text-2xl font-mono font-bold mt-1" style={{color:k.color}}>{k.value}</div>
                </div>
              ))}
            </div>

            <div className="flex items-center gap-1 bg-slate-800/30 rounded-lg p-1 mb-6">
              {tabs.map(t=><button key={t.key} onClick={()=>setActiveTab(t.key)} className={`px-4 py-2 rounded-md text-sm font-mono font-bold transition flex-1 ${activeTab===t.key?'bg-cyan-500/20 text-cyan-400':'text-slate-500 hover:text-slate-300'}`}>{t.label}</button>)}
            </div>

            {/* Certifications */}
            {activeTab==='certs'&&(
              <div className="space-y-3 animate-slide-in">
                {TEAM.map((person,i)=>(
                  <div key={person.id} className="glass-card rounded-xl p-5 animate-slide-in" style={{animationDelay:`${i*.06}s`}}>
                    <div className="flex items-center justify-between mb-3">
                      <div className="flex items-center gap-3"><Icon name="users" className="w-5 h-5 text-cyan-400"/><span className="text-white font-semibold">{person.name}</span><span className="text-xs text-slate-500">{person.role}</span></div>
                      <span className="text-xs font-mono text-slate-400">{person.certifications.length} certs</span>
                    </div>
                    <div className="flex flex-wrap gap-2">
                      {person.certifications.map((c,j)=>(
                        <div key={j} className="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-slate-800/30 border border-slate-700/20">
                          <StatusDot status={c.status}/>
                          <span className="text-xs text-slate-300">{c.name}</span>
                          {c.expires&&<span className="text-xs font-mono text-slate-500">exp {c.expires}</span>}
                        </div>
                      ))}
                    </div>
                  </div>
                ))}
              </div>
            )}

            {/* Compliance */}
            {activeTab==='compliance'&&(
              <div className="glass-card rounded-xl overflow-hidden animate-slide-in">
                <div className="grid grid-cols-5 gap-2 px-5 py-3 border-b border-slate-700/30 text-xs font-mono text-slate-500 uppercase">
                  <span>Person</span><span>Training</span><span>Status</span><span>Due Date</span><span></span>
                </div>
                {TEAM.flatMap(p=>p.compliance.map((c,i)=>({...c,person:p.name,pid:p.id,idx:i}))).map((row,i)=>(
                  <div key={`${row.pid}-${row.idx}`} className="grid grid-cols-5 gap-2 items-center px-5 py-3 border-b border-slate-700/10 hover:bg-slate-800/20 transition">
                    <span className="text-sm text-white">{row.person}</span>
                    <span className="text-sm text-slate-300">{row.name}</span>
                    <span className="flex items-center gap-1.5"><StatusDot status={row.status}/><span className="text-xs font-mono capitalize" style={{color:row.status==='complete'?'#00ff88':row.status==='overdue'?'#ff4444':'#00E5FA'}}>{row.status.replace('_',' ')}</span></span>
                    <span className="text-xs font-mono text-slate-500">{row.due}</span>
                    <span>{row.status==='overdue'&&<span className="px-2 py-0.5 rounded text-xs font-mono font-bold bg-red-500/10 text-red-400">ACTION NEEDED</span>}</span>
                  </div>
                ))}
              </div>
            )}

            {/* Shipley */}
            {activeTab==='shipley'&&(
              <div className="space-y-3 animate-slide-in">
                {TEAM.map((person,i)=>(
                  <div key={person.id} className="glass-card rounded-xl p-5 animate-slide-in" style={{animationDelay:`${i*.06}s`}}>
                    <div className="flex items-center gap-3 mb-4"><Icon name="academic" className="w-5 h-5 text-purple-400"/><span className="text-white font-semibold">{person.name}</span><span className="text-xs text-slate-500">{person.role}</span></div>
                    <div className="space-y-3">
                      {person.shipley.map((c,j)=>(
                        <div key={j}>
                          <div className="flex justify-between mb-1"><span className="text-xs text-slate-400">{c.course}</span><span className="text-xs font-mono" style={{color:c.progress===100?'#00ff88':c.progress>=50?'#00E5FA':'#ffb800'}}>{c.progress}%</span></div>
                          <div className="h-2 rounded-full bg-slate-700/30 overflow-hidden"><div className="h-full rounded-full animate-bar" style={{width:`${c.progress}%`,background:c.progress===100?'#00ff88':c.progress>=50?'#00E5FA':'#ffb800'}}/></div>
                        </div>
                      ))}
                    </div>
                  </div>
                ))}
              </div>
            )}

            <div className="mt-8 text-center"><div className="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-amber-500/5 border border-amber-500/20"><Icon name="shield" className="w-3.5 h-3.5 text-amber-500"/><span className="text-xs text-amber-500/80 font-mono">AI GENERATED â€” REQUIRES HUMAN REVIEW</span></div></div>
          </div>
        </div>
      );
    };
    ReactDOM.render(<App/>,document.getElementById('root'));
  </script>
</body>
</html>
