<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MissionPulse ‚Äî Win Themes Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap');
        :root { --primary: #00E5FA; --bg-deep: #00050F; --bg-card: #0A1628; --bg-surface: #111D35; --border: #1E3A5F; --text-primary: #E8F0FE; --text-muted: #8BA3C7; --success: #10B981; --warning: #F59E0B; --danger: #EF4444; --accent-purple: #8B5CF6; }
        body { font-family: 'Inter', sans-serif; background: var(--bg-deep); color: var(--text-primary); }
        h1, h2, h3, h4, .font-display { font-family: 'Space Grotesk', sans-serif; }
        .card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; }
        .glow-line { height: 2px; background: linear-gradient(90deg, transparent, var(--primary), transparent); }
        .badge { padding: 2px 10px; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; }
        .badge-green { background: rgba(16,185,129,0.15); color: #10B981; }
        .badge-gold { background: rgba(245,158,11,0.15); color: #F59E0B; }
        .badge-red { background: rgba(239,68,68,0.15); color: #EF4444; }
        .badge-blue { background: rgba(0,229,250,0.15); color: #00E5FA; }
        .badge-purple { background: rgba(139,92,246,0.15); color: #8B5CF6; }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; }
        .btn-primary { background: linear-gradient(135deg, #00E5FA, #0099AA); color: #00050F; font-weight: 600; padding: 8px 20px; border-radius: 8px; border: none; cursor: pointer; transition: all 0.2s; }
        .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 20px rgba(0,229,250,0.3); }
        .strength-bar { height: 8px; border-radius: 4px; background: rgba(255,255,255,0.06); overflow: hidden; }
        .strength-fill { height: 100%; border-radius: 4px; transition: width 0.6s ease; }
        .ghost-card { border-left: 3px solid #8B5CF6; }
        .theme-card { transition: all 0.2s; cursor: pointer; }
        .theme-card:hover { border-color: var(--primary); transform: translateY(-2px); }
    </style>
</head>
<body class="min-h-screen">
    <!-- Connection Indicator -->
    <div id="connStatus" class="fixed top-3 right-3 z-50 flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium" style="background:var(--bg-card);border:1px solid var(--border);">
        <span id="connDot" class="status-dot" style="background:#F59E0B;"></span>
        <span id="connText">Connecting...</span>
    </div>

    <div class="max-w-7xl mx-auto px-6 py-8">
        <!-- Header -->
        <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background:linear-gradient(135deg,#10B981,#059669);">
                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
                </div>
                <div>
                    <h1 class="font-display text-2xl font-bold" style="color:var(--text-primary);">Win Themes Manager</h1>
                    <p class="text-sm" style="color:var(--text-muted);">Discriminators ¬∑ Strength/Weakness Mapping ¬∑ Ghost Strategies</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <select id="oppFilter" class="text-sm px-3 py-2 rounded-lg" style="background:var(--bg-card);border:1px solid var(--border);color:var(--text-primary);" onchange="filterByOpp()">
                    <option value="all">All Opportunities</option>
                    <option value="dha-ehr">DHA EHR Modernization</option>
                    <option value="va-claims">VA Claims Processing</option>
                    <option value="cms-analytics">CMS Data Analytics</option>
                </select>
                <button class="btn-primary" onclick="addTheme()">+ Add Theme</button>
            </div>
        </div>
        <div class="glow-line mb-6"></div>

        <!-- Win Theme Coverage -->
        <div class="card p-5 mb-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="font-display font-semibold">Win Theme Coverage by Eval Factor</h3>
                <span class="badge badge-green">78% Overall Coverage</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4" id="coverageGrid">
                <div>
                    <div class="flex justify-between text-sm mb-1"><span>Technical Approach</span><span style="color:var(--success);">92%</span></div>
                    <div class="strength-bar"><div class="strength-fill" style="width:92%;background:var(--success);"></div></div>
                </div>
                <div>
                    <div class="flex justify-between text-sm mb-1"><span>Management</span><span style="color:var(--success);">85%</span></div>
                    <div class="strength-bar"><div class="strength-fill" style="width:85%;background:var(--success);"></div></div>
                </div>
                <div>
                    <div class="flex justify-between text-sm mb-1"><span>Past Performance</span><span style="color:var(--warning);">68%</span></div>
                    <div class="strength-bar"><div class="strength-fill" style="width:68%;background:var(--warning);"></div></div>
                </div>
                <div>
                    <div class="flex justify-between text-sm mb-1"><span>Price</span><span style="color:var(--warning);">55%</span></div>
                    <div class="strength-bar"><div class="strength-fill" style="width:55%;background:var(--warning);"></div></div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="flex gap-1 mb-6 p-1 rounded-lg" style="background:var(--bg-card);border:1px solid var(--border);width:fit-content;">
            <button class="tab-btn px-4 py-2 rounded-md text-sm font-medium" data-tab="themes" onclick="switchTab('themes')" style="background:var(--primary);color:var(--bg-deep);">Win Themes</button>
            <button class="tab-btn px-4 py-2 rounded-md text-sm font-medium" data-tab="swot" onclick="switchTab('swot')" style="color:var(--text-muted);">Strength/Weakness</button>
            <button class="tab-btn px-4 py-2 rounded-md text-sm font-medium" data-tab="ghosts" onclick="switchTab('ghosts')" style="color:var(--text-muted);">Ghost Strategies</button>
        </div>

        <!-- Win Themes Tab -->
        <div id="tab-themes">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="themesGrid"></div>
        </div>

        <!-- SWOT Tab -->
        <div id="tab-swot" class="hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="card p-5">
                    <h3 class="font-display font-semibold mb-4" style="color:#10B981;">üí™ Strengths (Discriminators)</h3>
                    <div class="space-y-3" id="strengthsList"></div>
                </div>
                <div class="card p-5">
                    <h3 class="font-display font-semibold mb-4" style="color:#EF4444;">‚ö†Ô∏è Weaknesses (Mitigations Needed)</h3>
                    <div class="space-y-3" id="weaknessesList"></div>
                </div>
                <div class="card p-5">
                    <h3 class="font-display font-semibold mb-4" style="color:#00E5FA;">üéØ Opportunities</h3>
                    <div class="space-y-3" id="oppsList"></div>
                </div>
                <div class="card p-5">
                    <h3 class="font-display font-semibold mb-4" style="color:#F59E0B;">üî• Threats (Competitor Advantages)</h3>
                    <div class="space-y-3" id="threatsList"></div>
                </div>
            </div>
        </div>

        <!-- Ghost Strategies Tab -->
        <div id="tab-ghosts" class="hidden">
            <div class="space-y-4" id="ghostsGrid"></div>
        </div>
    </div>

    <!-- AI Disclaimer Footer -->
    <div class="mt-12 py-4 text-center text-xs" style="color:var(--text-muted);border-top:1px solid var(--border);">
        ‚ö†Ô∏è AI GENERATED ‚Äî REQUIRES HUMAN REVIEW ¬∑ MissionPulse ¬© 2026 Mission Meets Tech
    </div>

    <script>
        // ‚îÄ‚îÄ‚îÄ Supabase Init ‚îÄ‚îÄ‚îÄ
        const SUPABASE_URL = 'https://qdrtpnpnhkxvfmvfziop.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc1NzUxMjAsImV4cCI6MjA1MzE1MTEyMH0.xM8BE2jRLxfWNwFGDcKmFHfNgBOt0U4bMfUKb3Gn5xg';
        var sbClient;
        try { sbClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY); } catch(e) {}

        let currentUser = null;
        async function checkAuth() {
            try {
                const { data } = await sbClient.auth.getUser();
                if (data?.user) { currentUser = data.user; setConnected(); return; }
            } catch(e) {}
            setDemoMode();
        }
        function setConnected() { document.getElementById('connDot').style.background = '#10B981'; document.getElementById('connText').textContent = 'Connected'; }
        function setDemoMode() { document.getElementById('connDot').style.background = '#F59E0B'; document.getElementById('connText').textContent = 'Demo Mode'; }

        // ‚îÄ‚îÄ‚îÄ Demo Data ‚îÄ‚îÄ‚îÄ
        const demoThemes = [
            { id: 'WT-001', name: 'Mission-First AI Integration', desc: 'Leverage AskSage FedRAMP-authorized AI to accelerate clinical decision support while maintaining CUI protection.', evalFactor: 'Technical Approach', strength: 95, sections: ['Tech Vol 2.1', 'Tech Vol 3.3', 'Exec Sum'], status: 'Active', opp: 'dha-ehr' },
            { id: 'WT-002', name: 'Proven DHA Transition Expertise', desc: '15+ years of MHS GENESIS deployment experience with zero data loss across 3 MTFs.', evalFactor: 'Past Performance', strength: 88, sections: ['Past Perf 1.1', 'Mgmt Vol 4.2'], status: 'Active', opp: 'dha-ehr' },
            { id: 'WT-003', name: 'Agile-at-Scale Delivery Model', desc: 'SAFe-certified team delivering 98% sprint velocity with automated CI/CD pipelines.', evalFactor: 'Management', strength: 82, sections: ['Mgmt Vol 2.1', 'Mgmt Vol 5.3'], status: 'Active', opp: 'dha-ehr' },
            { id: 'WT-004', name: 'Cost-Competitive Blended Rate', desc: 'SDVOSB prime with strategic WOSB sub delivers 12% below independent government estimate.', evalFactor: 'Price', strength: 72, sections: ['Price Vol 1.1'], status: 'Draft', opp: 'va-claims' },
            { id: 'WT-005', name: 'Zero-Trust Security Posture', desc: 'CMMC Level 2 certified with continuous ATO monitoring via MissionPulse compliance engine.', evalFactor: 'Technical Approach', strength: 90, sections: ['Tech Vol 6.1', 'Tech Vol 6.2'], status: 'Active', opp: 'cms-analytics' },
            { id: 'WT-006', name: 'Veteran Workforce Pipeline', desc: 'SkillBridge partnership produces cleared candidates with 30-day onboarding vs. 90-day industry average.', evalFactor: 'Management', strength: 78, sections: ['Mgmt Vol 3.1', 'Staffing Plan'], status: 'Draft', opp: 'va-claims' }
        ];

        const demoStrengths = [
            { item: 'FedRAMP High AI capability (AskSage)', impact: 'high' },
            { item: '15+ years DHA/MHS GENESIS experience', impact: 'high' },
            { item: 'CMMC Level 2 pre-certified', impact: 'medium' },
            { item: 'SDVOSB prime with SB goal compliance', impact: 'medium' },
            { item: 'Automated CI/CD with 98% sprint velocity', impact: 'high' }
        ];
        const demoWeaknesses = [
            { item: 'No direct VA claims processing past performance', impact: 'high', mitigation: 'Sub Accenture Federal for claims domain expertise' },
            { item: 'Team size limits surge capacity', impact: 'medium', mitigation: 'Pre-negotiated bench agreements with 3 staffing partners' },
            { item: 'Limited CMS analytics references', impact: 'medium', mitigation: 'Leverage DHA analytics work as adjacent proof' }
        ];
        const demoOpps = [
            { item: 'Incumbent contract expiring ‚Äî customer dissatisfied', impact: 'high' },
            { item: 'New DHA CIO priorities align with our AI approach', impact: 'high' },
            { item: 'SDVOSB set-aside eliminates large prime competition', impact: 'medium' }
        ];
        const demoThreats = [
            { item: 'Booz Allen Hamilton has 2x our past performance volume', impact: 'high' },
            { item: 'Leidos can undercut on price with offshore labor', impact: 'medium' },
            { item: 'Incumbent relationship advantage (3-year tenure)', impact: 'high' }
        ];

        const demoGhosts = [
            { competitor: 'Booz Allen Hamilton', strategy: 'Highlight that our AI approach uses FedRAMP-authorized tools while BAH relies on custom models lacking ATO. Emphasize that scale without authorization creates compliance risk for the government.', theme: 'Security over Scale', sections: ['Tech Vol 2.1', 'Exec Sum'] },
            { competitor: 'Leidos', strategy: 'Ghost offshore labor model by emphasizing our 100% CONUS cleared workforce and faster incident response times. Position offshore as a risk to CUI data sovereignty.', theme: 'Data Sovereignty', sections: ['Mgmt Vol 3.1', 'Staffing Plan'] },
            { competitor: 'Incumbent (GDIT)', strategy: 'Acknowledge transition risk transparently, then present our zero-downtime migration playbook with Phase 0 parallel operations. Turn their tenure into "legacy lock-in" by contrasting with our modern cloud-native architecture.', theme: 'Modernization vs. Legacy', sections: ['Tech Vol 1.1', 'Transition Plan'] }
        ];

        // ‚îÄ‚îÄ‚îÄ Render ‚îÄ‚îÄ‚îÄ
        function renderThemes() {
            document.getElementById('themesGrid').innerHTML = demoThemes.map(t => `
                <div class="card theme-card p-5">
                    <div class="flex items-center justify-between mb-2">
                        <span class="badge ${t.status === 'Active' ? 'badge-green' : 'badge-gold'}">${t.status}</span>
                        <span class="text-xs font-mono" style="color:var(--text-muted);">${t.id}</span>
                    </div>
                    <h4 class="font-display font-semibold text-lg mb-1">${t.name}</h4>
                    <p class="text-sm mb-3" style="color:var(--text-muted);">${t.desc}</p>
                    <div class="flex items-center justify-between text-xs mb-2">
                        <span class="badge badge-blue">${t.evalFactor}</span>
                        <span style="color:${t.strength >= 80 ? 'var(--success)' : 'var(--warning)'};">Strength: ${t.strength}%</span>
                    </div>
                    <div class="strength-bar mb-3">
                        <div class="strength-fill" style="width:${t.strength}%;background:${t.strength >= 80 ? 'var(--success)' : 'var(--warning)'};"></div>
                    </div>
                    <div class="flex flex-wrap gap-1">
                        ${t.sections.map(s => `<span class="text-xs px-2 py-0.5 rounded" style="background:var(--bg-surface);color:var(--text-muted);">${s}</span>`).join('')}
                    </div>
                </div>
            `).join('');
        }

        function renderSWOT() {
            document.getElementById('strengthsList').innerHTML = demoStrengths.map(s => `
                <div class="flex items-start gap-2 p-2 rounded" style="background:rgba(16,185,129,0.06);">
                    <span class="badge badge-green mt-0.5">${s.impact}</span>
                    <span class="text-sm">${s.item}</span>
                </div>
            `).join('');

            document.getElementById('weaknessesList').innerHTML = demoWeaknesses.map(w => `
                <div class="p-2 rounded" style="background:rgba(239,68,68,0.06);">
                    <div class="flex items-start gap-2 mb-1">
                        <span class="badge badge-red mt-0.5">${w.impact}</span>
                        <span class="text-sm">${w.item}</span>
                    </div>
                    <div class="text-xs ml-14" style="color:var(--success);">Mitigation: ${w.mitigation}</div>
                </div>
            `).join('');

            document.getElementById('oppsList').innerHTML = demoOpps.map(o => `
                <div class="flex items-start gap-2 p-2 rounded" style="background:rgba(0,229,250,0.06);">
                    <span class="badge badge-blue mt-0.5">${o.impact}</span>
                    <span class="text-sm">${o.item}</span>
                </div>
            `).join('');

            document.getElementById('threatsList').innerHTML = demoThreats.map(t => `
                <div class="flex items-start gap-2 p-2 rounded" style="background:rgba(245,158,11,0.06);">
                    <span class="badge badge-gold mt-0.5">${t.impact}</span>
                    <span class="text-sm">${t.item}</span>
                </div>
            `).join('');
        }

        function renderGhosts() {
            document.getElementById('ghostsGrid').innerHTML = demoGhosts.map(g => `
                <div class="card ghost-card p-5">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-display font-semibold">üëª Ghost: ${g.competitor}</h4>
                        <span class="badge badge-purple">${g.theme}</span>
                    </div>
                    <p class="text-sm mb-3" style="color:var(--text-muted);">${g.strategy}</p>
                    <div class="flex flex-wrap gap-1">
                        <span class="text-xs" style="color:var(--text-muted);">Apply in:</span>
                        ${g.sections.map(s => `<span class="text-xs px-2 py-0.5 rounded" style="background:var(--bg-surface);color:var(--primary);">${s}</span>`).join('')}
                    </div>
                </div>
            `).join('');
        }

        function switchTab(tab) {
            document.querySelectorAll('[id^="tab-"]').forEach(el => el.classList.add('hidden'));
            document.getElementById('tab-' + tab).classList.remove('hidden');
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.dataset.tab === tab) { btn.style.background = 'var(--primary)'; btn.style.color = 'var(--bg-deep)'; }
                else { btn.style.background = 'transparent'; btn.style.color = 'var(--text-muted)'; }
            });
        }

        function filterByOpp() { /* filter logic for live data */ }
        function addTheme() { alert('Add Win Theme ‚Äî coming in next sprint (Supabase write integration)'); }

        // ‚îÄ‚îÄ‚îÄ Init ‚îÄ‚îÄ‚îÄ
        checkAuth();
        renderThemes();
        renderSWOT();
        renderGhosts();
    </script>
</body>
</html>
