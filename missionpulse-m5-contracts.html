<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse M5 - Contracts Scanner</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- API Client for AI Agents -->
  <script src="render-api-client.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', sans-serif; background: #00050F; min-height: 100vh; overflow-x: hidden; }
    .font-mono { font-family: 'JetBrains Mono', monospace; }
    
    /* Animations */
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    @keyframes ping { 75%, 100% { transform: scale(2); opacity: 0; } }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes scanLine { 0% { top: 0; } 100% { top: 100%; } }
    @keyframes riskPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); } 50% { box-shadow: 0 0 20px 4px rgba(239, 68, 68, 0.2); } }
    @keyframes countUp { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
    
    .animate-pulse { animation: pulse 2s ease-in-out infinite; }
    .animate-ping { animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite; }
    .animate-spin { animation: spin 1s linear infinite; }
    .animate-slideIn { animation: slideIn 0.5s ease-out; }
    .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
    .animate-scanLine { animation: scanLine 2s linear infinite; }
    .animate-riskPulse { animation: riskPulse 2s ease-in-out infinite; }
    .animate-countUp { animation: countUp 0.4s ease-out forwards; }
    
    /* Scan effect */
    .scan-container { position: relative; overflow: hidden; }
    .scan-line { position: absolute; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, #00E5FA, transparent); opacity: 0.6; }
    
    /* Risk glow effects */
    .risk-high { border-left-color: #EF4444; }
    .risk-medium { border-left-color: #F59E0B; }
    .risk-low { border-left-color: #10B981; }
    .risk-info { border-left-color: #3B82F6; }
    
    /* Glass morphism */
    .glass { background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(20px); border: 1px solid rgba(100, 116, 139, 0.2); }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #0F172A; }
    ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #475569; }
    
    /* Cash flow chart */
    .cash-bar { transition: width 0.5s ease-out; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // ========== DESIGN TOKENS ==========
    const COLORS = {
      bg: '#00050F',
      surface: '#0F172A',
      panel: '#1E293B',
      border: '#334155',
      muted: '#64748B',
      text: '#F8FAFC',
      cyan: '#00E5FA',
      danger: '#EF4444',
      warning: '#F59E0B',
      success: '#10B981',
      info: '#3B82F6',
      purple: '#A855F7',
      pink: '#EC4899',
    };

    // ========== FAR/DFARS CLAUSE DATA ==========
    const SECTION_I_CLAUSES = [
      {
        clause: '52.227-14',
        title: 'Rights in Dataâ€”General',
        category: 'IP Rights',
        risk: 'HIGH',
        impact: 'IP Transfer',
        cashFlowImpact: -15,
        summary: 'Government receives unlimited rights to all data developed under contract.',
        plainLanguage: 'The government can use, modify, and distribute any work product you createâ€”without paying you extra or asking permission.',
        recommendation: 'Negotiate for Limited Rights or SBIR data rights. Request Alternate II for copyrighted works.',
        farRef: 'FAR 27.404-2',
      },
      {
        clause: 'H.4.2',
        title: 'Payment Terms - Net 60',
        category: 'Cash Flow',
        risk: 'HIGH',
        impact: 'Cash Flow',
        cashFlowImpact: -25,
        summary: 'Payment due 60 days after invoice acceptance. Extended from standard Net-30.',
        plainLanguage: 'You won\'t get paid until 2 months after invoicing. That\'s a month longer than usualâ€”plan your cash accordingly.',
        recommendation: 'Counter with Net-30 per FAR 32.906. Propose milestone-based payments for large deliverables.',
        farRef: 'FAR 32.905',
      },
      {
        clause: '252.204-7012',
        title: 'Safeguarding CDI and Cyber Incident Reporting',
        category: 'Cybersecurity',
        risk: 'MEDIUM',
        impact: 'Compliance',
        cashFlowImpact: -8,
        summary: 'Requires NIST 800-171 compliance and 72-hour incident reporting.',
        plainLanguage: 'You must have cybersecurity controls in place and report any breaches to DoD within 3 days. Non-compliance can mean contract termination.',
        recommendation: 'Verify current SPRS score. Budget for ongoing CMMC compliance costs.',
        farRef: 'DFARS 204.73',
      },
      {
        clause: 'H.7.1',
        title: 'Organizational Conflict of Interest',
        category: 'Conflicts',
        risk: 'MEDIUM',
        impact: 'BD Limitation',
        cashFlowImpact: -5,
        summary: 'Contractor may be excluded from future related procurements.',
        plainLanguage: 'Working on this contract might prevent you from bidding on follow-on work. Read the fine print carefully.',
        recommendation: 'Request OCI waiver consideration. Document mitigation plan in proposal.',
        farRef: 'FAR 9.505',
      },
      {
        clause: '52.222-50',
        title: 'Combating Trafficking in Persons',
        category: 'Labor',
        risk: 'LOW',
        impact: 'Compliance',
        cashFlowImpact: 0,
        summary: 'Prohibition on trafficking and forced labor practices.',
        plainLanguage: 'Standard clause requiring ethical labor practices. Flow down to all subcontractors.',
        recommendation: 'Standard complianceâ€”ensure partner/sub certifications are current.',
        farRef: 'FAR 22.17',
      },
      {
        clause: '52.219-14',
        title: 'Limitations on Subcontracting',
        category: 'Set-Aside',
        risk: 'LOW',
        impact: 'Compliance',
        cashFlowImpact: 0,
        summary: 'Small business must perform 50%+ of personnel costs.',
        plainLanguage: 'You need to do at least half the work yourselfâ€”can\'t just pass it all to a large business teammate.',
        recommendation: 'Verify workshare allocation meets threshold. Document in cost volume.',
        farRef: 'FAR 19.508',
      },
      {
        clause: '52.216-18',
        title: 'Ordering',
        category: 'Task Order',
        risk: 'INFO',
        impact: 'Administrative',
        cashFlowImpact: 0,
        summary: 'Standard IDIQ ordering procedures.',
        plainLanguage: 'Describes how the government will issue task orders under this contract.',
        recommendation: 'No action requiredâ€”standard procedure clause.',
        farRef: 'FAR 16.505',
      },
      {
        clause: 'H.12.3',
        title: 'Performance Incentive',
        category: 'Incentive',
        risk: 'INFO',
        impact: 'Margin Opportunity',
        cashFlowImpact: 5,
        summary: 'Award fee up to 5% based on CPARS ratings.',
        plainLanguage: 'You can earn bonus money if you perform well. Great ratings = extra profit.',
        recommendation: 'Highlight this in your proposalâ€”show track record of Exceptional CPARS.',
        farRef: 'FAR 16.4',
      },
    ];

    // ========== ICONS ==========
    const Icons = {
      shield: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>,
      alert: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>,
      check: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>,
      x: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>,
      document: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>,
      scale: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" /></svg>,
      cpu: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" /></svg>,
      loader: () => <svg className="w-full h-full animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>,
      download: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>,
      zap: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>,
      dollar: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
      chevronRight: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" /></svg>,
      info: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
      lock: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" /></svg>,
      external: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>,
    };

    const Icon = ({ name, className = "w-5 h-5" }) => {
      const IconComponent = Icons[name];
      return IconComponent ? <span className={`inline-block ${className}`}><IconComponent /></span> : null;
    };

    // ========== UI COMPONENTS ==========
    const Card = ({ children, className = '', glow = false, pulse = false }) => (
      <div className={`bg-slate-800/50 backdrop-blur-sm border border-slate-700/50 rounded-2xl transition-all duration-300 ${glow ? 'shadow-lg shadow-cyan-500/20 border-cyan-500/30' : ''} ${pulse ? 'animate-riskPulse' : ''} ${className}`}>
        {children}
      </div>
    );

    const Badge = ({ children, variant = 'default', size = 'sm', icon }) => {
      const variants = {
        default: 'bg-slate-700 text-slate-300',
        success: 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30',
        warning: 'bg-amber-500/20 text-amber-400 border border-amber-500/30',
        danger: 'bg-red-500/20 text-red-400 border border-red-500/30',
        info: 'bg-blue-500/20 text-blue-400 border border-blue-500/30',
        cyan: 'bg-cyan-500/20 text-cyan-400 border border-cyan-500/30',
        purple: 'bg-purple-500/20 text-purple-400 border border-purple-500/30',
      };
      const sizes = {
        xs: 'px-1.5 py-0.5 text-[10px]',
        sm: 'px-2 py-1 text-xs',
        md: 'px-3 py-1.5 text-sm',
      };
      return (
        <span className={`inline-flex items-center gap-1.5 font-medium rounded-lg ${variants[variant]} ${sizes[size]}`}>
          {icon && <Icon name={icon} className="w-3 h-3" />}
          {children}
        </span>
      );
    };

    const Button = ({ children, variant = 'primary', size = 'md', icon, disabled = false, loading = false, className = '', ...props }) => {
      const variants = {
        primary: 'bg-gradient-to-r from-cyan-500 to-teal-500 text-white hover:from-cyan-400 hover:to-teal-400 shadow-lg shadow-cyan-500/25',
        secondary: 'bg-slate-700 text-white hover:bg-slate-600 border border-slate-600',
        danger: 'bg-gradient-to-r from-red-500 to-rose-500 text-white hover:from-red-400 hover:to-rose-400',
        warning: 'bg-gradient-to-r from-amber-500 to-orange-500 text-white hover:from-amber-400 hover:to-orange-400',
        ghost: 'bg-transparent text-slate-400 hover:text-white hover:bg-slate-700/50',
      };
      const sizes = {
        sm: 'px-3 py-1.5 text-sm',
        md: 'px-4 py-2 text-sm',
        lg: 'px-6 py-3 text-base',
      };
      return (
        <button
          className={`inline-flex items-center justify-center gap-2 font-semibold rounded-xl transition-all duration-200 ${variants[variant]} ${sizes[size]} ${disabled || loading ? 'opacity-50 cursor-not-allowed' : ''} ${className}`}
          disabled={disabled || loading}
          {...props}
        >
          {loading ? <Icon name="loader" className="w-4 h-4" /> : icon && <Icon name={icon} className="w-4 h-4" />}
          {children}
        </button>
      );
    };

    // ========== RISK BADGE ==========
    const RiskBadge = ({ risk }) => {
      const config = {
        HIGH: { variant: 'danger', text: 'HIGH RISK' },
        MEDIUM: { variant: 'warning', text: 'MEDIUM' },
        LOW: { variant: 'success', text: 'LOW' },
        INFO: { variant: 'info', text: 'INFO' },
      };
      const { variant, text } = config[risk] || config.INFO;
      return <Badge variant={variant} size="xs">{text}</Badge>;
    };

    // ========== CASH FLOW IMPACT CHART ==========
    const CashFlowChart = ({ clauses }) => {
      const impacts = clauses.filter(c => c.cashFlowImpact !== 0);
      const maxImpact = Math.max(...impacts.map(c => Math.abs(c.cashFlowImpact)));
      const totalNegative = impacts.filter(c => c.cashFlowImpact < 0).reduce((sum, c) => sum + c.cashFlowImpact, 0);
      const totalPositive = impacts.filter(c => c.cashFlowImpact > 0).reduce((sum, c) => sum + c.cashFlowImpact, 0);

      return (
        <Card className="p-4">
          <div className="flex items-center gap-2 mb-4">
            <Icon name="dollar" className="w-5 h-5 text-amber-400" />
            <h3 className="font-semibold text-white">Cash Flow Impact Model</h3>
          </div>
          
          <div className="space-y-3 mb-4">
            {impacts.map((clause, i) => (
              <div key={clause.clause} className="animate-fadeIn" style={{ animationDelay: `${i * 100}ms` }}>
                <div className="flex justify-between text-xs mb-1">
                  <span className="text-slate-400 font-mono">{clause.clause}</span>
                  <span className={clause.cashFlowImpact < 0 ? 'text-red-400' : 'text-emerald-400'}>
                    {clause.cashFlowImpact > 0 ? '+' : ''}{clause.cashFlowImpact}%
                  </span>
                </div>
                <div className="h-2 bg-slate-700 rounded-full overflow-hidden">
                  <div
                    className={`h-full rounded-full cash-bar ${clause.cashFlowImpact < 0 ? 'bg-gradient-to-r from-red-500 to-rose-400' : 'bg-gradient-to-r from-emerald-500 to-teal-400'}`}
                    style={{ width: `${(Math.abs(clause.cashFlowImpact) / maxImpact) * 100}%` }}
                  />
                </div>
              </div>
            ))}
          </div>

          <div className="flex justify-between pt-3 border-t border-slate-700">
            <div className="text-center">
              <div className="text-2xl font-bold text-red-400">{totalNegative}%</div>
              <div className="text-xs text-slate-500">Risk Exposure</div>
            </div>
            <div className="text-center">
              <div className="text-2xl font-bold text-emerald-400">+{totalPositive}%</div>
              <div className="text-xs text-slate-500">Upside Potential</div>
            </div>
            <div className="text-center">
              <div className="text-2xl font-bold text-amber-400">{totalNegative + totalPositive}%</div>
              <div className="text-xs text-slate-500">Net Impact</div>
            </div>
          </div>
        </Card>
      );
    };

    // ========== CLAUSE DETAIL PANEL ==========
    const ClauseDetailPanel = ({ clause, onClose }) => {
      if (!clause) return null;

      const riskColors = {
        HIGH: COLORS.danger,
        MEDIUM: COLORS.warning,
        LOW: COLORS.success,
        INFO: COLORS.info,
      };

      return (
        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fadeIn" onClick={onClose}>
          <Card className="w-full max-w-2xl max-h-[90vh] overflow-auto p-6 animate-slideIn" onClick={e => e.stopPropagation()}>
            <div className="flex items-start justify-between mb-4">
              <div>
                <div className="flex items-center gap-2 mb-1">
                  <span className="font-mono text-lg text-cyan-400">{clause.clause}</span>
                  <RiskBadge risk={clause.risk} />
                </div>
                <h2 className="text-xl font-bold text-white">{clause.title}</h2>
              </div>
              <button onClick={onClose} className="p-2 rounded-lg hover:bg-slate-700 text-slate-400 hover:text-white">
                <Icon name="x" className="w-5 h-5" />
              </button>
            </div>

            <div className="space-y-4">
              {/* Summary */}
              <div className="p-4 rounded-xl bg-slate-900/50 border-l-4" style={{ borderColor: riskColors[clause.risk] }}>
                <h4 className="text-xs font-semibold text-slate-500 uppercase mb-2">Official Summary</h4>
                <p className="text-slate-300">{clause.summary}</p>
              </div>

              {/* Plain Language */}
              <div className="p-4 rounded-xl bg-cyan-500/5 border border-cyan-500/20">
                <div className="flex items-center gap-2 mb-2">
                  <Icon name="cpu" className="w-4 h-4 text-cyan-400" />
                  <h4 className="text-xs font-semibold text-cyan-400 uppercase">Plain Language (AI Analysis)</h4>
                </div>
                <p className="text-white">{clause.plainLanguage}</p>
              </div>

              {/* Recommendation */}
              <div className="p-4 rounded-xl bg-emerald-500/5 border border-emerald-500/20">
                <div className="flex items-center gap-2 mb-2">
                  <Icon name="scale" className="w-4 h-4 text-emerald-400" />
                  <h4 className="text-xs font-semibold text-emerald-400 uppercase">Negotiation Strategy</h4>
                </div>
                <p className="text-white">{clause.recommendation}</p>
              </div>

              {/* Meta */}
              <div className="flex flex-wrap gap-3 pt-2">
                <Badge variant="cyan" size="sm" icon="document">{clause.farRef}</Badge>
                <Badge variant={clause.cashFlowImpact < 0 ? 'danger' : clause.cashFlowImpact > 0 ? 'success' : 'default'} size="sm" icon="dollar">
                  {clause.cashFlowImpact > 0 ? '+' : ''}{clause.cashFlowImpact}% Cash Flow
                </Badge>
                <Badge variant="purple" size="sm">{clause.category}</Badge>
              </div>

              {/* Action Button */}
              <Button variant="warning" size="lg" icon="zap" className="w-full mt-4">
                Generate Q&A Response for {clause.clause}
              </Button>
            </div>
          </Card>
        </div>
      );
    };

    // ========== AI AGENT STATUS ==========
    const AIAgentStatus = ({ status, clausesAnalyzed }) => (
      <div className="flex items-center gap-4 p-4 rounded-xl bg-slate-900/50 border border-cyan-500/20">
        <div className="relative">
          <div className="w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-400 to-teal-500 flex items-center justify-center">
            <Icon name="cpu" className="w-6 h-6 text-white" />
          </div>
          {status === 'analyzing' && (
            <span className="absolute -top-1 -right-1 w-3 h-3 rounded-full bg-cyan-400 animate-ping" />
          )}
        </div>
        <div className="flex-1">
          <div className="flex items-center gap-2">
            <span className="font-semibold text-white">Contracts Advisor Agent</span>
            <Badge variant={status === 'complete' ? 'success' : status === 'analyzing' ? 'cyan' : 'default'} size="xs">
              {status === 'complete' ? 'Analysis Complete' : status === 'analyzing' ? 'Analyzing...' : 'Ready'}
            </Badge>
          </div>
          <p className="text-sm text-slate-400">
            {status === 'complete' 
              ? `${clausesAnalyzed} clauses analyzed â€¢ ${SECTION_I_CLAUSES.filter(c => c.risk === 'HIGH').length} high-risk flagged`
              : status === 'analyzing'
              ? 'Scanning Section I for FAR/DFARS clauses...'
              : 'Ready to analyze RFP contract terms'
            }
          </p>
        </div>
      </div>
    );

    // ========== MAIN CONTRACTS SCANNER COMPONENT ==========
    const ContractsScanner = () => {
      const [status, setStatus] = useState('idle'); // idle, scanning, analyzing, complete
      const [selectedClause, setSelectedClause] = useState(null);
      const [visibleClauses, setVisibleClauses] = useState([]);
      const [filter, setFilter] = useState('all');
      const [showMemo, setShowMemo] = useState(false);

      const runAnalysis = () => {
        setStatus('scanning');
        setVisibleClauses([]);
        
        // Simulate scanning
        setTimeout(() => {
          setStatus('analyzing');
          
          // Reveal clauses one by one
          SECTION_I_CLAUSES.forEach((_, index) => {
            setTimeout(() => {
              setVisibleClauses(prev => [...prev, SECTION_I_CLAUSES[index]]);
              
              if (index === SECTION_I_CLAUSES.length - 1) {
                setTimeout(() => setStatus('complete'), 500);
              }
            }, index * 300);
          });
        }, 1500);
      };

      const filteredClauses = visibleClauses.filter(c => 
        filter === 'all' || c.risk === filter
      );

      const riskCounts = {
        HIGH: visibleClauses.filter(c => c.risk === 'HIGH').length,
        MEDIUM: visibleClauses.filter(c => c.risk === 'MEDIUM').length,
        LOW: visibleClauses.filter(c => c.risk === 'LOW').length,
        INFO: visibleClauses.filter(c => c.risk === 'INFO').length,
      };

      return (
        <div className="min-h-screen p-6" style={{ backgroundColor: COLORS.bg }}>
          {/* Header */}
          <div className="max-w-7xl mx-auto">
            <div className="flex items-center justify-between mb-8">
              <div>
                <div className="flex items-center gap-3 mb-2">
                  <div className="px-3 py-1 rounded-lg bg-pink-500/20 text-pink-400 text-sm font-mono font-bold">M5</div>
                  <h1 className="text-3xl font-bold text-white">CONTRACTS SCANNER</h1>
                </div>
                <p className="text-slate-400">FAR/DFARS Risk Analysis â€¢ Section I Clause Review</p>
              </div>
              <div className="flex items-center gap-3">
                {status === 'complete' && (
                  <Button variant="secondary" icon="download" onClick={() => setShowMemo(true)}>
                    Generate Risk Memo
                  </Button>
                )}
                {status === 'idle' && (
                  <Button variant="primary" icon="zap" size="lg" onClick={runAnalysis}>
                    Analyze Contract Risks
                  </Button>
                )}
              </div>
            </div>

            {/* AI Agent Status */}
            <AIAgentStatus status={status === 'idle' ? 'ready' : status === 'complete' ? 'complete' : 'analyzing'} clausesAnalyzed={visibleClauses.length} />

            {/* Scanning Animation */}
            {status === 'scanning' && (
              <Card className="mt-6 p-8 text-center scan-container overflow-hidden">
                <div className="scan-line animate-scanLine" />
                <Icon name="loader" className="w-12 h-12 text-cyan-400 mx-auto mb-4" />
                <h3 className="text-xl font-bold text-white mb-2">Scanning Section I</h3>
                <p className="text-slate-400">Parsing clauses and identifying risk factors...</p>
              </Card>
            )}

            {/* Main Content Grid */}
            {visibleClauses.length > 0 && (
              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6 animate-fadeIn">
                {/* Left Column - Clause List */}
                <div className="lg:col-span-2 space-y-4">
                  {/* Risk Filter Tabs */}
                  <div className="flex items-center gap-2 p-1 bg-slate-800/50 rounded-xl">
                    {['all', 'HIGH', 'MEDIUM', 'LOW', 'INFO'].map(f => (
                      <button
                        key={f}
                        onClick={() => setFilter(f)}
                        className={`flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-all ${
                          filter === f 
                            ? 'bg-slate-700 text-white' 
                            : 'text-slate-400 hover:text-white'
                        }`}
                      >
                        {f === 'all' ? 'All Clauses' : f}
                        {f !== 'all' && riskCounts[f] > 0 && (
                          <span className={`ml-2 px-1.5 py-0.5 rounded text-[10px] ${
                            f === 'HIGH' ? 'bg-red-500/20 text-red-400' :
                            f === 'MEDIUM' ? 'bg-amber-500/20 text-amber-400' :
                            f === 'LOW' ? 'bg-emerald-500/20 text-emerald-400' :
                            'bg-blue-500/20 text-blue-400'
                          }`}>
                            {riskCounts[f]}
                          </span>
                        )}
                      </button>
                    ))}
                  </div>

                  {/* Clause Cards */}
                  <Card className="p-4">
                    <div className="flex items-center gap-2 mb-4">
                      <Icon name="document" className="w-5 h-5 text-pink-400" />
                      <h3 className="font-semibold text-white">Section I - Contract Clauses</h3>
                      <span className="text-xs text-slate-500">{visibleClauses.length} analyzed</span>
                    </div>

                    <div className="space-y-3">
                      {filteredClauses.map((clause, i) => (
                        <div
                          key={clause.clause}
                          onClick={() => setSelectedClause(clause)}
                          className={`p-4 rounded-xl bg-slate-900/50 border-l-4 cursor-pointer hover:bg-slate-800/50 transition-all animate-slideIn risk-${clause.risk.toLowerCase()}`}
                          style={{ animationDelay: `${i * 50}ms` }}
                        >
                          <div className="flex items-start justify-between mb-2">
                            <div className="flex-1">
                              <div className="flex items-center gap-2 mb-1">
                                <span className="font-mono text-sm text-cyan-400">{clause.clause}</span>
                                <RiskBadge risk={clause.risk} />
                                <Badge variant="default" size="xs">{clause.category}</Badge>
                              </div>
                              <h4 className="font-medium text-white">{clause.title}</h4>
                            </div>
                            <Icon name="chevronRight" className="w-5 h-5 text-slate-500" />
                          </div>
                          <p className="text-sm text-slate-400 line-clamp-2">{clause.summary}</p>
                          <div className="flex items-center gap-2 mt-2">
                            <Icon name="alert" className="w-4 h-4 text-amber-400" />
                            <span className="text-xs text-amber-400">Impact: {clause.impact}</span>
                          </div>
                        </div>
                      ))}
                    </div>
                  </Card>
                </div>

                {/* Right Column - Stats & Cash Flow */}
                <div className="space-y-4">
                  {/* Risk Summary */}
                  <Card className="p-4">
                    <h3 className="font-semibold text-white mb-4">Risk Summary</h3>
                    <div className="grid grid-cols-2 gap-3">
                      <div className="p-3 rounded-xl bg-red-500/10 border border-red-500/20 text-center">
                        <div className="text-3xl font-bold text-red-400 animate-countUp">{riskCounts.HIGH}</div>
                        <div className="text-xs text-slate-400">High Risk</div>
                      </div>
                      <div className="p-3 rounded-xl bg-amber-500/10 border border-amber-500/20 text-center">
                        <div className="text-3xl font-bold text-amber-400 animate-countUp">{riskCounts.MEDIUM}</div>
                        <div className="text-xs text-slate-400">Medium</div>
                      </div>
                      <div className="p-3 rounded-xl bg-emerald-500/10 border border-emerald-500/20 text-center">
                        <div className="text-3xl font-bold text-emerald-400 animate-countUp">{riskCounts.LOW}</div>
                        <div className="text-xs text-slate-400">Low Risk</div>
                      </div>
                      <div className="p-3 rounded-xl bg-blue-500/10 border border-blue-500/20 text-center">
                        <div className="text-3xl font-bold text-blue-400 animate-countUp">{riskCounts.INFO}</div>
                        <div className="text-xs text-slate-400">Info Only</div>
                      </div>
                    </div>
                  </Card>

                  {/* Cash Flow Impact */}
                  <CashFlowChart clauses={visibleClauses} />

                  {/* Negotiation Leverage */}
                  <Card className="p-4">
                    <h3 className="font-semibold text-white mb-4">Negotiation Leverage</h3>
                    <div className="p-4 rounded-xl bg-gradient-to-br from-amber-500/10 to-orange-500/5 border border-amber-500/20">
                      <Icon name="scale" className="w-6 h-6 text-amber-400 mb-2" />
                      <h4 className="font-medium text-white mb-1">Payment Terms Counter</h4>
                      <p className="text-sm text-slate-400 mb-3">
                        Net-60 creates {Math.abs(SECTION_I_CLAUSES.find(c => c.clause === 'H.4.2')?.cashFlowImpact || 0)}% margin erosion. Counter with milestone payments.
                      </p>
                      <Button variant="warning" size="sm" icon="zap" className="w-full">
                        Generate Q&A Response
                      </Button>
                    </div>
                  </Card>

                  {/* DFARS Highlight */}
                  <Card className="p-4 border-purple-500/30" pulse={riskCounts.HIGH > 0}>
                    <div className="flex items-center gap-2 mb-3">
                      <Icon name="lock" className="w-5 h-5 text-purple-400" />
                      <h3 className="font-semibold text-white">DFARS Spotlight</h3>
                    </div>
                    <div className="p-3 rounded-lg bg-purple-500/10 border border-purple-500/20 mb-3">
                      <span className="font-mono text-xs text-purple-400">252.204-7012</span>
                      <p className="text-sm text-white mt-1">CUI cybersecurity requirements detected</p>
                    </div>
                    <div className="text-xs text-slate-400">
                      Requires NIST 800-171 compliance and 72-hour breach reporting
                    </div>
                  </Card>
                </div>
              </div>
            )}

            {/* Empty State */}
            {status === 'idle' && (
              <Card className="mt-6 p-12 text-center">
                <div className="w-20 h-20 mx-auto mb-6 rounded-2xl bg-pink-500/10 flex items-center justify-center">
                  <Icon name="shield" className="w-10 h-10 text-pink-400" />
                </div>
                <h3 className="text-xl font-bold text-white mb-2">Ready to Analyze Contract Terms</h3>
                <p className="text-slate-400 max-w-md mx-auto mb-6">
                  Click "Analyze Contract Risks" to scan Section I clauses. The AI will flag unusual terms, 
                  explain them in plain language, and recommend negotiation strategies.
                </p>
                <div className="flex flex-wrap justify-center gap-2">
                  <Badge variant="danger" size="sm">FAR/DFARS Analysis</Badge>
                  <Badge variant="warning" size="sm">Cash Flow Impact</Badge>
                  <Badge variant="success" size="sm">Plain Language</Badge>
                  <Badge variant="cyan" size="sm">Negotiation Tips</Badge>
                </div>
              </Card>
            )}

            {/* Footer */}
            <div className="flex items-center justify-between mt-8 pt-4 border-t border-slate-800">
              <span className="text-xs text-slate-500">MissionPulse v12 â€¢ M5 Contracts Scanner</span>
              <Badge variant="warning" size="xs">AI GENERATED - REQUIRES HUMAN REVIEW</Badge>
            </div>
          </div>

          {/* Clause Detail Modal */}
          {selectedClause && (
            <ClauseDetailPanel clause={selectedClause} onClose={() => setSelectedClause(null)} />
          )}

          {/* Memo Generation Modal */}
          {showMemo && (
            <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fadeIn" onClick={() => setShowMemo(false)}>
              <Card className="w-full max-w-lg p-6 animate-slideIn" onClick={e => e.stopPropagation()}>
                <div className="flex items-center gap-3 mb-4">
                  <div className="w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-400 to-teal-500 flex items-center justify-center">
                    <Icon name="document" className="w-6 h-6 text-white" />
                  </div>
                  <div>
                    <h3 className="font-bold text-white">Generate Risk Analysis Memo</h3>
                    <p className="text-sm text-slate-400">FAR_Risk_Analysis_Memo.docx</p>
                  </div>
                </div>
                
                <div className="space-y-3 mb-6">
                  <div className="flex items-center gap-2 text-sm text-slate-300">
                    <Icon name="check" className="w-4 h-4 text-emerald-400" />
                    Clause-by-Clause Analysis
                  </div>
                  <div className="flex items-center gap-2 text-sm text-slate-300">
                    <Icon name="check" className="w-4 h-4 text-emerald-400" />
                    Risk Level Assessment (High/Med/Low)
                  </div>
                  <div className="flex items-center gap-2 text-sm text-slate-300">
                    <Icon name="check" className="w-4 h-4 text-emerald-400" />
                    Plain-Language Explanations
                  </div>
                  <div className="flex items-center gap-2 text-sm text-slate-300">
                    <Icon name="check" className="w-4 h-4 text-emerald-400" />
                    Recommended Negotiations
                  </div>
                  <div className="flex items-center gap-2 text-sm text-slate-300">
                    <Icon name="check" className="w-4 h-4 text-emerald-400" />
                    Cash Flow Impact Model
                  </div>
                </div>

                <div className="flex gap-3">
                  <Button variant="ghost" onClick={() => setShowMemo(false)} className="flex-1">Cancel</Button>
                  <Button variant="primary" icon="download" className="flex-1">Download Memo</Button>
                </div>
              </Card>
            </div>
          )}
        </div>
      );
    };

    // ========== RENDER ==========
    ReactDOM.render(<ContractsScanner />, document.getElementById('root'));
  </script>
  <!-- AI Chat Widget - Compliance Agent -->
  <script src="ai-chat-widget.js" data-agent="compliance"></script>
</body>
</html>
