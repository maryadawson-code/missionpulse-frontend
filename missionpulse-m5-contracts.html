<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse M5 - Contracts Analyzer</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', sans-serif; background: #00050F; min-height: 100vh; }
    .font-mono { font-family: 'JetBrains Mono', monospace; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    @keyframes ping { 75%, 100% { transform: scale(2); opacity: 0; } }
    @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes glow { 0%, 100% { box-shadow: 0 0 20px rgba(0, 229, 250, 0.2); } 50% { box-shadow: 0 0 40px rgba(0, 229, 250, 0.4); } }
    @keyframes scanLine { 0% { transform: translateY(-100%); } 100% { transform: translateY(100%); } }
    .animate-pulse { animation: pulse 2s ease-in-out infinite; }
    .animate-ping { animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite; }
    .animate-slideIn { animation: slideIn 0.4s ease-out; }
    .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
    .animate-glow { animation: glow 2s ease-in-out infinite; }
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: #0f172a; }
    ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #475569; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    // ============================================================================
    // DESIGN TOKENS - Shield & Pulse UX v8.0
    // ============================================================================
    const TOKENS = {
      colors: {
        primary: '#00E5FA',
        secondary: '#0891B2',
        success: '#10B981',
        warning: '#F59E0B',
        danger: '#EF4444',
        navy: '#00050F',
        surface: 'rgba(15, 23, 42, 0.8)',
        border: 'rgba(51, 65, 85, 0.5)'
      }
    };

    // ============================================================================
    // RBAC ROLES - 11-Role System
    // ============================================================================
    const ROLES = {
      CEO: { name: 'CEO', label: 'Chief Executive', color: '#F59E0B', access: 'read', description: 'Final Go/No-Go decisions' },
      COO: { name: 'COO', label: 'Operations Lead', color: '#8B5CF6', access: 'read', description: 'Capture oversight' },
      CAP: { name: 'CAP', label: 'Capture Manager', color: '#EC4899', access: 'read', description: 'Win strategy' },
      PM: { name: 'PM', label: 'Proposal Manager', color: '#3B82F6', access: 'read', description: 'Schedule management' },
      SA: { name: 'SA', label: 'Solution Architect', color: '#06B6D4', access: 'read', description: 'Tech approach' },
      FIN: { name: 'FIN', label: 'Pricing Lead', color: '#10B981', access: 'read', description: 'Pricing strategy' },
      CON: { name: 'CON', label: 'Contracts Lead', color: '#00E5FA', access: 'full', description: 'FAR/DFARS compliance' },
      DEL: { name: 'DEL', label: 'Staffing Lead', color: '#F97316', access: 'read', description: 'Resource allocation' },
      SME: { name: 'SME', label: 'Subject Expert', color: '#A855F7', access: 'read', description: 'Domain expertise' },
      LEGAL: { name: 'LEGAL', label: 'Legal Counsel', color: '#EF4444', access: 'full', description: 'Legal review' },
      ADMIN: { name: 'ADMIN', label: 'Administrator', color: '#64748B', access: 'full', description: 'System admin' }
    };

    // ============================================================================
    // FAR/DFARS CLAUSE DATA - Comprehensive Database
    // ============================================================================
    const CLAUSES_DATA = [
      {
        id: 'FAR-52.227-14',
        clause: 'FAR 52.227-14',
        title: 'Rights in Data‚ÄîGeneral',
        category: 'IP Rights',
        risk: 'HIGH',
        isSensitive: true,
        plainLanguage: 'The government receives unlimited rights to all data developed under the contract. This means they can use, modify, and share your work product freely.',
        recommendation: 'Negotiate for Limited Rights on pre-existing IP. Document all proprietary data in Attachment J.',
        negotiationPoints: [
          'Request Limited Rights for pre-existing software/data',
          'Invoke Alternate II for copyrighted materials',
          'Establish clear IP boundaries in proposal'
        ],
        flowDown: true,
        farReference: 'FAR 27.404-2',
        section: 'I'
      },
      {
        id: 'FAR-52.227-16',
        clause: 'FAR 52.227-16',
        title: 'Additional Data Requirements',
        category: 'IP Rights',
        risk: 'MEDIUM',
        isSensitive: true,
        plainLanguage: 'Government can request additional data beyond what was originally required during contract performance.',
        recommendation: 'Include clear data delivery schedule and cost provisions for additional requests.',
        negotiationPoints: [
          'Define data categories clearly in contract',
          'Establish change order process for additional data',
          'Negotiate cost reimbursement for unplanned deliverables'
        ],
        flowDown: true,
        farReference: 'FAR 27.404-4',
        section: 'I'
      },
      {
        id: 'DFARS-252.204-7012',
        clause: 'DFARS 252.204-7012',
        title: 'Safeguarding CDI and Cyber Incident Reporting',
        category: 'Cybersecurity',
        risk: 'HIGH',
        isSensitive: false,
        plainLanguage: 'Requires NIST 800-171 compliance and 72-hour incident reporting for any cybersecurity breach.',
        recommendation: 'Verify SPRS score meets minimum (110+). Budget for ongoing CMMC compliance costs.',
        negotiationPoints: [
          'Confirm current SPRS score threshold',
          'Include CMMC costs in indirect rates',
          'Ensure subcontractor compliance documentation'
        ],
        flowDown: true,
        farReference: 'DFARS 204.73',
        section: 'I'
      },
      {
        id: 'DFARS-252.239-7018',
        clause: 'DFARS 252.239-7018',
        title: 'Supply Chain Risk',
        category: 'Cybersecurity',
        risk: 'MEDIUM',
        isSensitive: false,
        plainLanguage: 'Contractors must have processes to manage supply chain risk for covered systems.',
        recommendation: 'Document supply chain risk management program. Maintain approved vendor list.',
        negotiationPoints: [
          'Reference existing supply chain protocols',
          'Document vendor vetting procedures',
          'Establish incident response for supply chain issues'
        ],
        flowDown: true,
        farReference: 'DFARS 239.73',
        section: 'I'
      },
      {
        id: 'FAR-52.216-18',
        clause: 'FAR 52.216-18',
        title: 'Ordering (IDIQ)',
        category: 'Contract Type',
        risk: 'INFO',
        isSensitive: false,
        plainLanguage: 'Describes standard task order procedures for IDIQ contracts. Government issues orders through fair opportunity.',
        recommendation: 'No negotiation needed. Standard clause for IDIQ vehicles.',
        negotiationPoints: [
          'Understand ordering period limits',
          'Review min/max values',
          'Note fair opportunity exceptions'
        ],
        flowDown: false,
        farReference: 'FAR 16.505',
        section: 'I'
      },
      {
        id: 'FAR-52.219-14',
        clause: 'FAR 52.219-14',
        title: 'Limitations on Subcontracting',
        category: 'Set-Aside',
        risk: 'MEDIUM',
        isSensitive: true,
        plainLanguage: 'Small business must perform at least 50% of personnel costs. Cannot just pass work to large business teammates.',
        recommendation: 'Calculate precise workshare before finalizing teaming arrangements.',
        negotiationPoints: [
          'Map LCAT allocation to meet threshold',
          'Document similarly situated entity work',
          'Consider JV structure if needed'
        ],
        flowDown: false,
        farReference: 'FAR 19.508',
        section: 'I'
      },
      {
        id: 'H-4.2',
        clause: 'H.4.2',
        title: 'Payment Terms - Net 60',
        category: 'Cash Flow',
        risk: 'HIGH',
        isSensitive: true,
        isTrap: true,
        plainLanguage: 'Payment not due until 60 days after invoice acceptance. This is 30 days longer than standard and impacts cash flow significantly.',
        recommendation: 'Counter with Net-30 citing FAR 32.906. Propose milestone payments for large deliverables.',
        negotiationPoints: [
          'Cite FAR 32.906 prompt payment requirements',
          'Request progress payments for $100K+ tasks',
          'Propose 2% discount for payment within 10 days'
        ],
        flowDown: true,
        farReference: 'FAR 32.905',
        section: 'H'
      },
      {
        id: 'H-7.1',
        clause: 'H.7.1',
        title: 'Organizational Conflict of Interest',
        category: 'Conflicts',
        risk: 'MEDIUM',
        isSensitive: true,
        plainLanguage: 'Contractor may be excluded from future related procurements. Working on this contract could prevent bidding on follow-on work.',
        recommendation: 'Request written OCI determination before award. Propose mitigation plan in proposal.',
        negotiationPoints: [
          'Get specific OCI scope in writing',
          'Negotiate time-limited exclusions',
          'Propose firewall/mitigation measures'
        ],
        flowDown: false,
        farReference: 'FAR 9.505',
        section: 'H'
      },
      {
        id: 'FAR-52.222-50',
        clause: 'FAR 52.222-50',
        title: 'Combating Trafficking in Persons',
        category: 'Labor',
        risk: 'LOW',
        isSensitive: false,
        plainLanguage: 'Standard prohibition on human trafficking and forced labor. Requires ethical labor practices and supply chain due diligence.',
        recommendation: 'Standard compliance. Ensure partner/sub certifications are current.',
        negotiationPoints: [
          'No negotiation needed - standard clause',
          'Include in all subcontract flow-downs',
          'Maintain annual certification records'
        ],
        flowDown: true,
        farReference: 'FAR 22.17',
        section: 'I'
      },
      {
        id: 'FAR-52.232-40',
        clause: 'FAR 52.232-40',
        title: 'Providing Accelerated Payments',
        category: 'Cash Flow',
        risk: 'INFO',
        isSensitive: false,
        plainLanguage: 'Government should make accelerated payments to small business subcontractors when feasible.',
        recommendation: 'Leverage this clause to negotiate better payment terms with your large business prime.',
        negotiationPoints: [
          'Reference when negotiating sub terms',
          'Document accelerated payment requests',
          'Track compliance for reporting'
        ],
        flowDown: true,
        farReference: 'FAR 32.903',
        section: 'I'
      },
      {
        id: 'L-4.1',
        clause: 'Section L.4.1',
        title: 'Technical Approach Requirements',
        category: 'Section L',
        risk: 'INFO',
        isSensitive: false,
        plainLanguage: 'Offerors must describe technical approach addressing all PWS requirements. Page limit: 50 pages.',
        recommendation: 'Create compliance matrix mapping each L requirement to proposal response.',
        negotiationPoints: [],
        flowDown: false,
        farReference: 'N/A',
        section: 'L'
      },
      {
        id: 'L-4.2',
        clause: 'Section L.4.2',
        title: 'Management Approach Requirements',
        category: 'Section L',
        risk: 'INFO',
        isSensitive: false,
        plainLanguage: 'Describe project management methodology, quality control, and risk management approach.',
        recommendation: 'Include org chart, key personnel resumes, and risk mitigation matrix.',
        negotiationPoints: [],
        flowDown: false,
        farReference: 'N/A',
        section: 'L'
      },
      {
        id: 'M-2.1',
        clause: 'Section M.2.1',
        title: 'Technical Evaluation Factor',
        category: 'Section M',
        risk: 'INFO',
        isSensitive: false,
        plainLanguage: 'Technical approach weighted more important than cost. LPTA does not apply.',
        recommendation: 'Focus on technical discriminators over cost savings. Quality over price.',
        negotiationPoints: [],
        flowDown: false,
        farReference: 'N/A',
        section: 'M'
      },
      {
        id: 'M-2.2',
        clause: 'Section M.2.2',
        title: 'Past Performance Evaluation',
        category: 'Section M',
        risk: 'INFO',
        isSensitive: false,
        plainLanguage: 'Past performance is more important than cost but less important than technical. Recent/relevant work emphasized.',
        recommendation: 'Lead with most relevant healthcare IT contracts. Include CPARS ratings if exceptional.',
        negotiationPoints: [],
        flowDown: false,
        farReference: 'N/A',
        section: 'M'
      }
    ];

    // ============================================================================
    // COMPLIANCE CHECKLIST ITEMS
    // ============================================================================
    const COMPLIANCE_CHECKLIST = [
      { id: 1, label: 'Verify SAM.gov registration is current', critical: true, category: 'Registration' },
      { id: 2, label: 'Confirm CAGE code matches proposal', critical: true, category: 'Registration' },
      { id: 3, label: 'SPRS score meets minimum threshold (110+)', critical: true, category: 'Cybersecurity' },
      { id: 4, label: 'System Security Plan (SSP) is current', critical: true, category: 'Cybersecurity' },
      { id: 5, label: 'POAMs documented for any open findings', critical: false, category: 'Cybersecurity' },
      { id: 6, label: 'Small business workshare meets 50% threshold', critical: true, category: 'Set-Aside' },
      { id: 7, label: 'Subcontractor teaming agreements signed', critical: false, category: 'Teaming' },
      { id: 8, label: 'Flow-down clauses identified and documented', critical: true, category: 'Subcontracting' },
      { id: 9, label: 'OCI mitigation plan prepared', critical: false, category: 'Conflicts' },
      { id: 10, label: 'Pre-existing IP documented in Attachment J', critical: true, category: 'IP Rights' },
      { id: 11, label: 'Section L compliance matrix complete', critical: true, category: 'Proposal' },
      { id: 12, label: 'Section M evaluation criteria mapped', critical: true, category: 'Proposal' },
      { id: 13, label: 'Payment terms counter-proposal drafted', critical: false, category: 'Cash Flow' },
      { id: 14, label: 'Insurance certificates current', critical: false, category: 'Insurance' },
      { id: 15, label: 'Bonding capacity verified', critical: false, category: 'Financial' }
    ];

    // ============================================================================
    // ICONS
    // ============================================================================
    const Icons = {
      shield: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>,
      check: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>,
      x: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>,
      eye: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>,
      eyeOff: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" /></svg>,
      filter: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" /></svg>,
      clipboard: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" /></svg>,
      document: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>,
      alertTriangle: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>,
      lock: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" /></svg>,
      unlock: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z" /></svg>,
      search: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>,
      arrowDown: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 14l-7 7m0 0l-7-7m7 7V3" /></svg>,
      chevronDown: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" /></svg>,
      chevronRight: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" /></svg>,
      user: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>,
      scale: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" /></svg>,
      dollarSign: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
      flow: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 5l7 7-7 7M5 5l7 7-7 7" /></svg>,
    };

    const Icon = ({ name, className = "w-4 h-4" }) => {
      const IconComponent = Icons[name];
      return IconComponent ? <span className={`inline-block ${className}`}><IconComponent /></span> : null;
    };

    // ============================================================================
    // UI COMPONENTS
    // ============================================================================
    const Card = ({ children, className = '', glow = false, onClick }) => (
      <div 
        onClick={onClick} 
        className={`
          bg-slate-800/50 backdrop-blur-sm border border-slate-700/50 rounded-xl 
          transition-all duration-300 
          ${onClick ? 'cursor-pointer hover:border-cyan-500/50' : ''} 
          ${glow ? 'shadow-lg shadow-cyan-500/20 border-cyan-500/30' : ''} 
          ${className}
        `}
      >
        {children}
      </div>
    );

    const Button = ({ children, variant = 'primary', size = 'md', icon, className = '', disabled = false, ...props }) => {
      const variants = { 
        primary: 'bg-gradient-to-r from-cyan-500 to-teal-500 text-white hover:from-cyan-400 hover:to-teal-400 shadow-lg shadow-cyan-500/25', 
        secondary: 'bg-slate-700 text-white hover:bg-slate-600 border border-slate-600', 
        success: 'bg-emerald-500 text-white hover:bg-emerald-400', 
        danger: 'bg-red-500 text-white hover:bg-red-400',
        warning: 'bg-amber-500 text-white hover:bg-amber-400',
        ghost: 'bg-transparent text-slate-400 hover:text-white hover:bg-slate-700/50'
      };
      const sizes = { xs: 'px-2 py-1 text-xs', sm: 'px-3 py-1.5 text-sm', md: 'px-4 py-2 text-sm', lg: 'px-6 py-3 text-base' };
      return (
        <button 
          className={`inline-flex items-center justify-center gap-2 font-semibold rounded-lg transition-all duration-200 ${variants[variant]} ${sizes[size]} ${disabled ? 'opacity-50 cursor-not-allowed' : ''} ${className}`} 
          disabled={disabled} 
          {...props}
        >
          {icon && <Icon name={icon} className="w-4 h-4" />}{children}
        </button>
      );
    };

    const Badge = ({ children, variant = 'default', size = 'sm', icon, pulse = false }) => {
      const variants = { 
        default: 'bg-slate-700 text-slate-300', 
        primary: 'bg-cyan-500/20 text-cyan-400 border border-cyan-500/30', 
        success: 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30', 
        warning: 'bg-amber-500/20 text-amber-400 border border-amber-500/30', 
        danger: 'bg-red-500/20 text-red-400 border border-red-500/30',
        purple: 'bg-purple-500/20 text-purple-400 border border-purple-500/30',
        info: 'bg-blue-500/20 text-blue-400 border border-blue-500/30'
      };
      const sizes = { xs: 'px-1.5 py-0.5 text-xs', sm: 'px-2 py-1 text-xs', md: 'px-3 py-1.5 text-sm' };
      return (
        <span className={`inline-flex items-center gap-1.5 rounded-full font-medium ${variants[variant]} ${sizes[size]} ${pulse ? 'animate-pulse' : ''}`}>
          {icon && <Icon name={icon} className="w-3 h-3" />}{children}
        </span>
      );
    };

    // ============================================================================
    // ROLE SELECTOR COMPONENT
    // ============================================================================
    const RoleSelector = ({ currentRole, onRoleChange }) => {
      const [isOpen, setIsOpen] = useState(false);
      const role = ROLES[currentRole];
      
      return (
        <div className="relative">
          <button 
            onClick={() => setIsOpen(!isOpen)}
            className="flex items-center gap-3 px-4 py-2.5 bg-slate-800/80 border border-slate-700 rounded-xl hover:border-cyan-500/50 transition-all"
          >
            <div className="w-8 h-8 rounded-lg flex items-center justify-center text-white font-bold text-sm" style={{ backgroundColor: role.color }}>
              {currentRole.slice(0, 2)}
            </div>
            <div className="text-left">
              <div className="text-sm font-semibold text-white">{role.label}</div>
              <div className="text-xs text-slate-400">{role.access === 'full' ? 'üîì Full Access' : 'üîí Read Only'}</div>
            </div>
            <Icon name="chevronDown" className={`w-4 h-4 text-slate-400 transition-transform ${isOpen ? 'rotate-180' : ''}`} />
          </button>
          
          {isOpen && (
            <div className="absolute top-full left-0 mt-2 w-72 bg-slate-900 border border-slate-700 rounded-xl shadow-2xl z-50 overflow-hidden animate-slideIn">
              <div className="p-3 border-b border-slate-700 bg-slate-800/50">
                <div className="text-xs font-medium text-slate-400 uppercase tracking-wider">Switch Role</div>
              </div>
              <div className="max-h-80 overflow-auto p-2">
                {Object.entries(ROLES).map(([key, r]) => (
                  <button
                    key={key}
                    onClick={() => { onRoleChange(key); setIsOpen(false); }}
                    className={`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all ${
                      currentRole === key ? 'bg-cyan-500/20 border border-cyan-500/30' : 'hover:bg-slate-800'
                    }`}
                  >
                    <div className="w-8 h-8 rounded-lg flex items-center justify-center text-white font-bold text-xs" style={{ backgroundColor: r.color }}>
                      {key.slice(0, 2)}
                    </div>
                    <div className="flex-1 text-left">
                      <div className="text-sm font-medium text-white">{r.label}</div>
                      <div className="text-xs text-slate-400">{r.description}</div>
                    </div>
                    {r.access === 'full' && <Badge variant="success" size="xs">Full</Badge>}
                  </button>
                ))}
              </div>
            </div>
          )}
        </div>
      );
    };

    // ============================================================================
    // CLAUSE CARD COMPONENT
    // ============================================================================
    const ClauseCard = ({ clause, isExpanded, onToggle, hasFullAccess }) => {
      const riskColors = {
        HIGH: { bg: 'bg-red-500/20', border: 'border-red-500/30', text: 'text-red-400', badge: 'danger' },
        MEDIUM: { bg: 'bg-amber-500/20', border: 'border-amber-500/30', text: 'text-amber-400', badge: 'warning' },
        LOW: { bg: 'bg-emerald-500/20', border: 'border-emerald-500/30', text: 'text-emerald-400', badge: 'success' },
        INFO: { bg: 'bg-blue-500/20', border: 'border-blue-500/30', text: 'text-blue-400', badge: 'info' }
      };
      const colors = riskColors[clause.risk] || riskColors.INFO;
      const isRestricted = clause.isSensitive && !hasFullAccess;

      return (
        <Card className={`overflow-hidden transition-all ${colors.border} border-l-4 ${isRestricted ? 'opacity-75' : ''}`}>
          <div 
            className="p-4 cursor-pointer hover:bg-slate-800/30 transition-colors"
            onClick={() => !isRestricted && onToggle(clause.id)}
          >
            <div className="flex items-start justify-between gap-4">
              <div className="flex-1">
                <div className="flex items-center gap-2 flex-wrap">
                  <span className="font-mono text-cyan-400 text-sm font-semibold">{clause.clause}</span>
                  <Badge variant={colors.badge} size="xs">{clause.risk}</Badge>
                  {clause.isTrap && <Badge variant="danger" size="xs" pulse>‚ö†Ô∏è TRAP CLAUSE</Badge>}
                  {clause.flowDown && <Badge variant="purple" size="xs" icon="flow">Flow-Down</Badge>}
                  {isRestricted && <Badge variant="default" size="xs" icon="lock">Restricted</Badge>}
                </div>
                <h3 className="text-white font-semibold mt-2">{clause.title}</h3>
                <p className="text-slate-400 text-sm mt-1">{clause.category} ‚Ä¢ Section {clause.section}</p>
              </div>
              <div className="flex items-center gap-2">
                {!isRestricted && (
                  <Icon 
                    name={isExpanded ? 'chevronDown' : 'chevronRight'} 
                    className="w-5 h-5 text-slate-400" 
                  />
                )}
              </div>
            </div>
          </div>
          
          {isExpanded && !isRestricted && (
            <div className="px-4 pb-4 border-t border-slate-700/50 animate-slideIn">
              <div className="mt-4 space-y-4">
                {/* Plain Language */}
                <div className="bg-slate-900/50 rounded-lg p-4">
                  <div className="text-xs font-medium text-cyan-400 uppercase tracking-wider mb-2">Plain Language</div>
                  <p className="text-slate-300 text-sm">{clause.plainLanguage}</p>
                </div>
                
                {/* Recommendation */}
                <div className="bg-emerald-500/10 border border-emerald-500/20 rounded-lg p-4">
                  <div className="text-xs font-medium text-emerald-400 uppercase tracking-wider mb-2">Recommendation</div>
                  <p className="text-slate-300 text-sm">{clause.recommendation}</p>
                </div>
                
                {/* Negotiation Points */}
                {clause.negotiationPoints.length > 0 && (
                  <div>
                    <div className="text-xs font-medium text-slate-400 uppercase tracking-wider mb-2">Negotiation Points</div>
                    <ul className="space-y-2">
                      {clause.negotiationPoints.map((point, i) => (
                        <li key={i} className="flex items-start gap-2 text-sm text-slate-300">
                          <Icon name="chevronRight" className="w-4 h-4 text-cyan-400 mt-0.5 flex-shrink-0" />
                          {point}
                        </li>
                      ))}
                    </ul>
                  </div>
                )}
                
                {/* FAR Reference */}
                {clause.farReference !== 'N/A' && (
                  <div className="flex items-center gap-2 text-xs text-slate-400">
                    <Icon name="document" className="w-4 h-4" />
                    Reference: {clause.farReference}
                  </div>
                )}
              </div>
            </div>
          )}
          
          {isRestricted && (
            <div className="px-4 pb-4">
              <div className="bg-slate-900/80 rounded-lg p-4 border border-slate-700 flex items-center gap-3">
                <Icon name="lock" className="w-5 h-5 text-slate-500" />
                <div>
                  <p className="text-sm text-slate-400">Sensitive clause details restricted</p>
                  <p className="text-xs text-slate-500">Contact Contracts Lead (CON) for full access</p>
                </div>
              </div>
            </div>
          )}
        </Card>
      );
    };

    // ============================================================================
    // COMPLIANCE CHECKLIST COMPONENT
    // ============================================================================
    const ComplianceChecklist = ({ checkedItems, onToggle }) => {
      const progress = (checkedItems.length / COMPLIANCE_CHECKLIST.length) * 100;
      const categories = [...new Set(COMPLIANCE_CHECKLIST.map(i => i.category))];
      
      return (
        <Card className="p-4">
          <div className="flex items-center justify-between mb-4">
            <div className="flex items-center gap-2">
              <Icon name="clipboard" className="w-5 h-5 text-cyan-400" />
              <h3 className="font-semibold text-white">Compliance Checklist</h3>
            </div>
            <Badge variant={progress === 100 ? 'success' : progress > 50 ? 'warning' : 'danger'}>
              {checkedItems.length}/{COMPLIANCE_CHECKLIST.length}
            </Badge>
          </div>
          
          {/* Progress Bar */}
          <div className="h-2 bg-slate-700 rounded-full mb-4 overflow-hidden">
            <div 
              className="h-full bg-gradient-to-r from-cyan-500 to-emerald-500 rounded-full transition-all duration-500"
              style={{ width: `${progress}%` }}
            />
          </div>
          
          {/* Checklist by Category */}
          <div className="space-y-4 max-h-[400px] overflow-auto pr-2">
            {categories.map(cat => (
              <div key={cat}>
                <div className="text-xs font-medium text-slate-500 uppercase tracking-wider mb-2">{cat}</div>
                <div className="space-y-2">
                  {COMPLIANCE_CHECKLIST.filter(i => i.category === cat).map(item => (
                    <div 
                      key={item.id}
                      onClick={() => onToggle(item.id)}
                      className={`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-all ${
                        checkedItems.includes(item.id) 
                          ? 'bg-emerald-500/10 border border-emerald-500/30' 
                          : 'bg-slate-900/50 border border-slate-700/50 hover:bg-slate-800/50'
                      }`}
                    >
                      <div className={`w-5 h-5 rounded border-2 flex items-center justify-center transition-all flex-shrink-0 ${
                        checkedItems.includes(item.id)
                          ? 'bg-emerald-500 border-emerald-500'
                          : 'border-slate-600'
                      }`}>
                        {checkedItems.includes(item.id) && <Icon name="check" className="w-3 h-3 text-white" />}
                      </div>
                      <span className={`text-sm flex-1 ${checkedItems.includes(item.id) ? 'text-emerald-300 line-through' : 'text-slate-300'}`}>
                        {item.label}
                      </span>
                      {item.critical && !checkedItems.includes(item.id) && (
                        <Badge variant="danger" size="xs">Critical</Badge>
                      )}
                    </div>
                  ))}
                </div>
              </div>
            ))}
          </div>
        </Card>
      );
    };

    // ============================================================================
    // FLOW-DOWN TRACKER COMPONENT
    // ============================================================================
    const FlowDownTracker = ({ clauses }) => {
      const flowDownClauses = clauses.filter(c => c.flowDown);
      
      return (
        <Card className="p-4">
          <div className="flex items-center justify-between mb-4">
            <div className="flex items-center gap-2">
              <Icon name="flow" className="w-5 h-5 text-purple-400" />
              <h3 className="font-semibold text-white">Flow-Down Tracker</h3>
            </div>
            <Badge variant="purple">{flowDownClauses.length} Required</Badge>
          </div>
          
          <div className="space-y-2 max-h-[300px] overflow-auto pr-2">
            {flowDownClauses.map(clause => (
              <div 
                key={clause.id}
                className="flex items-center justify-between p-3 bg-slate-900/50 rounded-lg border border-slate-700/50"
              >
                <div>
                  <span className="font-mono text-purple-400 text-xs">{clause.clause}</span>
                  <p className="text-sm text-slate-300">{clause.title}</p>
                </div>
                <Badge variant={clause.risk === 'HIGH' ? 'danger' : clause.risk === 'MEDIUM' ? 'warning' : 'success'} size="xs">
                  {clause.risk}
                </Badge>
              </div>
            ))}
          </div>
          
          <div className="mt-4 pt-4 border-t border-slate-700">
            <p className="text-xs text-slate-400">
              These clauses must be included in all subcontracts. Generate a compliance matrix for teaming partners.
            </p>
          </div>
        </Card>
      );
    };

    // ============================================================================
    // STATS DASHBOARD
    // ============================================================================
    const StatsDashboard = ({ clauses }) => {
      const stats = {
        total: clauses.length,
        high: clauses.filter(c => c.risk === 'HIGH').length,
        medium: clauses.filter(c => c.risk === 'MEDIUM').length,
        low: clauses.filter(c => c.risk === 'LOW').length,
        traps: clauses.filter(c => c.isTrap).length,
        flowDown: clauses.filter(c => c.flowDown).length
      };
      
      return (
        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6">
          <Card className="p-4 text-center">
            <div className="text-2xl font-bold text-white">{stats.total}</div>
            <div className="text-xs text-slate-400">Total Clauses</div>
          </Card>
          <Card className="p-4 text-center border-red-500/30">
            <div className="text-2xl font-bold text-red-400">{stats.high}</div>
            <div className="text-xs text-slate-400">High Risk</div>
          </Card>
          <Card className="p-4 text-center border-amber-500/30">
            <div className="text-2xl font-bold text-amber-400">{stats.medium}</div>
            <div className="text-xs text-slate-400">Medium Risk</div>
          </Card>
          <Card className="p-4 text-center border-emerald-500/30">
            <div className="text-2xl font-bold text-emerald-400">{stats.low}</div>
            <div className="text-xs text-slate-400">Low Risk</div>
          </Card>
          <Card className="p-4 text-center border-red-500/30">
            <div className="text-2xl font-bold text-red-400">{stats.traps}</div>
            <div className="text-xs text-slate-400">Trap Clauses</div>
          </Card>
          <Card className="p-4 text-center border-purple-500/30">
            <div className="text-2xl font-bold text-purple-400">{stats.flowDown}</div>
            <div className="text-xs text-slate-400">Flow-Down</div>
          </Card>
        </div>
      );
    };

    // ============================================================================
    // MAIN APP COMPONENT
    // ============================================================================
    const ContractsAnalyzer = () => {
      const [currentRole, setCurrentRole] = useState('CON');
      const [searchTerm, setSearchTerm] = useState('');
      const [filterRisk, setFilterRisk] = useState('all');
      const [filterCategory, setFilterCategory] = useState('all');
      const [filterSection, setFilterSection] = useState('all');
      const [expandedClause, setExpandedClause] = useState(null);
      const [checkedItems, setCheckedItems] = useState([]);
      const [showFlowDown, setShowFlowDown] = useState(false);
      
      const role = ROLES[currentRole];
      const hasFullAccess = role.access === 'full';
      
      // Filter clauses
      const filteredClauses = useMemo(() => {
        return CLAUSES_DATA.filter(clause => {
          if (searchTerm && !clause.clause.toLowerCase().includes(searchTerm.toLowerCase()) && 
              !clause.title.toLowerCase().includes(searchTerm.toLowerCase())) return false;
          if (filterRisk !== 'all' && clause.risk !== filterRisk) return false;
          if (filterCategory !== 'all' && clause.category !== filterCategory) return false;
          if (filterSection !== 'all' && clause.section !== filterSection) return false;
          return true;
        });
      }, [searchTerm, filterRisk, filterCategory, filterSection]);
      
      const categories = [...new Set(CLAUSES_DATA.map(c => c.category))];
      const sections = [...new Set(CLAUSES_DATA.map(c => c.section))];
      
      const toggleCheckItem = (id) => {
        setCheckedItems(prev => 
          prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]
        );
      };

      return (
        <div className="min-h-screen bg-[#00050F]">
          {/* Header */}
          <header className="bg-slate-900/80 border-b border-slate-700/50 px-6 py-4 sticky top-0 z-40">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-4">
                <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-cyan-500 to-teal-500 flex items-center justify-center shadow-lg shadow-cyan-500/30">
                  <Icon name="scale" className="w-6 h-6 text-white" />
                </div>
                <div>
                  <h1 className="text-xl font-bold text-white">MissionPulse <span className="text-cyan-400">Contracts Analyzer</span></h1>
                  <p className="text-slate-400 text-sm">M5 ‚Ä¢ FAR/DFARS Clause Analysis ‚Ä¢ Section L/M Parser</p>
                </div>
              </div>
              <RoleSelector currentRole={currentRole} onRoleChange={setCurrentRole} />
            </div>
          </header>

          {/* RBAC Status Bar */}
          <div className={`px-6 py-2 border-b ${hasFullAccess ? 'bg-emerald-500/10 border-emerald-500/30' : 'bg-amber-500/10 border-amber-500/30'}`}>
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <Icon name={hasFullAccess ? 'unlock' : 'lock'} className={`w-4 h-4 ${hasFullAccess ? 'text-emerald-400' : 'text-amber-400'}`} />
                <span className={`text-sm font-medium ${hasFullAccess ? 'text-emerald-400' : 'text-amber-400'}`}>
                  {hasFullAccess ? 'Full Access Mode' : 'Read-Only Mode'} ‚Äî {role.label}
                </span>
              </div>
              {!hasFullAccess && (
                <span className="text-xs text-slate-400">
                  Some sensitive clause details are hidden. Contact Contracts Lead (CON) for full access.
                </span>
              )}
            </div>
          </div>

          <div className="p-6">
            {/* Stats Dashboard */}
            <StatsDashboard clauses={CLAUSES_DATA} />
            
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
              {/* Main Content */}
              <div className="lg:col-span-2 space-y-4">
                {/* Search & Filters */}
                <Card className="p-4">
                  <div className="flex flex-wrap gap-4">
                    <div className="flex-1 min-w-[200px]">
                      <div className="relative">
                        <Icon name="search" className="w-4 h-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2" />
                        <input
                          type="text"
                          placeholder="Search clauses..."
                          value={searchTerm}
                          onChange={(e) => setSearchTerm(e.target.value)}
                          className="w-full pl-10 pr-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-cyan-500"
                        />
                      </div>
                    </div>
                    <select
                      value={filterRisk}
                      onChange={(e) => setFilterRisk(e.target.value)}
                      className="px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-cyan-500"
                    >
                      <option value="all">All Risk Levels</option>
                      <option value="HIGH">üî¥ High Risk</option>
                      <option value="MEDIUM">üü° Medium Risk</option>
                      <option value="LOW">üü¢ Low Risk</option>
                      <option value="INFO">üîµ Info Only</option>
                    </select>
                    <select
                      value={filterCategory}
                      onChange={(e) => setFilterCategory(e.target.value)}
                      className="px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-cyan-500"
                    >
                      <option value="all">All Categories</option>
                      {categories.map(cat => (
                        <option key={cat} value={cat}>{cat}</option>
                      ))}
                    </select>
                    <select
                      value={filterSection}
                      onChange={(e) => setFilterSection(e.target.value)}
                      className="px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-cyan-500"
                    >
                      <option value="all">All Sections</option>
                      {sections.map(sec => (
                        <option key={sec} value={sec}>Section {sec}</option>
                      ))}
                    </select>
                  </div>
                </Card>
                
                {/* Clauses List */}
                <div className="space-y-4">
                  {filteredClauses.length === 0 ? (
                    <Card className="p-8 text-center">
                      <Icon name="search" className="w-12 h-12 text-slate-600 mx-auto mb-4" />
                      <p className="text-slate-400">No clauses match your search criteria</p>
                    </Card>
                  ) : (
                    filteredClauses.map(clause => (
                      <ClauseCard
                        key={clause.id}
                        clause={clause}
                        isExpanded={expandedClause === clause.id}
                        onToggle={(id) => setExpandedClause(expandedClause === id ? null : id)}
                        hasFullAccess={hasFullAccess}
                      />
                    ))
                  )}
                </div>
              </div>
              
              {/* Sidebar */}
              <div className="space-y-6">
                <ComplianceChecklist 
                  checkedItems={checkedItems} 
                  onToggle={toggleCheckItem} 
                />
                <FlowDownTracker clauses={CLAUSES_DATA} />
              </div>
            </div>
          </div>

          {/* Footer */}
          <footer className="mt-8 px-6 py-4 border-t border-slate-800">
            <div className="flex items-center justify-between text-xs text-slate-500">
              <div className="flex items-center gap-2">
                <div className="w-2 h-2 rounded-full bg-cyan-500 animate-pulse" />
                MissionPulse M5 ‚Ä¢ Contracts Analyzer v12.0
              </div>
              <div className="font-medium text-amber-500">AI GENERATED - REQUIRES HUMAN REVIEW</div>
              <div>¬© 2026 Mission Meets Tech</div>
            </div>
          </footer>
        </div>
      );
    };

    ReactDOM.render(<ContractsAnalyzer />, document.getElementById('root'));
  </script>
<script src="shared-nav.js"></script></body>
</html>
