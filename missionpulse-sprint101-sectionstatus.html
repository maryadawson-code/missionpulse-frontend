<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Section Status Tracker - MissionPulse</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'mp-navy': '#00050F',
                        'mp-cyan': '#00E5FA',
                        'mp-slate': '#0A1628',
                        'mp-dark': '#020817'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        * { font-family: 'Inter', sans-serif; }
        .glow-cyan { box-shadow: 0 0 20px rgba(0, 229, 250, 0.3); }
        .status-cell { min-width: 80px; }
    </style>
</head>
<body class="bg-mp-navy text-white min-h-screen">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useMemo } = React;

        // Color team stages in order
        const colorTeams = [
            { id: 'draft', name: 'Draft', color: '#64748B', bgColor: 'bg-slate-500/20' },
            { id: 'pink', name: 'Pink', color: '#EC4899', bgColor: 'bg-pink-500/20' },
            { id: 'red', name: 'Red', color: '#EF4444', bgColor: 'bg-red-500/20' },
            { id: 'gold', name: 'Gold', color: '#F59E0B', bgColor: 'bg-yellow-500/20' },
            { id: 'final', name: 'Final', color: '#10B981', bgColor: 'bg-green-500/20' }
        ];

        // Status within each stage
        const stageStatuses = {
            not_started: { label: 'Not Started', icon: '○', color: 'text-slate-500' },
            in_progress: { label: 'In Progress', icon: '◐', color: 'text-yellow-400' },
            in_review: { label: 'In Review', icon: '◑', color: 'text-blue-400' },
            complete: { label: 'Complete', icon: '●', color: 'text-green-400' },
            blocked: { label: 'Blocked', icon: '⊘', color: 'text-red-400' }
        };

        // Demo sections with status tracking
        const initialSections = [
            {
                id: 1,
                number: '1.0',
                title: 'Executive Summary',
                volume: 'Technical',
                owner: 'Sarah Chen',
                pageTarget: 5,
                currentPages: 4,
                stages: {
                    draft: { status: 'complete', date: '2025-01-20', reviewer: null },
                    pink: { status: 'complete', date: '2025-01-25', reviewer: 'Mike T.' },
                    red: { status: 'in_progress', date: null, reviewer: 'Jennifer W.' },
                    gold: { status: 'not_started', date: null, reviewer: null },
                    final: { status: 'not_started', date: null, reviewer: null }
                },
                comments: 3,
                blockers: 0
            },
            {
                id: 2,
                number: '2.1',
                title: 'Understanding of Requirements',
                volume: 'Technical',
                owner: 'Michael Brown',
                pageTarget: 8,
                currentPages: 7,
                stages: {
                    draft: { status: 'complete', date: '2025-01-18', reviewer: null },
                    pink: { status: 'complete', date: '2025-01-22', reviewer: 'Lisa A.' },
                    red: { status: 'complete', date: '2025-01-27', reviewer: 'Sarah C.' },
                    gold: { status: 'in_review', date: null, reviewer: 'James M.' },
                    final: { status: 'not_started', date: null, reviewer: null }
                },
                comments: 5,
                blockers: 0
            },
            {
                id: 3,
                number: '2.2',
                title: 'Technical Solution',
                volume: 'Technical',
                owner: 'Jennifer Taylor',
                pageTarget: 15,
                currentPages: 13,
                stages: {
                    draft: { status: 'complete', date: '2025-01-22', reviewer: null },
                    pink: { status: 'complete', date: '2025-01-26', reviewer: 'Robert K.' },
                    red: { status: 'in_progress', date: null, reviewer: 'Emily D.' },
                    gold: { status: 'not_started', date: null, reviewer: null },
                    final: { status: 'not_started', date: null, reviewer: null }
                },
                comments: 8,
                blockers: 1
            },
            {
                id: 4,
                number: '2.3',
                title: 'Transition Plan',
                volume: 'Technical',
                owner: 'David Wilson',
                pageTarget: 8,
                currentPages: 6,
                stages: {
                    draft: { status: 'complete', date: '2025-01-25', reviewer: null },
                    pink: { status: 'in_review', date: null, reviewer: 'Sarah C.' },
                    red: { status: 'not_started', date: null, reviewer: null },
                    gold: { status: 'not_started', date: null, reviewer: null },
                    final: { status: 'not_started', date: null, reviewer: null }
                },
                comments: 2,
                blockers: 0
            },
            {
                id: 5,
                number: '2.4',
                title: 'Quality Assurance',
                volume: 'Technical',
                owner: 'Lisa Anderson',
                pageTarget: 9,
                currentPages: 5,
                stages: {
                    draft: { status: 'in_progress', date: null, reviewer: null },
                    pink: { status: 'not_started', date: null, reviewer: null },
                    red: { status: 'not_started', date: null, reviewer: null },
                    gold: { status: 'not_started', date: null, reviewer: null },
                    final: { status: 'not_started', date: null, reviewer: null }
                },
                comments: 1,
                blockers: 0
            },
            {
                id: 6,
                number: '3.1',
                title: 'Program Management',
                volume: 'Management',
                owner: 'Sarah Chen',
                pageTarget: 10,
                currentPages: 8,
                stages: {
                    draft: { status: 'complete', date: '2025-01-23', reviewer: null },
                    pink: { status: 'complete', date: '2025-01-27', reviewer: 'David W.' },
                    red: { status: 'in_review', date: null, reviewer: 'Michael B.' },
                    gold: { status: 'not_started', date: null, reviewer: null },
                    final: { status: 'not_started', date: null, reviewer: null }
                },
                comments: 4,
                blockers: 0
            },
            {
                id: 7,
                number: '3.2',
                title: 'Staffing Plan',
                volume: 'Management',
                owner: 'Emily Davis',
                pageTarget: 12,
                currentPages: 10,
                stages: {
                    draft: { status: 'complete', date: '2025-01-24', reviewer: null },
                    pink: { status: 'in_progress', date: null, reviewer: 'HR Team' },
                    red: { status: 'not_started', date: null, reviewer: null },
                    gold: { status: 'not_started', date: null, reviewer: null },
                    final: { status: 'not_started', date: null, reviewer: null }
                },
                comments: 6,
                blockers: 2
            },
            {
                id: 8,
                number: '3.3',
                title: 'Risk Management',
                volume: 'Management',
                owner: 'James Miller',
                pageTarget: 8,
                currentPages: 3,
                stages: {
                    draft: { status: 'in_progress', date: null, reviewer: null },
                    pink: { status: 'not_started', date: null, reviewer: null },
                    red: { status: 'not_started', date: null, reviewer: null },
                    gold: { status: 'not_started', date: null, reviewer: null },
                    final: { status: 'not_started', date: null, reviewer: null }
                },
                comments: 0,
                blockers: 0
            },
            {
                id: 9,
                number: '4.1',
                title: 'Past Performance Reference 1',
                volume: 'Past Performance',
                owner: 'Robert Kim',
                pageTarget: 5,
                currentPages: 5,
                stages: {
                    draft: { status: 'complete', date: '2025-01-15', reviewer: null },
                    pink: { status: 'complete', date: '2025-01-19', reviewer: 'Contracts' },
                    red: { status: 'complete', date: '2025-01-23', reviewer: 'Legal' },
                    gold: { status: 'complete', date: '2025-01-26', reviewer: 'Sarah C.' },
                    final: { status: 'complete', date: '2025-01-28', reviewer: 'CEO' }
                },
                comments: 0,
                blockers: 0
            },
            {
                id: 10,
                number: '4.2',
                title: 'Past Performance Reference 2',
                volume: 'Past Performance',
                owner: 'Robert Kim',
                pageTarget: 5,
                currentPages: 5,
                stages: {
                    draft: { status: 'complete', date: '2025-01-16', reviewer: null },
                    pink: { status: 'complete', date: '2025-01-20', reviewer: 'Contracts' },
                    red: { status: 'complete', date: '2025-01-24', reviewer: 'Legal' },
                    gold: { status: 'complete', date: '2025-01-27', reviewer: 'Sarah C.' },
                    final: { status: 'in_review', date: null, reviewer: 'CEO' }
                },
                comments: 1,
                blockers: 0
            }
        ];

        function SectionStatusTracker() {
            const [sections, setSections] = useState(initialSections);
            const [selectedVolume, setSelectedVolume] = useState('all');
            const [selectedStage, setSelectedStage] = useState('all');
            const [showDetail, setShowDetail] = useState(null);

            const volumes = [...new Set(sections.map(s => s.volume))];

            const filteredSections = useMemo(() => {
                return sections.filter(section => {
                    if (selectedVolume !== 'all' && section.volume !== selectedVolume) return false;
                    return true;
                });
            }, [sections, selectedVolume]);

            const getCurrentStage = (section) => {
                for (let i = colorTeams.length - 1; i >= 0; i--) {
                    const stage = colorTeams[i];
                    const stageData = section.stages[stage.id];
                    if (stageData.status === 'complete') {
                        if (i < colorTeams.length - 1) {
                            return colorTeams[i + 1];
                        }
                        return stage;
                    }
                    if (stageData.status === 'in_progress' || stageData.status === 'in_review') {
                        return stage;
                    }
                }
                return colorTeams[0];
            };

            const getOverallProgress = (section) => {
                let completed = 0;
                colorTeams.forEach(team => {
                    if (section.stages[team.id].status === 'complete') completed++;
                });
                return (completed / colorTeams.length) * 100;
            };

            const stats = useMemo(() => {
                const stageCounts = {};
                colorTeams.forEach(team => {
                    stageCounts[team.id] = {
                        complete: 0,
                        inProgress: 0,
                        notStarted: 0
                    };
                });

                filteredSections.forEach(section => {
                    colorTeams.forEach(team => {
                        const status = section.stages[team.id].status;
                        if (status === 'complete') stageCounts[team.id].complete++;
                        else if (status === 'in_progress' || status === 'in_review') stageCounts[team.id].inProgress++;
                        else stageCounts[team.id].notStarted++;
                    });
                });

                return {
                    total: filteredSections.length,
                    finalComplete: stageCounts.final.complete,
                    blockedCount: filteredSections.reduce((sum, s) => sum + s.blockers, 0),
                    stageCounts
                };
            }, [filteredSections]);

            const updateSectionStatus = (sectionId, stageId, newStatus) => {
                setSections(sections.map(s => {
                    if (s.id === sectionId) {
                        return {
                            ...s,
                            stages: {
                                ...s.stages,
                                [stageId]: {
                                    ...s.stages[stageId],
                                    status: newStatus,
                                    date: newStatus === 'complete' ? new Date().toISOString().split('T')[0] : s.stages[stageId].date
                                }
                            }
                        };
                    }
                    return s;
                }));
            };

            return (
                <div className="min-h-screen bg-mp-navy">
                    {/* Header */}
                    <header className="bg-mp-slate/50 border-b border-mp-cyan/20 px-6 py-4">
                        <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                            <div>
                                <h1 className="text-2xl font-bold text-white">Section Status Tracker</h1>
                                <p className="text-sm text-slate-400 mt-1">Color Team Progress • DHA EHR Modernization</p>
                            </div>
                            <div className="flex items-center gap-3">
                                <select 
                                    value={selectedVolume}
                                    onChange={(e) => setSelectedVolume(e.target.value)}
                                    className="bg-mp-slate border border-mp-cyan/30 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-mp-cyan"
                                >
                                    <option value="all">All Volumes</option>
                                    {volumes.map(vol => (
                                        <option key={vol} value={vol}>{vol}</option>
                                    ))}
                                </select>
                            </div>
                        </div>
                    </header>

                    <main className="p-6">
                        {/* Stats Bar */}
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                            <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-lg p-4">
                                <div className="text-2xl font-bold text-white">{stats.total}</div>
                                <div className="text-xs text-slate-400">Total Sections</div>
                            </div>
                            <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-lg p-4">
                                <div className="text-2xl font-bold text-green-400">{stats.finalComplete}</div>
                                <div className="text-xs text-slate-400">Final Complete</div>
                            </div>
                            <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-lg p-4">
                                <div className="text-2xl font-bold text-mp-cyan">
                                    {Math.round((stats.finalComplete / stats.total) * 100)}%
                                </div>
                                <div className="text-xs text-slate-400">Overall Progress</div>
                            </div>
                            <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-lg p-4">
                                <div className="text-2xl font-bold text-red-400">{stats.blockedCount}</div>
                                <div className="text-xs text-slate-400">Blockers</div>
                            </div>
                        </div>

                        {/* Stage Progress Overview */}
                        <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-xl p-4 mb-6">
                            <h3 className="text-sm font-medium text-white mb-4">Stage Progress Overview</h3>
                            <div className="grid grid-cols-5 gap-2">
                                {colorTeams.map(team => {
                                    const counts = stats.stageCounts[team.id];
                                    const percent = Math.round((counts.complete / stats.total) * 100);
                                    return (
                                        <div key={team.id} className="text-center">
                                            <div className={`${team.bgColor} rounded-lg p-3 mb-2`}>
                                                <div className="text-lg font-bold" style={{ color: team.color }}>
                                                    {counts.complete}/{stats.total}
                                                </div>
                                                <div className="text-xs text-slate-400">{team.name}</div>
                                            </div>
                                            <div className="h-1 bg-mp-navy rounded-full overflow-hidden">
                                                <div 
                                                    className="h-full rounded-full transition-all duration-500"
                                                    style={{ width: `${percent}%`, backgroundColor: team.color }}
                                                />
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        {/* Section Status Matrix */}
                        <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-xl overflow-hidden">
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead>
                                        <tr className="bg-mp-navy/50 border-b border-mp-cyan/20">
                                            <th className="text-left px-4 py-3 text-xs text-slate-400 uppercase tracking-wide">Section</th>
                                            <th className="text-left px-4 py-3 text-xs text-slate-400 uppercase tracking-wide">Owner</th>
                                            <th className="text-left px-4 py-3 text-xs text-slate-400 uppercase tracking-wide">Pages</th>
                                            {colorTeams.map(team => (
                                                <th 
                                                    key={team.id} 
                                                    className="px-2 py-3 text-xs uppercase tracking-wide status-cell text-center"
                                                    style={{ color: team.color }}
                                                >
                                                    {team.name}
                                                </th>
                                            ))}
                                            <th className="text-center px-4 py-3 text-xs text-slate-400 uppercase tracking-wide">Progress</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {filteredSections.map((section) => {
                                            const currentStage = getCurrentStage(section);
                                            const progress = getOverallProgress(section);
                                            return (
                                                <tr 
                                                    key={section.id}
                                                    className="border-b border-mp-cyan/10 hover:bg-mp-navy/30 cursor-pointer"
                                                    onClick={() => setShowDetail(section)}
                                                >
                                                    <td className="px-4 py-3">
                                                        <div className="flex items-center gap-2">
                                                            <span className="text-mp-cyan font-mono text-sm">{section.number}</span>
                                                            <span className="text-white font-medium">{section.title}</span>
                                                            {section.blockers > 0 && (
                                                                <span className="text-xs bg-red-500/20 text-red-400 px-1.5 py-0.5 rounded">
                                                                    ⚠ {section.blockers}
                                                                </span>
                                                            )}
                                                        </div>
                                                        <div className="text-xs text-slate-500 mt-1">{section.volume}</div>
                                                    </td>
                                                    <td className="px-4 py-3 text-sm text-slate-300">{section.owner}</td>
                                                    <td className="px-4 py-3">
                                                        <span className={`text-sm ${section.currentPages > section.pageTarget ? 'text-red-400' : 'text-slate-300'}`}>
                                                            {section.currentPages}/{section.pageTarget}
                                                        </span>
                                                    </td>
                                                    {colorTeams.map(team => {
                                                        const stageData = section.stages[team.id];
                                                        const statusInfo = stageStatuses[stageData.status];
                                                        return (
                                                            <td key={team.id} className="px-2 py-3 text-center status-cell">
                                                                <button
                                                                    onClick={(e) => {
                                                                        e.stopPropagation();
                                                                        // Cycle through statuses
                                                                        const statusOrder = ['not_started', 'in_progress', 'in_review', 'complete'];
                                                                        const currentIdx = statusOrder.indexOf(stageData.status);
                                                                        const nextIdx = (currentIdx + 1) % statusOrder.length;
                                                                        updateSectionStatus(section.id, team.id, statusOrder[nextIdx]);
                                                                    }}
                                                                    className={`text-lg ${statusInfo.color} hover:opacity-80 transition-opacity`}
                                                                    title={statusInfo.label}
                                                                >
                                                                    {statusInfo.icon}
                                                                </button>
                                                            </td>
                                                        );
                                                    })}
                                                    <td className="px-4 py-3">
                                                        <div className="w-20 mx-auto">
                                                            <div className="h-2 bg-mp-navy rounded-full overflow-hidden">
                                                                <div 
                                                                    className="h-full bg-mp-cyan rounded-full transition-all duration-300"
                                                                    style={{ width: `${progress}%` }}
                                                                />
                                                            </div>
                                                            <div className="text-xs text-slate-400 text-center mt-1">{Math.round(progress)}%</div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        {/* Legend */}
                        <div className="flex flex-wrap gap-4 mt-4 text-xs text-slate-400">
                            {Object.entries(stageStatuses).map(([key, value]) => (
                                <div key={key} className="flex items-center gap-2">
                                    <span className={`text-lg ${value.color}`}>{value.icon}</span>
                                    <span>{value.label}</span>
                                </div>
                            ))}
                            <span className="ml-auto text-slate-500">Click status icons to cycle through states</span>
                        </div>
                    </main>

                    {/* Detail Modal */}
                    {showDetail && (
                        <div className="fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4" onClick={() => setShowDetail(null)}>
                            <div className="bg-mp-slate border border-mp-cyan/30 rounded-xl p-6 max-w-lg w-full" onClick={e => e.stopPropagation()}>
                                <div className="flex justify-between items-start mb-4">
                                    <div>
                                        <span className="text-mp-cyan font-mono">{showDetail.number}</span>
                                        <h2 className="text-xl font-bold text-white">{showDetail.title}</h2>
                                        <p className="text-sm text-slate-400">{showDetail.volume} Volume</p>
                                    </div>
                                    <button 
                                        onClick={() => setShowDetail(null)}
                                        className="text-slate-400 hover:text-white text-xl"
                                    >
                                        ×
                                    </button>
                                </div>

                                {/* Owner & Pages */}
                                <div className="grid grid-cols-2 gap-4 mb-6">
                                    <div className="bg-mp-navy/50 rounded-lg p-3">
                                        <div className="text-xs text-slate-500">Owner</div>
                                        <div className="text-white font-medium">{showDetail.owner}</div>
                                    </div>
                                    <div className="bg-mp-navy/50 rounded-lg p-3">
                                        <div className="text-xs text-slate-500">Page Count</div>
                                        <div className={`font-medium ${showDetail.currentPages > showDetail.pageTarget ? 'text-red-400' : 'text-white'}`}>
                                            {showDetail.currentPages} / {showDetail.pageTarget}
                                        </div>
                                    </div>
                                </div>

                                {/* Stage Timeline */}
                                <div className="mb-6">
                                    <h3 className="text-sm font-medium text-white mb-3">Review Timeline</h3>
                                    <div className="space-y-3">
                                        {colorTeams.map((team, idx) => {
                                            const stageData = showDetail.stages[team.id];
                                            const statusInfo = stageStatuses[stageData.status];
                                            return (
                                                <div 
                                                    key={team.id}
                                                    className={`flex items-center gap-3 p-3 rounded-lg ${team.bgColor}`}
                                                >
                                                    <div className="w-16 font-medium" style={{ color: team.color }}>
                                                        {team.name}
                                                    </div>
                                                    <div className="flex-1">
                                                        <div className="flex items-center gap-2">
                                                            <span className={`${statusInfo.color}`}>{statusInfo.icon}</span>
                                                            <span className="text-sm text-white">{statusInfo.label}</span>
                                                        </div>
                                                        {stageData.reviewer && (
                                                            <div className="text-xs text-slate-400 mt-1">
                                                                Reviewer: {stageData.reviewer}
                                                            </div>
                                                        )}
                                                    </div>
                                                    <div className="text-xs text-slate-400">
                                                        {stageData.date || '-'}
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>

                                {/* Comments & Blockers */}
                                <div className="grid grid-cols-2 gap-4 mb-6">
                                    <div className="bg-mp-navy/50 rounded-lg p-3">
                                        <div className="text-xs text-slate-500">Comments</div>
                                        <div className="text-white font-medium">{showDetail.comments}</div>
                                    </div>
                                    <div className={`rounded-lg p-3 ${showDetail.blockers > 0 ? 'bg-red-500/20' : 'bg-mp-navy/50'}`}>
                                        <div className="text-xs text-slate-500">Blockers</div>
                                        <div className={`font-medium ${showDetail.blockers > 0 ? 'text-red-400' : 'text-white'}`}>
                                            {showDetail.blockers}
                                        </div>
                                    </div>
                                </div>

                                {/* Actions */}
                                <div className="flex gap-3">
                                    <button className="flex-1 bg-mp-cyan text-mp-navy font-semibold py-2 rounded-lg hover:bg-mp-cyan/90">
                                        Open Section
                                    </button>
                                    <button className="flex-1 border border-slate-600 text-slate-300 py-2 rounded-lg hover:bg-mp-navy">
                                        Add Comment
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Footer */}
                    <footer className="bg-mp-slate/30 border-t border-mp-cyan/10 px-6 py-4 mt-8">
                        <div className="flex flex-col md:flex-row justify-between items-center gap-2 text-xs text-slate-500">
                            <span>AI GENERATED - REQUIRES HUMAN REVIEW</span>
                            <span>MissionPulse Section Status Tracker v1.0</span>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<SectionStatusTracker />, document.getElementById('root'));
    </script>
</body>
</html>
