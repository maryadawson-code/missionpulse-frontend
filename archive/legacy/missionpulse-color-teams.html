<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MissionPulse ‚Äî Color Team Reviews</title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:#00050F;min-height:100vh}@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}.fade-in{animation:fadeIn .3s ease-out forwards}</style>
  <script src="rbac-guard.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const SB_URL='https://djuviwarqdvlbgcfuupa.supabase.co';
const SB_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRqdXZpd2FycWR2bGJnY2Z1dXBhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc4MzUyMjQsImV4cCI6MjA1MzQxMTIyNH0.pBPL9l2zL7LLd_A5I--hPBzw5YwG3ajPMtbYsqsxIgQ';
var sbClient=null;let connected=false;
try{sbClient=supabase.createClient(SB_URL,SB_KEY);connected=true}catch(e){}

const TEAMS=[
  {id:'blue',name:'Blue Team',color:'#3B82F6',bgClass:'bg-blue-500',purpose:'Initial draft review ‚Äî compliance & completeness check',date:'2026-03-05',status:'complete',score:72,reviewers:['Sarah Johnson (PM)','Tom Garcia (QA)']},
  {id:'pink',name:'Pink Team',color:'#EC4899',bgClass:'bg-pink-500',purpose:'Strategy & win theme alignment review',date:'2026-03-10',status:'complete',score:81,reviewers:['Mary Womack (CEO)','Mike Chen (SA)','James Wilson (CAP)']},
  {id:'red',name:'Red Team',color:'#EF4444',bgClass:'bg-red-500',purpose:'Final content review ‚Äî evaluator simulation',date:'2026-03-15',status:'in_progress',score:88,reviewers:['External SME Panel','Lisa Brown (CON)','Anna Lee (SA)']},
  {id:'gold',name:'Gold Team',color:'#FBBF24',bgClass:'bg-amber-500',purpose:'Executive review ‚Äî Go/No-Go final decision',date:'2026-03-18',status:'scheduled',score:null,reviewers:['Mary Womack (CEO)','COO Review']},
];

const DEMO_FINDINGS=[
  {id:1,team:'blue',section:'Technical Volume ¬ß3.2',severity:'major',finding:'Missing scalability discussion for 10K+ concurrent users',status:'resolved',assignee:'Mike Chen',resolution:'Added ¬ß3.2.4 Scalability Architecture with auto-scaling diagram'},
  {id:2,team:'blue',section:'Management Vol ¬ß2.1',severity:'minor',finding:'Org chart missing deputy PM role',status:'resolved',assignee:'Sarah Johnson',resolution:'Updated org chart with Deputy PM reporting structure'},
  {id:3,team:'blue',section:'Compliance Matrix',severity:'critical',finding:'3 SOW requirements unmapped in L/M matrix',status:'resolved',assignee:'Tom Garcia',resolution:'Mapped SOW ¬ß¬ß4.3, 4.7, 4.9 to proposal sections'},
  {id:4,team:'pink',section:'Executive Summary',severity:'major',finding:'Win theme #2 not clearly discriminated from incumbents approach',status:'resolved',assignee:'James Wilson',resolution:'Rewrote discriminator with quantified proof points'},
  {id:5,team:'pink',section:'Technical Volume ¬ß4.1',severity:'minor',finding:'Innovation section reads generic ‚Äî needs DHA-specific examples',status:'resolved',assignee:'Mike Chen',resolution:'Added 3 DHA-specific use cases with measurable outcomes'},
  {id:6,team:'pink',section:'Past Performance ¬ß1.3',severity:'minor',finding:'VA contract narrative lacks CPARS citation',status:'open',assignee:'Sarah Johnson',resolution:''},
  {id:7,team:'red',section:'Technical Volume ¬ß3.1',severity:'major',finding:'Solution architecture diagram inconsistent with ¬ß3.4 narrative',status:'open',assignee:'Mike Chen',resolution:''},
  {id:8,team:'red',section:'Pricing Volume ¬ß2.2',severity:'critical',finding:'FTE ramp schedule does not align with transition plan dates',status:'open',assignee:'James Wilson',resolution:''},
  {id:9,team:'red',section:'Management Vol ¬ß3.1',severity:'minor',finding:'Risk #7 mitigation strategy too vague',status:'open',assignee:'Sarah Johnson',resolution:''},
  {id:10,team:'red',section:'Executive Summary p.2',severity:'minor',finding:'Ghost statement on competitor X needs stronger proof point',status:'open',assignee:'Mary Womack',resolution:''},
  {id:11,team:'red',section:'Technical Volume ¬ß5.2',severity:'major',finding:'Cybersecurity approach missing NIST 800-171 control mapping',status:'open',assignee:'Lisa Brown',resolution:''},
  {id:12,team:'red',section:'Past Performance ¬ß2.1',severity:'minor',finding:'DHA MHS Genesis narrative exceeds page limit by 0.5 pages',status:'open',assignee:'Tom Garcia',resolution:''},
];

const SEV_COLORS={critical:'text-red-400 bg-red-500/10',major:'text-amber-400 bg-amber-500/10',minor:'text-blue-400 bg-blue-500/10'};
const STATUS_COLORS={open:'text-amber-400 bg-amber-500/10',resolved:'text-green-400 bg-green-500/10'};

function App(){
  const[tab,setTab]=React.useState('pipeline');
  const[filterTeam,setFilterTeam]=React.useState('all');
  const[filterStatus,setFilterStatus]=React.useState('all');

  const filtered=DEMO_FINDINGS.filter(f=>(filterTeam==='all'||f.team===filterTeam)&&(filterStatus==='all'||f.status===filterStatus));
  const resolved=DEMO_FINDINGS.filter(f=>f.status==='resolved').length;
  const open=DEMO_FINDINGS.filter(f=>f.status==='open').length;
  const resRate=Math.round((resolved/DEMO_FINDINGS.length)*100);

  return(
    <div className="min-h-screen p-6 max-w-6xl mx-auto">
      <div className="flex items-center justify-between mb-6">
        <div><a href="index.html" className="text-cyan-400 text-xs hover:underline mb-1 inline-block">‚Üê Dashboard</a><h1 className="text-2xl font-extrabold text-white">Color Team Reviews</h1><p className="text-sm text-gray-500">4-stage quality pipeline ¬∑ {DEMO_FINDINGS.length} findings</p></div>
        <span className={`px-3 py-1 rounded-full text-xs font-mono font-semibold ${connected?'bg-green-500/10 text-green-400':'bg-red-500/10 text-red-400'}`}>{connected?'LIVE':'DEMO'}</span>
      </div>

      {/* Score progression */}
      <div className="bg-[#0a1628] border border-gray-800 rounded-lg p-4 mb-6">
        <div className="text-xs text-gray-500 mb-3 font-medium">Score Progression</div>
        <div className="flex items-end gap-6 h-24">
          {TEAMS.map(t=>(
            <div key={t.id} className="flex-1 flex flex-col items-center gap-1">
              {t.score!==null?(
                <><div className="w-full rounded-t" style={{height:`${t.score}%`,background:t.color,minHeight:'8px'}}/><span className="text-xs font-bold text-white">{t.score}</span></>
              ):(<><div className="w-full h-8 rounded border border-dashed border-gray-700"/><span className="text-xs text-gray-600">TBD</span></>)}
              <span className="text-[10px] font-mono" style={{color:t.color}}>{t.name.split(' ')[0]}</span>
            </div>
          ))}
        </div>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-4 gap-4 mb-6">
        <div className="bg-[#0a1628] border border-gray-800 rounded-lg p-4 text-center"><div className="text-2xl font-extrabold text-green-400">{resolved}</div><div className="text-xs text-gray-500">Resolved</div></div>
        <div className="bg-[#0a1628] border border-gray-800 rounded-lg p-4 text-center"><div className="text-2xl font-extrabold text-amber-400">{open}</div><div className="text-xs text-gray-500">Open</div></div>
        <div className="bg-[#0a1628] border border-gray-800 rounded-lg p-4 text-center"><div className="text-2xl font-extrabold text-cyan-400">{resRate}%</div><div className="text-xs text-gray-500">Resolution Rate</div></div>
        <div className="bg-[#0a1628] border border-gray-800 rounded-lg p-4 text-center"><div className="text-2xl font-extrabold text-red-400">{DEMO_FINDINGS.filter(f=>f.severity==='critical').length}</div><div className="text-xs text-gray-500">Critical</div></div>
      </div>

      {/* Tabs */}
      <div className="flex gap-2 mb-4">
        {[['pipeline','Review Pipeline'],['findings','Findings Tracker']].map(([k,l])=>(
          <button key={k} onClick={()=>setTab(k)} className={`px-3 py-1.5 rounded-lg text-xs font-semibold ${tab===k?'bg-cyan-500/15 text-cyan-400 border border-cyan-500/30':'bg-[#0a1628] text-gray-500 border border-gray-800'}`}>{l}</button>
        ))}
      </div>

      {/* Pipeline */}
      {tab==='pipeline'&&(
        <div className="space-y-3">
          {TEAMS.map(team=>{
            const teamFindings=DEMO_FINDINGS.filter(f=>f.team===team.id);
            const teamResolved=teamFindings.filter(f=>f.status==='resolved').length;
            return(
              <div key={team.id} className="bg-[#0a1628] border border-gray-800 rounded-xl p-5 fade-in">
                <div className="flex items-center justify-between mb-3">
                  <div className="flex items-center gap-3">
                    <div className="w-4 h-4 rounded-full" style={{background:team.color}}/>
                    <div><span className="text-white font-semibold">{team.name}</span><span className={`ml-2 text-[10px] font-semibold px-2 py-0.5 rounded ${team.status==='complete'?'bg-green-500/10 text-green-400':team.status==='in_progress'?'bg-amber-500/10 text-amber-400':'bg-gray-500/10 text-gray-400'}`}>{team.status.replace('_',' ')}</span></div>
                  </div>
                  <span className="text-xs text-gray-500">{team.date}</span>
                </div>
                <p className="text-xs text-gray-400 mb-2">{team.purpose}</p>
                <div className="flex gap-4 text-[10px] text-gray-500 mb-2">{team.reviewers.map((r,i)=><span key={i}>üë§ {r}</span>)}</div>
                {teamFindings.length>0&&(
                  <div className="flex gap-3 text-xs"><span className="text-green-400">{teamResolved} resolved</span><span className="text-amber-400">{teamFindings.length-teamResolved} open</span><span className="text-gray-500">{teamFindings.length} total</span></div>
                )}
                {team.score!==null&&<div className="mt-2 h-1.5 bg-gray-800 rounded-full"><div className="h-1.5 rounded-full" style={{width:`${team.score}%`,background:team.color}}/></div>}
              </div>
            );
          })}
        </div>
      )}

      {/* Findings */}
      {tab==='findings'&&(
        <div>
          <div className="flex gap-2 mb-4">
            <select value={filterTeam} onChange={e=>setFilterTeam(e.target.value)} className="bg-[#0a1628] border border-gray-800 rounded-lg px-3 py-1.5 text-xs text-white">
              <option value="all">All Teams</option>{TEAMS.map(t=><option key={t.id} value={t.id}>{t.name}</option>)}
            </select>
            <select value={filterStatus} onChange={e=>setFilterStatus(e.target.value)} className="bg-[#0a1628] border border-gray-800 rounded-lg px-3 py-1.5 text-xs text-white">
              <option value="all">All Status</option><option value="open">Open</option><option value="resolved">Resolved</option>
            </select>
          </div>
          <div className="space-y-2">
            {filtered.map(f=>(
              <div key={f.id} className="bg-[#0a1628] border border-gray-800 rounded-lg px-4 py-3 fade-in">
                <div className="flex items-center gap-2 mb-1">
                  <span className={`text-[10px] font-semibold px-1.5 py-0.5 rounded ${SEV_COLORS[f.severity]}`}>{f.severity}</span>
                  <span className={`text-[10px] font-semibold px-1.5 py-0.5 rounded ${STATUS_COLORS[f.status]}`}>{f.status}</span>
                  <span className="text-[10px] font-mono px-1.5 py-0.5 rounded" style={{color:TEAMS.find(t=>t.id===f.team)?.color,background:`${TEAMS.find(t=>t.id===f.team)?.color}15`}}>{f.team}</span>
                  <span className="text-xs text-gray-500 ml-auto">{f.section}</span>
                </div>
                <p className="text-sm text-white mb-1">{f.finding}</p>
                <div className="text-xs text-gray-500">Assigned: <span className="text-purple-400">{f.assignee}</span></div>
                {f.resolution&&<div className="text-xs text-green-400 mt-1">‚úì {f.resolution}</div>}
              </div>
            ))}
          </div>
        </div>
      )}

      <p className="text-center text-[10px] text-gray-600 mt-8 font-mono">‚ö†Ô∏è AI GENERATED ‚Äî REQUIRES HUMAN REVIEW | MissionPulse v12.0 ‚Äî Mission Meets Tech</p>
    </div>
  );
}
ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>
