<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse M16 - Admin Panel</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" type="image/png" href="MMT_icon_transparent.png">
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Space Grotesk', sans-serif; background: #00050F; min-height: 100vh; }
    .font-mono { font-family: 'JetBrains Mono', monospace; }
    
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    @keyframes glow { 0%, 100% { box-shadow: 0 0 20px rgba(0, 229, 250, 0.3); } 50% { box-shadow: 0 0 40px rgba(0, 229, 250, 0.6); } }
    @keyframes barFill { from { width: 0%; } }
    @keyframes statusBlink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    
    .animate-fade-up { animation: fadeInUp 0.6s ease-out forwards; }
    .animate-slide-in { animation: slideIn 0.5s ease-out forwards; }
    .animate-pulse { animation: pulse 2s ease-in-out infinite; }
    .animate-glow { animation: glow 2s ease-in-out infinite; }
    .animate-bar-fill { animation: barFill 1s ease-out forwards; }
    .animate-blink { animation: statusBlink 1.5s ease-in-out infinite; }
    
    .glass-card {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(15, 23, 42, 0.7) 100%);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 229, 250, 0.2);
    }
    
    .scrollbar-thin::-webkit-scrollbar { width: 6px; }
    .scrollbar-thin::-webkit-scrollbar-track { background: rgba(15, 23, 42, 0.5); border-radius: 3px; }
    .scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(0, 229, 250, 0.3); border-radius: 3px; }
    
    .table-header { background: rgba(0, 5, 15, 0.8); }
  </style>
  <script src="rbac-guard.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    // Icons Library
    const Icons = {
      settings: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>,
      users: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" /></svg>,
      shield: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>,
      document: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>,
      chip: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" /></svg>,
      database: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><ellipse cx="12" cy="5" rx="9" ry="3" strokeWidth={2}/><path strokeWidth={2} d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path strokeWidth={2} d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>,
      download: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>,
      trash: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>,
      edit: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>,
      plus: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>,
      check: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" /></svg>,
      x: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>,
      clock: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" strokeWidth={2}/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6l4 2" /></svg>,
      link: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" /></svg>,
      book: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>,
      wifi: () => <svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0" /></svg>,
    };

    const Icon = ({ name, className = "w-5 h-5" }) => {
      const IconComponent = Icons[name];
      return IconComponent ? <span className={`inline-block ${className}`}><IconComponent /></span> : null;
    };

    // Shipley Roles
    const SHIPLEY_ROLES = ['CEO', 'COO', 'CAP', 'PM', 'SA', 'FIN', 'CON', 'DEL', 'QA', 'Partner', 'Admin'];

    // Users Data
    const USERS_DATA = [
      { id: 1, name: 'Mary Womack', email: 'mwomack@missionmeetstech.com', role: 'CEO', status: 'active', lastLogin: '2 min ago' },
      { id: 2, name: 'Robert Chen', email: 'rchen@missionmeetstech.com', role: 'COO', status: 'active', lastLogin: '1 hour ago' },
      { id: 3, name: 'Jennifer Park', email: 'jpark@missionmeetstech.com', role: 'CAP', status: 'active', lastLogin: '30 min ago' },
      { id: 4, name: 'Marcus Williams', email: 'mwilliams@missionmeetstech.com', role: 'PM', status: 'active', lastLogin: '3 hours ago' },
      { id: 5, name: 'Sarah Chen', email: 'schen@missionmeetstech.com', role: 'SA', status: 'active', lastLogin: '45 min ago' },
      { id: 6, name: 'David Kim', email: 'dkim@missionmeetstech.com', role: 'FIN', status: 'active', lastLogin: '2 hours ago' },
      { id: 7, name: 'Michelle Torres', email: 'mtorres@missionmeetstech.com', role: 'CON', status: 'inactive', lastLogin: '2 days ago' },
      { id: 8, name: 'James Wilson', email: 'jwilson@partner.com', role: 'Partner', status: 'active', lastLogin: '1 day ago' },
    ];

    // RBAC Matrix
    const MODULES = ['M1 Intel', 'M2 War Room', 'M3 Swimlane', 'M4 Compliance', 'M5 Contracts', 'M6 Iron Dome', 'M7 Black Hat', 'M8 Pricing', 'M9 HITL', 'M10 Orals', 'M11 Frenemy', 'M12 Launch', 'M13 ROI', 'M14 Post-Award', 'M15 Lessons', 'M16 Admin'];

    const RBAC_MATRIX = {
      CEO: ['M1 Intel', 'M2 War Room', 'M3 Swimlane', 'M4 Compliance', 'M5 Contracts', 'M6 Iron Dome', 'M7 Black Hat', 'M8 Pricing', 'M9 HITL', 'M10 Orals', 'M11 Frenemy', 'M12 Launch', 'M13 ROI', 'M14 Post-Award', 'M15 Lessons', 'M16 Admin'],
      COO: ['M1 Intel', 'M2 War Room', 'M3 Swimlane', 'M4 Compliance', 'M5 Contracts', 'M6 Iron Dome', 'M7 Black Hat', 'M8 Pricing', 'M9 HITL', 'M10 Orals', 'M11 Frenemy', 'M12 Launch', 'M13 ROI', 'M14 Post-Award', 'M15 Lessons'],
      CAP: ['M1 Intel', 'M2 War Room', 'M3 Swimlane', 'M4 Compliance', 'M5 Contracts', 'M6 Iron Dome', 'M7 Black Hat', 'M8 Pricing', 'M9 HITL', 'M10 Orals', 'M11 Frenemy', 'M12 Launch', 'M15 Lessons'],
      PM: ['M2 War Room', 'M3 Swimlane', 'M4 Compliance', 'M9 HITL', 'M12 Launch', 'M14 Post-Award', 'M15 Lessons'],
      SA: ['M2 War Room', 'M3 Swimlane', 'M4 Compliance', 'M6 Iron Dome', 'M9 HITL', 'M15 Lessons'],
      FIN: ['M2 War Room', 'M5 Contracts', 'M8 Pricing', 'M9 HITL', 'M13 ROI', 'M15 Lessons'],
      CON: ['M2 War Room', 'M4 Compliance', 'M5 Contracts', 'M9 HITL', 'M15 Lessons'],
      DEL: ['M2 War Room', 'M3 Swimlane', 'M14 Post-Award', 'M15 Lessons'],
      QA: ['M2 War Room', 'M4 Compliance', 'M9 HITL', 'M12 Launch', 'M15 Lessons'],
      Partner: ['M2 War Room', 'M3 Swimlane', 'M4 Compliance'],
      Admin: ['M1 Intel', 'M2 War Room', 'M3 Swimlane', 'M4 Compliance', 'M5 Contracts', 'M6 Iron Dome', 'M7 Black Hat', 'M8 Pricing', 'M9 HITL', 'M10 Orals', 'M11 Frenemy', 'M12 Launch', 'M13 ROI', 'M14 Post-Award', 'M15 Lessons', 'M16 Admin'],
    };

    // Audit Log
    const AUDIT_LOG = [
      { id: 1, timestamp: '2026-01-27 14:32:15', user: 'Mary Womack', action: 'Login', resource: 'System', details: 'Successful login from 192.168.1.105' },
      { id: 2, timestamp: '2026-01-27 14:30:22', user: 'Jennifer Park', action: 'Update', resource: 'M2 War Room', details: 'Modified opportunity: DHA Healthcare Platform' },
      { id: 3, timestamp: '2026-01-27 14:28:45', user: 'David Kim', action: 'Export', resource: 'M8 Pricing', details: 'Exported BOE spreadsheet' },
      { id: 4, timestamp: '2026-01-27 14:15:33', user: 'Sarah Chen', action: 'Create', resource: 'M6 Iron Dome', details: 'Added new compliance item' },
      { id: 5, timestamp: '2026-01-27 13:58:12', user: 'Marcus Williams', action: 'Submit', resource: 'M12 Launch', details: 'Submitted proposal FA8052-26-R-0001' },
      { id: 6, timestamp: '2026-01-27 13:45:00', user: 'James Wilson', action: 'View', resource: 'M3 Swimlane', details: 'Partner accessed swimlane board' },
      { id: 7, timestamp: '2026-01-27 13:22:18', user: 'Robert Chen', action: 'Approve', resource: 'M9 HITL', details: 'Approved technical volume draft' },
      { id: 8, timestamp: '2026-01-27 12:55:44', user: 'System', action: 'Backup', resource: 'Database', details: 'Automatic daily backup completed' },
    ];

    // Playbook Lessons
    const PLAYBOOK_LESSONS = [
      { id: 1, title: 'Win Theme: Healthcare IT Expertise', category: 'Win Themes', quality: 5, uses: 12, lastUsed: '2 days ago' },
      { id: 2, title: 'Executive Summary Template', category: 'Templates', quality: 4, uses: 28, lastUsed: '1 day ago' },
      { id: 3, title: 'DHA Compliance Matrix', category: 'Compliance', quality: 5, uses: 8, lastUsed: '3 days ago' },
      { id: 4, title: 'SEWP Pricing Strategy', category: 'Pricing', quality: 3, uses: 5, lastUsed: '1 week ago' },
      { id: 5, title: 'Oral Presentation Tips', category: 'Orals', quality: 2, uses: 2, lastUsed: '2 weeks ago' },
      { id: 6, title: 'Past Performance Narrative', category: 'Past Performance', quality: 4, uses: 15, lastUsed: '4 days ago' },
    ];

    // Token Usage Data
    const TOKEN_USAGE = {
      current: 847234,
      limit: 1000000,
      cost: 42.36,
      monthlyBudget: 100,
      byAgent: [
        { agent: 'Capture Agent', tokens: 234567, cost: 11.73 },
        { agent: 'Strategy Agent', tokens: 189432, cost: 9.47 },
        { agent: 'Compliance Agent', tokens: 156789, cost: 7.84 },
        { agent: 'Pricing Agent', tokens: 134521, cost: 6.73 },
        { agent: 'Writer Agent', tokens: 98765, cost: 4.94 },
        { agent: 'Black Hat Agent', tokens: 33160, cost: 1.66 },
      ],
    };

    // Main Component
    const AdminPanel = () => {
      const [activeTab, setActiveTab] = useState('users');
      const [users, setUsers] = useState(USERS_DATA);
      const [showUserModal, setShowUserModal] = useState(false);
      const [editingUser, setEditingUser] = useState(null);
      const [supabaseStatus, setSupabaseStatus] = useState('connected');

      // Simulate connection check
      useEffect(() => {
        const interval = setInterval(() => {
          setSupabaseStatus(Math.random() > 0.1 ? 'connected' : 'checking');
        }, 5000);
        return () => clearInterval(interval);
      }, []);

      const tabs = [
        { id: 'users', label: 'User Management', icon: 'users' },
        { id: 'rbac', label: 'RBAC Matrix', icon: 'shield' },
        { id: 'audit', label: 'Audit Log', icon: 'document' },
        { id: 'tokens', label: 'Token Usage', icon: 'chip' },
        { id: 'playbook', label: 'Playbook Manager', icon: 'book' },
        { id: 'settings', label: 'System Settings', icon: 'settings' },
      ];

      const handleDeactivateUser = (userId) => {
        setUsers(users.map(u => u.id === userId ? { ...u, status: u.status === 'active' ? 'inactive' : 'active' } : u));
      };

      const tokenPercent = (TOKEN_USAGE.current / TOKEN_USAGE.limit) * 100;
      const costPercent = (TOKEN_USAGE.cost / TOKEN_USAGE.monthlyBudget) * 100;

      return (
        <div className="min-h-screen bg-[#00050F] text-white p-6">
          {/* Header */}
          <div className="max-w-7xl mx-auto mb-6">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-4">
                <div className="w-14 h-14 rounded-2xl bg-gradient-to-br from-rose-400 to-pink-500 flex items-center justify-center shadow-lg shadow-rose-500/30">
                  <Icon name="settings" className="w-7 h-7 text-white" />
                </div>
                <div>
                  <h1 className="text-2xl font-bold">M16: Admin Panel</h1>
                  <p className="text-slate-400 text-sm">System Administration ‚Ä¢ Admin Only</p>
                </div>
              </div>
              
              {/* Supabase Status */}
              <div className={`flex items-center gap-2 px-4 py-2 rounded-xl ${
                supabaseStatus === 'connected' ? 'bg-emerald-500/20 border border-emerald-500/30' : 'bg-amber-500/20 border border-amber-500/30'
              }`}>
                <div className={`w-2 h-2 rounded-full ${supabaseStatus === 'connected' ? 'bg-emerald-500 animate-pulse' : 'bg-amber-500 animate-blink'}`} />
                <Icon name="database" className={`w-4 h-4 ${supabaseStatus === 'connected' ? 'text-emerald-400' : 'text-amber-400'}`} />
                <span className={`text-sm ${supabaseStatus === 'connected' ? 'text-emerald-400' : 'text-amber-400'}`}>
                  Supabase: {supabaseStatus === 'connected' ? 'Connected' : 'Checking...'}
                </span>
              </div>
            </div>
          </div>

          <div className="max-w-7xl mx-auto">
            {/* Tab Navigation */}
            <div className="flex items-center gap-2 mb-6 overflow-x-auto pb-2">
              {tabs.map(tab => (
                <button
                  key={tab.id}
                  onClick={() => setActiveTab(tab.id)}
                  className={`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-all ${
                    activeTab === tab.id
                      ? 'bg-cyan-500/20 border border-cyan-500/50 text-cyan-400'
                      : 'bg-slate-800/50 border border-slate-700 text-slate-400 hover:text-white hover:border-slate-600'
                  }`}
                >
                  <Icon name={tab.icon} className="w-4 h-4" />
                  <span className="text-sm font-medium">{tab.label}</span>
                </button>
              ))}
            </div>

            {/* User Management Tab */}
            {activeTab === 'users' && (
              <div className="glass-card rounded-2xl p-6 animate-fade-up">
                <div className="flex items-center justify-between mb-6">
                  <div className="flex items-center gap-3">
                    <div className="w-10 h-10 rounded-lg bg-cyan-500/20 flex items-center justify-center">
                      <Icon name="users" className="w-5 h-5 text-cyan-400" />
                    </div>
                    <div>
                      <h2 className="text-lg font-semibold">User Management</h2>
                      <p className="text-xs text-slate-500">{users.length} users ‚Ä¢ {users.filter(u => u.status === 'active').length} active</p>
                    </div>
                  </div>
                  <button className="flex items-center gap-2 px-4 py-2 bg-cyan-500/20 border border-cyan-500/50 text-cyan-400 rounded-lg hover:bg-cyan-500/30 transition-all">
                    <Icon name="plus" className="w-4 h-4" />
                    Add User
                  </button>
                </div>

                <div className="overflow-x-auto">
                  <table className="w-full">
                    <thead>
                      <tr className="text-left text-xs text-slate-500 border-b border-slate-800">
                        <th className="pb-3 font-medium">Name</th>
                        <th className="pb-3 font-medium">Email</th>
                        <th className="pb-3 font-medium">Role</th>
                        <th className="pb-3 font-medium">Status</th>
                        <th className="pb-3 font-medium">Last Login</th>
                        <th className="pb-3 font-medium text-right">Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      {users.map((user, idx) => (
                        <tr 
                          key={user.id}
                          className="border-b border-slate-800/50 animate-slide-in"
                          style={{ animationDelay: `${idx * 50}ms` }}
                        >
                          <td className="py-4">
                            <div className="flex items-center gap-3">
                              <div className="w-8 h-8 rounded-full bg-gradient-to-br from-cyan-400 to-teal-500 flex items-center justify-center text-xs font-bold text-white">
                                {user.name.split(' ').map(n => n[0]).join('')}
                              </div>
                              <span className="font-medium text-white">{user.name}</span>
                            </div>
                          </td>
                          <td className="py-4 text-sm text-slate-400">{user.email}</td>
                          <td className="py-4">
                            <select 
                              value={user.role}
                              onChange={(e) => setUsers(users.map(u => u.id === user.id ? { ...u, role: e.target.value } : u))}
                              className="px-2 py-1 bg-slate-800/50 border border-slate-700 rounded text-xs text-cyan-400 focus:outline-none focus:border-cyan-500"
                            >
                              {SHIPLEY_ROLES.map(role => (
                                <option key={role} value={role}>{role}</option>
                              ))}
                            </select>
                          </td>
                          <td className="py-4">
                            <span className={`text-xs px-2 py-1 rounded-full ${
                              user.status === 'active' 
                                ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30'
                                : 'bg-slate-500/20 text-slate-400 border border-slate-500/30'
                            }`}>
                              {user.status === 'active' ? '‚óè Active' : '‚óã Inactive'}
                            </span>
                          </td>
                          <td className="py-4 text-sm text-slate-500 font-mono">{user.lastLogin}</td>
                          <td className="py-4 text-right">
                            <div className="flex items-center justify-end gap-2">
                              <button className="p-2 rounded-lg bg-slate-800/50 text-slate-400 hover:text-white hover:bg-slate-700 transition-all">
                                <Icon name="edit" className="w-4 h-4" />
                              </button>
                              <button 
                                onClick={() => handleDeactivateUser(user.id)}
                                className={`p-2 rounded-lg transition-all ${
                                  user.status === 'active'
                                    ? 'bg-rose-500/10 text-rose-400 hover:bg-rose-500/20'
                                    : 'bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20'
                                }`}
                              >
                                <Icon name={user.status === 'active' ? 'x' : 'check'} className="w-4 h-4" />
                              </button>
                            </div>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>
            )}

            {/* RBAC Matrix Tab */}
            {activeTab === 'rbac' && (
              <div className="glass-card rounded-2xl p-6 animate-fade-up">
                <div className="flex items-center gap-3 mb-6">
                  <div className="w-10 h-10 rounded-lg bg-purple-500/20 flex items-center justify-center">
                    <Icon name="shield" className="w-5 h-5 text-purple-400" />
                  </div>
                  <div>
                    <h2 className="text-lg font-semibold">Role-Based Access Control Matrix</h2>
                    <p className="text-xs text-slate-500">Module access by Shipley role</p>
                  </div>
                </div>

                <div className="overflow-x-auto">
                  <table className="w-full text-xs">
                    <thead>
                      <tr className="table-header">
                        <th className="p-2 text-left font-medium text-slate-400 sticky left-0 bg-slate-900/95">Role</th>
                        {MODULES.map(module => (
                          <th key={module} className="p-2 text-center font-medium text-slate-400 whitespace-nowrap">
                            {module.split(' ')[0]}
                          </th>
                        ))}
                      </tr>
                    </thead>
                    <tbody>
                      {SHIPLEY_ROLES.map((role, idx) => (
                        <tr key={role} className="border-b border-slate-800/50 animate-slide-in" style={{ animationDelay: `${idx * 30}ms` }}>
                          <td className="p-2 font-medium text-white sticky left-0 bg-slate-900/80">{role}</td>
                          {MODULES.map(module => {
                            const hasAccess = RBAC_MATRIX[role]?.includes(module);
                            return (
                              <td key={module} className="p-2 text-center">
                                <div className={`w-5 h-5 mx-auto rounded flex items-center justify-center ${
                                  hasAccess ? 'bg-emerald-500/20' : 'bg-slate-800/50'
                                }`}>
                                  {hasAccess && <Icon name="check" className="w-3 h-3 text-emerald-400" />}
                                </div>
                              </td>
                            );
                          })}
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>

                <div className="mt-4 flex items-center gap-4 text-xs text-slate-500">
                  <div className="flex items-center gap-2">
                    <div className="w-4 h-4 rounded bg-emerald-500/20 flex items-center justify-center">
                      <Icon name="check" className="w-2 h-2 text-emerald-400" />
                    </div>
                    <span>Has Access</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-4 h-4 rounded bg-slate-800/50" />
                    <span>No Access</span>
                  </div>
                </div>
              </div>
            )}

            {/* Audit Log Tab */}
            {activeTab === 'audit' && (
              <div className="glass-card rounded-2xl p-6 animate-fade-up">
                <div className="flex items-center justify-between mb-6">
                  <div className="flex items-center gap-3">
                    <div className="w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center">
                      <Icon name="document" className="w-5 h-5 text-amber-400" />
                    </div>
                    <div>
                      <h2 className="text-lg font-semibold">Audit Log</h2>
                      <p className="text-xs text-slate-500">Who did what, when</p>
                    </div>
                  </div>
                  <button className="flex items-center gap-2 px-4 py-2 bg-slate-800/50 border border-slate-700 text-slate-400 rounded-lg hover:text-white hover:border-slate-600 transition-all">
                    <Icon name="download" className="w-4 h-4" />
                    Export Log
                  </button>
                </div>

                <div className="space-y-3 max-h-[500px] overflow-y-auto scrollbar-thin">
                  {AUDIT_LOG.map((entry, idx) => (
                    <div 
                      key={entry.id}
                      className="flex items-start gap-4 p-4 bg-slate-800/30 rounded-lg animate-slide-in"
                      style={{ animationDelay: `${idx * 50}ms` }}
                    >
                      <div className="text-xs font-mono text-slate-500 whitespace-nowrap">{entry.timestamp}</div>
                      <div className="flex-1">
                        <div className="flex items-center gap-2 mb-1">
                          <span className="font-medium text-white">{entry.user}</span>
                          <span className={`text-xs px-2 py-0.5 rounded ${
                            entry.action === 'Login' ? 'bg-cyan-500/20 text-cyan-400' :
                            entry.action === 'Create' ? 'bg-emerald-500/20 text-emerald-400' :
                            entry.action === 'Update' ? 'bg-amber-500/20 text-amber-400' :
                            entry.action === 'Delete' ? 'bg-rose-500/20 text-rose-400' :
                            entry.action === 'Export' ? 'bg-purple-500/20 text-purple-400' :
                            entry.action === 'Submit' ? 'bg-indigo-500/20 text-indigo-400' :
                            'bg-slate-500/20 text-slate-400'
                          }`}>
                            {entry.action}
                          </span>
                          <span className="text-xs text-slate-500">on</span>
                          <span className="text-xs text-cyan-400">{entry.resource}</span>
                        </div>
                        <p className="text-sm text-slate-400">{entry.details}</p>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {/* Token Usage Tab */}
            {activeTab === 'tokens' && (
              <div className="space-y-6 animate-fade-up">
                {/* Summary Cards */}
                <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                  <div className="glass-card rounded-xl p-4">
                    <div className="flex items-center gap-3 mb-3">
                      <div className="w-8 h-8 rounded-lg bg-cyan-500/20 flex items-center justify-center">
                        <Icon name="chip" className="w-4 h-4 text-cyan-400" />
                      </div>
                      <span className="text-sm text-slate-400">Tokens Used</span>
                    </div>
                    <div className="text-2xl font-bold font-mono text-cyan-400">{TOKEN_USAGE.current.toLocaleString()}</div>
                    <div className="text-xs text-slate-500">of {TOKEN_USAGE.limit.toLocaleString()} limit</div>
                    <div className="h-2 bg-slate-800 rounded-full mt-3 overflow-hidden">
                      <div className="h-full bg-gradient-to-r from-cyan-500 to-teal-500 animate-bar-fill" style={{ width: `${tokenPercent}%` }} />
                    </div>
                  </div>
                  
                  <div className="glass-card rounded-xl p-4">
                    <div className="flex items-center gap-3 mb-3">
                      <div className="w-8 h-8 rounded-lg bg-emerald-500/20 flex items-center justify-center">
                        <span className="text-emerald-400 text-sm font-bold">$</span>
                      </div>
                      <span className="text-sm text-slate-400">Current Cost</span>
                    </div>
                    <div className="text-2xl font-bold font-mono text-emerald-400">${TOKEN_USAGE.cost.toFixed(2)}</div>
                    <div className="text-xs text-slate-500">of ${TOKEN_USAGE.monthlyBudget} budget</div>
                    <div className="h-2 bg-slate-800 rounded-full mt-3 overflow-hidden">
                      <div className={`h-full animate-bar-fill ${costPercent > 80 ? 'bg-amber-500' : 'bg-emerald-500'}`} style={{ width: `${costPercent}%` }} />
                    </div>
                  </div>
                  
                  <div className="glass-card rounded-xl p-4">
                    <div className="flex items-center gap-3 mb-3">
                      <div className="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center">
                        <Icon name="clock" className="w-4 h-4 text-purple-400" />
                      </div>
                      <span className="text-sm text-slate-400">Avg per Day</span>
                    </div>
                    <div className="text-2xl font-bold font-mono text-purple-400">{Math.round(TOKEN_USAGE.current / 27).toLocaleString()}</div>
                    <div className="text-xs text-slate-500">tokens/day (Jan avg)</div>
                  </div>
                  
                  <div className="glass-card rounded-xl p-4">
                    <div className="flex items-center gap-3 mb-3">
                      <div className="w-8 h-8 rounded-lg bg-amber-500/20 flex items-center justify-center">
                        <Icon name="wifi" className="w-4 h-4 text-amber-400" />
                      </div>
                      <span className="text-sm text-slate-400">API Status</span>
                    </div>
                    <div className="text-2xl font-bold text-emerald-400">Online</div>
                    <div className="text-xs text-slate-500">99.8% uptime this month</div>
                  </div>
                </div>

                {/* Usage by Agent */}
                <div className="glass-card rounded-2xl p-6">
                  <div className="flex items-center gap-3 mb-6">
                    <div className="w-10 h-10 rounded-lg bg-indigo-500/20 flex items-center justify-center">
                      <Icon name="chip" className="w-5 h-5 text-indigo-400" />
                    </div>
                    <div>
                      <h2 className="text-lg font-semibold">Usage by AI Agent</h2>
                      <p className="text-xs text-slate-500">Token consumption breakdown</p>
                    </div>
                  </div>

                  <div className="space-y-4">
                    {TOKEN_USAGE.byAgent.map((agent, idx) => (
                      <div key={agent.agent} className="animate-slide-in" style={{ animationDelay: `${idx * 50}ms` }}>
                        <div className="flex items-center justify-between mb-2">
                          <span className="text-sm text-white">{agent.agent}</span>
                          <div className="flex items-center gap-4 text-sm">
                            <span className="font-mono text-slate-400">{agent.tokens.toLocaleString()} tokens</span>
                            <span className="font-mono text-emerald-400">${agent.cost.toFixed(2)}</span>
                          </div>
                        </div>
                        <div className="h-2 bg-slate-800 rounded-full overflow-hidden">
                          <div 
                            className="h-full bg-gradient-to-r from-indigo-500 to-purple-500 animate-bar-fill"
                            style={{ width: `${(agent.tokens / TOKEN_USAGE.byAgent[0].tokens) * 100}%` }}
                          />
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            )}

            {/* Playbook Manager Tab */}
            {activeTab === 'playbook' && (
              <div className="glass-card rounded-2xl p-6 animate-fade-up">
                <div className="flex items-center justify-between mb-6">
                  <div className="flex items-center gap-3">
                    <div className="w-10 h-10 rounded-lg bg-teal-500/20 flex items-center justify-center">
                      <Icon name="book" className="w-5 h-5 text-teal-400" />
                    </div>
                    <div>
                      <h2 className="text-lg font-semibold">Playbook Manager</h2>
                      <p className="text-xs text-slate-500">{PLAYBOOK_LESSONS.length} lessons in knowledge base</p>
                    </div>
                  </div>
                </div>

                <div className="space-y-3">
                  {PLAYBOOK_LESSONS.map((lesson, idx) => (
                    <div 
                      key={lesson.id}
                      className="flex items-center justify-between p-4 bg-slate-800/30 rounded-lg animate-slide-in"
                      style={{ animationDelay: `${idx * 50}ms` }}
                    >
                      <div className="flex-1">
                        <div className="flex items-center gap-3 mb-1">
                          <span className="font-medium text-white">{lesson.title}</span>
                          <span className="text-xs px-2 py-0.5 rounded bg-cyan-500/20 text-cyan-400">{lesson.category}</span>
                        </div>
                        <div className="flex items-center gap-4 text-xs text-slate-500">
                          <span>Used {lesson.uses} times</span>
                          <span>‚Ä¢</span>
                          <span>Last used {lesson.lastUsed}</span>
                        </div>
                      </div>
                      <div className="flex items-center gap-4">
                        <div className="flex items-center gap-1">
                          {[1, 2, 3, 4, 5].map(star => (
                            <div key={star} className={`w-3 h-3 ${star <= lesson.quality ? 'text-amber-400' : 'text-slate-700'}`}>
                              <Icon name="book" className="w-3 h-3" />
                            </div>
                          ))}
                        </div>
                        <button 
                          className={`p-2 rounded-lg transition-all ${
                            lesson.quality <= 2 
                              ? 'bg-rose-500/20 text-rose-400 hover:bg-rose-500/30'
                              : 'bg-slate-700/50 text-slate-500 hover:text-slate-300'
                          }`}
                        >
                          <Icon name="trash" className="w-4 h-4" />
                        </button>
                      </div>
                    </div>
                  ))}
                </div>

                <div className="mt-4 p-4 bg-amber-500/10 border border-amber-500/30 rounded-lg">
                  <div className="flex items-center gap-2 text-amber-400 text-sm">
                    <Icon name="trash" className="w-4 h-4" />
                    <span className="font-medium">Low-Quality Items:</span>
                    <span className="text-amber-300">{PLAYBOOK_LESSONS.filter(l => l.quality <= 2).length} lessons with quality ‚â§2</span>
                  </div>
                </div>
              </div>
            )}

            {/* System Settings Tab */}
            {activeTab === 'settings' && (
              <div className="space-y-6 animate-fade-up">
                {/* Branding */}
                <div className="glass-card rounded-2xl p-6">
                  <div className="flex items-center gap-3 mb-6">
                    <div className="w-10 h-10 rounded-lg bg-rose-500/20 flex items-center justify-center">
                      <Icon name="settings" className="w-5 h-5 text-rose-400" />
                    </div>
                    <div>
                      <h2 className="text-lg font-semibold">Branding</h2>
                      <p className="text-xs text-slate-500">Customize platform appearance</p>
                    </div>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label className="block text-sm text-slate-400 mb-2">Company Name</label>
                      <input 
                        type="text" 
                        value="Mission Meets Tech"
                        className="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-cyan-500"
                      />
                    </div>
                    <div>
                      <label className="block text-sm text-slate-400 mb-2">Primary Color</label>
                      <div className="flex items-center gap-3">
                        <div className="w-10 h-10 rounded-lg bg-[#00E5FA]" />
                        <input 
                          type="text" 
                          value="#00E5FA"
                          className="flex-1 px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-white font-mono focus:outline-none focus:border-cyan-500"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                {/* Integrations */}
                <div className="glass-card rounded-2xl p-6">
                  <div className="flex items-center gap-3 mb-6">
                    <div className="w-10 h-10 rounded-lg bg-indigo-500/20 flex items-center justify-center">
                      <Icon name="link" className="w-5 h-5 text-indigo-400" />
                    </div>
                    <div>
                      <h2 className="text-lg font-semibold">Integrations</h2>
                      <p className="text-xs text-slate-500">Connected services</p>
                    </div>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {[
                      { name: 'Supabase', status: 'connected', icon: 'üóÑÔ∏è' },
                      { name: 'Anthropic API', status: 'connected', icon: 'ü§ñ' },
                      { name: 'Microsoft 365', status: 'disconnected', icon: 'üìß' },
                      { name: 'HubSpot CRM', status: 'disconnected', icon: 'üìä' },
                      { name: 'Deltek GovWin', status: 'disconnected', icon: 'üéØ' },
                      { name: 'AskSage', status: 'disconnected', icon: 'üîç' },
                    ].map(integration => (
                      <div key={integration.name} className="flex items-center justify-between p-4 bg-slate-800/30 rounded-lg">
                        <div className="flex items-center gap-3">
                          <span className="text-2xl">{integration.icon}</span>
                          <span className="font-medium text-white">{integration.name}</span>
                        </div>
                        <button className={`px-3 py-1 rounded-lg text-sm ${
                          integration.status === 'connected'
                            ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30'
                            : 'bg-slate-700/50 text-slate-400 hover:bg-cyan-500/20 hover:text-cyan-400 hover:border-cyan-500/30 border border-transparent'
                        }`}>
                          {integration.status === 'connected' ? '‚úì Connected' : 'Connect'}
                        </button>
                      </div>
                    ))}
                  </div>
                </div>

                {/* Data Management */}
                <div className="glass-card rounded-2xl p-6">
                  <div className="flex items-center gap-3 mb-6">
                    <div className="w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center">
                      <Icon name="database" className="w-5 h-5 text-amber-400" />
                    </div>
                    <div>
                      <h2 className="text-lg font-semibold">Data Management</h2>
                      <p className="text-xs text-slate-500">Backup and export options</p>
                    </div>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button className="flex items-center justify-center gap-2 p-4 bg-cyan-500/10 border border-cyan-500/30 rounded-xl text-cyan-400 hover:bg-cyan-500/20 transition-all">
                      <Icon name="download" className="w-5 h-5" />
                      <span className="font-medium">Export All Data</span>
                    </button>
                    <button className="flex items-center justify-center gap-2 p-4 bg-emerald-500/10 border border-emerald-500/30 rounded-xl text-emerald-400 hover:bg-emerald-500/20 transition-all">
                      <Icon name="database" className="w-5 h-5" />
                      <span className="font-medium">Create Backup</span>
                    </button>
                    <button className="flex items-center justify-center gap-2 p-4 bg-rose-500/10 border border-rose-500/30 rounded-xl text-rose-400 hover:bg-rose-500/20 transition-all">
                      <Icon name="trash" className="w-5 h-5" />
                      <span className="font-medium">Clear Cache</span>
                    </button>
                  </div>

                  <div className="mt-4 p-4 bg-slate-800/30 rounded-lg">
                    <div className="flex items-center justify-between text-sm">
                      <span className="text-slate-400">Last backup:</span>
                      <span className="font-mono text-slate-300">2026-01-27 06:00:00 UTC</span>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>

          {/* AI Disclaimer Footer */}
          <div className="max-w-7xl mx-auto mt-8 text-center">
            <p className="text-xs text-slate-600">AI GENERATED - REQUIRES HUMAN REVIEW ‚Ä¢ MissionPulse v2.0 ¬© 2026 Mission Meets Tech</p>
          </div>
        </div>
      );
    };

    ReactDOM.render(<AdminPanel />, document.getElementById('root'));
  </script>
  <script src="render-api-client.js"></script>
  <script src="ai-chat-widget.js"></script>
</body>
</html>
