<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse S140 - Pricing Library [CUI]</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Space Grotesk',sans-serif;background:#00050F;min-height:100vh}.font-mono{font-family:'JetBrains Mono',monospace}@keyframes slideIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}.animate-slide-in{animation:slideIn .4s ease-out forwards}.animate-pulse{animation:pulse 2s ease-in-out infinite}.glass-card{background:linear-gradient(135deg,rgba(15,23,42,.9) 0%,rgba(15,23,42,.7) 100%);backdrop-filter:blur(10px);border:1px solid rgba(0,229,250,.15)}.glass-card:hover{border-color:rgba(0,229,250,.3)}.cui-banner{background:linear-gradient(90deg,rgba(255,184,0,.08),rgba(255,184,0,.03));border:1px solid rgba(255,184,0,.3)}
  </style>
  <script src="rbac-guard.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const{useState,useEffect}=React;
    const SUPABASE_URL='https://qdrtpnpnhkxvfmvfziop.supabase.co';const SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc4MjMwMTgsImV4cCI6MjA1MzM5OTAxOH0.gFHBoGjPMWjCGuJNdxMGPOBmGMHBp0jSTbxxcFKqkPQ';
    var sbClient;try{sbClient=supabase.createClient(SUPABASE_URL,SUPABASE_KEY)}catch(e){sbClient=null}

    const Icons={
      shield:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>,
      dollar:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>,
      search:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>,
      lock:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>,
      trending:()=><svg className="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg>,
    };
    const Icon=({name,className="w-4 h-4"})=>{const C=Icons[name];return C?<span className={`inline-block ${className}`}><C/></span>:null};

    const LABOR_CATS=[
      {id:1,title:'Program Manager',sca:null,gsa_rate:185,wrap_rate:245,fy26:252,fy27:260,fy28:268,clearance:'Secret',experience:'10+ years'},
      {id:2,title:'Senior Systems Engineer',sca:null,gsa_rate:175,wrap_rate:232,fy26:239,fy27:246,fy28:254,clearance:'TS/SCI',experience:'8+ years'},
      {id:3,title:'Solutions Architect',sca:null,gsa_rate:195,wrap_rate:258,fy26:266,fy27:274,fy28:282,clearance:'TS/SCI',experience:'12+ years'},
      {id:4,title:'Data Engineer',sca:null,gsa_rate:155,wrap_rate:205,fy26:211,fy27:218,fy28:224,clearance:'Secret',experience:'5+ years'},
      {id:5,title:'DevSecOps Engineer',sca:null,gsa_rate:165,wrap_rate:218,fy26:225,fy27:232,fy28:239,clearance:'Secret',experience:'6+ years'},
      {id:6,title:'Cybersecurity Analyst',sca:null,gsa_rate:145,wrap_rate:192,fy26:198,fy27:204,fy28:210,clearance:'TS/SCI',experience:'5+ years'},
      {id:7,title:'UX Designer',sca:null,gsa_rate:130,wrap_rate:172,fy26:177,fy27:182,fy28:188,clearance:'Public Trust',experience:'4+ years'},
      {id:8,title:'QA Lead',sca:null,gsa_rate:125,wrap_rate:165,fy26:170,fy27:175,fy28:180,clearance:'Secret',experience:'6+ years'},
      {id:9,title:'Junior Developer',sca:null,gsa_rate:95,wrap_rate:126,fy26:130,fy27:134,fy28:138,clearance:'Public Trust',experience:'2+ years'},
      {id:10,title:'Administrative Support',sca:'SCA',gsa_rate:55,wrap_rate:73,fy26:75,fy27:77,fy28:80,clearance:'None',experience:'1+ years'},
    ];

    const WRAP_RATES={
      fringe:32.5,overhead:45.2,ga:12.8,fee:8.0,escalation:3.0
    };

    const HISTORICAL=[
      {opp:'DHA EHR Modernization',date:'2026-01',type:'FFP/T&M Hybrid',avg_rate:228,result:'win',notes:'Rates competitive. Tech superiority justified premium.'},
      {opp:'VA Claims AI',date:'2025-12',type:'T&M',avg_rate:195,result:'loss',notes:'Lowest price but lost on technical. Rates were correct.'},
      {opp:'CMS Data Analytics',date:'2025-11',type:'T&M',avg_rate:215,result:'win',notes:'Best value win. Rates within IGCE range.'},
      {opp:'IHS Telehealth',date:'2025-10',type:'FFP',avg_rate:188,result:'loss',notes:'Competitive price but no past performance.'},
    ];

    const ConnectionIndicator=({connected})=>(
      <div className="flex items-center gap-2 px-3 py-1 rounded-full text-xs font-mono" style={{background:connected?'rgba(0,255,136,0.1)':'rgba(255,184,0,0.1)',border:`1px solid ${connected?'rgba(0,255,136,0.3)':'rgba(255,184,0,0.3)'}`}}>
        <div className={`w-2 h-2 rounded-full ${connected?'bg-green-400':'bg-amber-400 animate-pulse'}`}/>
        <span style={{color:connected?'#00ff88':'#ffb800'}}>{connected?'LIVE':'DEMO'}</span>
      </div>
    );

    const App=()=>{
      const[connected,setConnected]=useState(false);
      const[userRole]=useState('CEO');
      const[activeTab,setActiveTab]=useState('rates');
      const[search,setSearch]=useState('');

      useEffect(()=>{const a=['CEO','COO','FIN','Admin'];if(!a.includes(userRole))return},[userRole]);
      useEffect(()=>{if(!sbClient)return;(async()=>{try{const{data}=await sbClient.from('opportunities').select('id').limit(1);if(data)setConnected(true)}catch(e){}})()},[]);

      const filtered=LABOR_CATS.filter(l=>!search||l.title.toLowerCase().includes(search.toLowerCase()));
      const tabs=[{key:'rates',label:'Labor Categories'},{key:'wrap',label:'Wrap Rates'},{key:'historical',label:'Historical'},{key:'escalation',label:'Escalation'}];

      return(
        <div className="min-h-screen" style={{background:'#00050F'}}>
          <div className="max-w-7xl mx-auto p-6">
            {/* CUI Banner */}
            <div className="cui-banner rounded-lg px-4 py-2 mb-4 flex items-center gap-3">
              <Icon name="lock" className="w-4 h-4 text-amber-500"/>
              <span className="text-xs font-mono font-bold text-amber-500">CUI // CONTROLLED UNCLASSIFIED INFORMATION â€” PRICING DATA â€” AUTHORIZED ACCESS ONLY</span>
            </div>

            <div className="flex items-center justify-between mb-6">
              <div><div className="flex items-center gap-3 mb-1"><h1 className="text-2xl font-bold text-white">Pricing Library</h1><ConnectionIndicator connected={connected}/><span className="px-2 py-0.5 rounded text-xs font-mono font-bold bg-amber-500/15 text-amber-500 border border-amber-500/30">ðŸ›¡ CUI</span></div>
              <p className="text-sm text-slate-400">Historical rates, wrap rates, labor categories & escalation factors</p></div>
              <div className="relative"><Icon name="search" className="w-4 h-4 text-slate-500 absolute left-3 top-1/2 -translate-y-1/2"/><input type="text" placeholder="Search labor cats..." value={search} onChange={e=>setSearch(e.target.value)} className="pl-9 pr-4 py-2 rounded-lg bg-slate-800/50 border border-slate-700/30 text-sm text-white placeholder-slate-500 focus:outline-none focus:border-cyan-500/40 w-56"/></div>
            </div>

            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
              {[{label:'Labor Categories',value:LABOR_CATS.length,color:'#00E5FA'},{label:'Avg Wrap Rate',value:`$${Math.round(LABOR_CATS.reduce((s,l)=>s+l.wrap_rate,0)/LABOR_CATS.length)}/hr`,color:'#a78bfa'},{label:'Escalation Rate',value:`${WRAP_RATES.escalation}%`,color:'#ffb800'},{label:'Historical Bids',value:HISTORICAL.length,color:'#00ff88'}].map((k,i)=>(
                <div key={i} className="glass-card rounded-xl p-4 animate-slide-in" style={{animationDelay:`${i*.05}s`}}>
                  <span className="text-xs text-slate-500 font-mono uppercase">{k.label}</span>
                  <div className="text-2xl font-mono font-bold mt-1" style={{color:k.color}}>{k.value}</div>
                </div>
              ))}
            </div>

            <div className="flex items-center gap-1 bg-slate-800/30 rounded-lg p-1 mb-6">
              {tabs.map(t=><button key={t.key} onClick={()=>setActiveTab(t.key)} className={`px-4 py-2 rounded-md text-sm font-mono font-bold transition flex-1 ${activeTab===t.key?'bg-cyan-500/20 text-cyan-400':'text-slate-500 hover:text-slate-300'}`}>{t.label}</button>)}
            </div>

            {activeTab==='rates'&&(
              <div className="glass-card rounded-xl overflow-hidden animate-slide-in">
                <div className="grid grid-cols-9 gap-2 px-5 py-3 border-b border-slate-700/30 text-xs font-mono text-slate-500 uppercase">
                  <span className="col-span-2">Labor Category</span><span>GSA Rate</span><span>Wrap Rate</span><span>FY26</span><span>FY27</span><span>FY28</span><span>Clearance</span><span>Experience</span>
                </div>
                {filtered.map((l,i)=>(
                  <div key={l.id} className="grid grid-cols-9 gap-2 items-center px-5 py-3 border-b border-slate-700/10 hover:bg-slate-800/20 transition animate-slide-in" style={{animationDelay:`${i*.03}s`}}>
                    <span className="col-span-2 text-sm text-white font-medium">{l.title}{l.sca&&<span className="ml-2 px-1.5 py-0.5 rounded text-xs font-mono bg-purple-500/10 text-purple-400">SCA</span>}</span>
                    <span className="text-sm font-mono text-slate-400">${l.gsa_rate}</span>
                    <span className="text-sm font-mono text-cyan-400 font-bold">${l.wrap_rate}</span>
                    <span className="text-sm font-mono text-slate-300">${l.fy26}</span>
                    <span className="text-sm font-mono text-slate-300">${l.fy27}</span>
                    <span className="text-sm font-mono text-slate-300">${l.fy28}</span>
                    <span className="text-xs font-mono text-slate-500">{l.clearance}</span>
                    <span className="text-xs text-slate-500">{l.experience}</span>
                  </div>
                ))}
              </div>
            )}

            {activeTab==='wrap'&&(
              <div className="glass-card rounded-xl p-6 animate-slide-in">
                <h3 className="text-sm font-mono font-bold text-cyan-400 mb-4">WRAP RATE COMPONENTS</h3>
                <div className="space-y-4">
                  {[{label:'Fringe Benefits',value:WRAP_RATES.fringe,color:'#00E5FA'},{label:'Overhead',value:WRAP_RATES.overhead,color:'#a78bfa'},{label:'G&A',value:WRAP_RATES.ga,color:'#ffb800'},{label:'Fee / Profit',value:WRAP_RATES.fee,color:'#00ff88'}].map((r,i)=>(
                    <div key={i}>
                      <div className="flex justify-between mb-1"><span className="text-sm text-slate-300">{r.label}</span><span className="text-sm font-mono font-bold" style={{color:r.color}}>{r.value}%</span></div>
                      <div className="h-3 rounded-full bg-slate-700/30 overflow-hidden"><div className="h-full rounded-full" style={{width:`${(r.value/50)*100}%`,background:r.color,opacity:0.6}}/></div>
                    </div>
                  ))}
                  <div className="pt-3 mt-2 border-t border-slate-700/30 flex justify-between">
                    <span className="text-sm text-white font-bold">Total Multiplier</span>
                    <span className="text-lg font-mono font-bold text-cyan-400">{(1+WRAP_RATES.fringe/100)*(1+WRAP_RATES.overhead/100)*(1+WRAP_RATES.ga/100)*(1+WRAP_RATES.fee/100)|0? ((1+WRAP_RATES.fringe/100)*(1+WRAP_RATES.overhead/100)*(1+WRAP_RATES.ga/100)*(1+WRAP_RATES.fee/100)).toFixed(3):'â€”'}x</span>
                  </div>
                </div>
              </div>
            )}

            {activeTab==='historical'&&(
              <div className="space-y-3 animate-slide-in">
                {HISTORICAL.map((h,i)=>(
                  <div key={i} className="glass-card rounded-xl p-5 animate-slide-in" style={{animationDelay:`${i*.06}s`}}>
                    <div className="flex items-center justify-between mb-2">
                      <div className="flex items-center gap-3"><span className="text-white font-semibold">{h.opp}</span><span className={`px-2 py-0.5 rounded text-xs font-mono font-bold ${h.result==='win'?'bg-green-500/15 text-green-400':'bg-red-500/15 text-red-400'}`}>{h.result.toUpperCase()}</span><span className="text-xs font-mono text-slate-500">{h.date}</span></div>
                      <div className="flex items-center gap-4"><span className="text-xs text-slate-500">{h.type}</span><span className="text-sm font-mono font-bold text-cyan-400">${h.avg_rate}/hr avg</span></div>
                    </div>
                    <p className="text-xs text-slate-400">{h.notes}</p>
                  </div>
                ))}
              </div>
            )}

            {activeTab==='escalation'&&(
              <div className="glass-card rounded-xl p-6 animate-slide-in">
                <h3 className="text-sm font-mono font-bold text-cyan-400 mb-4">RATE ESCALATION FACTORS</h3>
                <div className="grid grid-cols-4 gap-4 mb-6">
                  {[{fy:'FY25 (Base)',factor:'1.000',color:'#64748b'},{fy:'FY26',factor:'1.030',color:'#00E5FA'},{fy:'FY27',factor:'1.061',color:'#a78bfa'},{fy:'FY28',factor:'1.093',color:'#ffb800'}].map((e,i)=>(
                    <div key={i} className="p-4 rounded-lg bg-slate-800/30 border border-slate-700/20 text-center">
                      <div className="text-xs text-slate-500 font-mono mb-1">{e.fy}</div>
                      <div className="text-xl font-mono font-bold" style={{color:e.color}}>{e.factor}</div>
                    </div>
                  ))}
                </div>
                <div className="p-4 rounded-lg bg-amber-500/5 border border-amber-500/20">
                  <div className="flex items-center gap-2 mb-1"><Icon name="trending" className="w-4 h-4 text-amber-400"/><span className="text-sm text-amber-400 font-mono font-bold">Annual Escalation: {WRAP_RATES.escalation}%</span></div>
                  <p className="text-xs text-slate-400">Applied compounding annually from base year. Aligned with BLS Employment Cost Index for professional services.</p>
                </div>
              </div>
            )}

            {/* CUI + AI Disclaimer */}
            <div className="mt-8 flex items-center justify-center gap-4">
              <div className="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-amber-500/5 border border-amber-500/20">
                <Icon name="lock" className="w-3.5 h-3.5 text-amber-500"/>
                <span className="text-xs text-amber-500/80 font-mono">CUI // PRICING DATA</span>
              </div>
              <div className="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-amber-500/5 border border-amber-500/20">
                <Icon name="shield" className="w-3.5 h-3.5 text-amber-500"/>
                <span className="text-xs text-amber-500/80 font-mono">AI GENERATED â€” REQUIRES HUMAN REVIEW</span>
              </div>
            </div>
          </div>
        </div>
      );
    };
    ReactDOM.render(<App/>,document.getElementById('root'));
  </script>
</body>
</html>
