<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MissionPulse | Activity Timeline</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'mp-navy': '#00050F',
                        'mp-cyan': '#00E5FA',
                        'mp-cyan-dark': '#00B8C8',
                        'mp-slate': '#0A1628',
                        'mp-card': '#111827',
                        'mp-border': '#1E3A5F'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .glow-cyan { box-shadow: 0 0 20px rgba(0, 229, 250, 0.15); }
        .timeline-line { background: linear-gradient(180deg, #1E3A5F 0%, #00E5FA 50%, #1E3A5F 100%); }
    </style>
  <script src="rbac-guard.js"></script>
</head>
<body class="bg-mp-navy text-white min-h-screen">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;

        const OPPORTUNITIES = [
            { id: 1, name: 'VA EHR Modernization', value: '$245M' },
            { id: 2, name: 'DHA Telehealth Platform', value: '$180M' },
            { id: 3, name: 'CMS Data Analytics', value: '$156M' },
        ];

        const TIMELINE_EVENTS = [
            // Today
            { id: 1, date: '2025-01-29', time: '14:32', type: 'update', user: 'Daniel Torres', action: 'Updated pricing BOE', opportunity: 'VA EHR Modernization', details: 'Revised labor rates based on GSA schedule', icon: '‚úèÔ∏è' },
            { id: 2, date: '2025-01-29', time: '13:45', type: 'ai', user: 'AI Agent', action: 'Generated Black Hat analysis', opportunity: 'IHS Cloud Migration', details: 'Identified 3 competitor weaknesses', icon: 'ü§ñ' },
            { id: 3, date: '2025-01-29', time: '11:20', type: 'milestone', user: 'System', action: 'Phase 3 Started', opportunity: 'VA EHR Modernization', details: 'Proposal development phase initiated', icon: 'üéØ' },
            { id: 4, date: '2025-01-29', time: '10:15', type: 'approval', user: 'Mary Womack', action: 'Approved Go/No-Go', opportunity: 'CMS Data Analytics', details: 'Green light for full pursuit', icon: '‚úÖ' },
            
            // Yesterday
            { id: 5, date: '2025-01-28', time: '16:30', type: 'document', user: 'Sarah Chen', action: 'Uploaded compliance matrix', opportunity: 'DHA Telehealth Platform', details: 'FAR/DFARS checklist complete', icon: 'üìÑ' },
            { id: 6, date: '2025-01-28', time: '14:00', type: 'team', user: 'Mary Womack', action: 'Added team member', opportunity: 'VA EHR Modernization', details: 'Mike Johnson joined as Technical Writer', icon: 'üë•' },
            { id: 7, date: '2025-01-28', time: '11:30', type: 'alert', user: 'Iron Dome', action: 'Compliance alert', opportunity: 'VA EHR Modernization', details: 'FAR 52.219-14 review required', icon: '‚ö†Ô∏è' },
            
            // Earlier
            { id: 8, date: '2025-01-27', time: '15:45', type: 'ai', user: 'AI Agent', action: 'Generated win themes', opportunity: 'DHA Telehealth Platform', details: '5 discriminators identified', icon: 'ü§ñ' },
            { id: 9, date: '2025-01-27', time: '10:00', type: 'milestone', user: 'System', action: 'RFP Released', opportunity: 'CMS Data Analytics', details: 'Official solicitation published', icon: 'üìã' },
            { id: 10, date: '2025-01-26', time: '09:30', type: 'create', user: 'Mary Womack', action: 'Created opportunity', opportunity: 'CMS Data Analytics', details: 'New $156M healthcare IT opportunity', icon: '‚ûï' },
            { id: 11, date: '2025-01-25', time: '14:20', type: 'document', user: 'Mike Johnson', action: 'Submitted technical volume draft', opportunity: 'VA EHR Modernization', details: 'Version 1.0 ready for review', icon: 'üìÑ' },
            { id: 12, date: '2025-01-24', time: '11:00', type: 'milestone', user: 'System', action: 'Questions submitted', opportunity: 'DHA Telehealth Platform', details: '23 clarification questions sent to agency', icon: '‚ùì' },
        ];

        const EVENT_TYPES = [
            { id: 'all', label: 'All Activity', icon: 'üìä' },
            { id: 'milestone', label: 'Milestones', icon: 'üéØ' },
            { id: 'document', label: 'Documents', icon: 'üìÑ' },
            { id: 'approval', label: 'Approvals', icon: '‚úÖ' },
            { id: 'ai', label: 'AI Actions', icon: 'ü§ñ' },
            { id: 'team', label: 'Team', icon: 'üë•' },
            { id: 'alert', label: 'Alerts', icon: '‚ö†Ô∏è' },
        ];

        // Components
        const Header = () => (
            <header className="bg-mp-slate border-b border-mp-border px-6 py-4">
                <div className="max-w-5xl mx-auto flex items-center justify-between">
                    <a href="missionpulse-sprint62-dashboard.html" className="text-gray-400 hover:text-white transition-colors">
                        ‚Üê Back to Dashboard
                    </a>
                    <h1 className="text-xl font-bold text-white">üìÖ Activity Timeline</h1>
                    <button className="text-sm bg-mp-cyan text-mp-navy px-4 py-2 rounded-lg font-medium hover:bg-mp-cyan-dark transition-colors">
                        Export Timeline
                    </button>
                </div>
            </header>
        );

        const Filters = ({ activeType, setActiveType, activeOpp, setActiveOpp }) => (
            <div className="bg-mp-card border border-mp-border rounded-xl p-4 mb-6">
                <div className="flex flex-wrap items-center gap-4">
                    <div className="flex items-center gap-2 overflow-x-auto">
                        {EVENT_TYPES.map(type => (
                            <button
                                key={type.id}
                                onClick={() => setActiveType(type.id)}
                                className={`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm whitespace-nowrap transition-colors ${
                                    activeType === type.id
                                        ? 'bg-mp-cyan text-mp-navy font-medium'
                                        : 'bg-mp-slate text-gray-400 hover:text-white'
                                }`}
                            >
                                <span>{type.icon}</span>
                                {type.label}
                            </button>
                        ))}
                    </div>
                    
                    <div className="ml-auto">
                        <select
                            value={activeOpp}
                            onChange={(e) => setActiveOpp(e.target.value)}
                            className="bg-mp-slate border border-mp-border rounded-lg px-4 py-2 text-sm text-white focus:outline-none focus:border-mp-cyan"
                        >
                            <option value="all">All Opportunities</option>
                            {OPPORTUNITIES.map(opp => (
                                <option key={opp.id} value={opp.name}>{opp.name}</option>
                            ))}
                        </select>
                    </div>
                </div>
            </div>
        );

        const TimelineEvent = ({ event, isFirst, isLast }) => {
            const typeColors = {
                update: 'bg-blue-500',
                ai: 'bg-purple-500',
                milestone: 'bg-mp-cyan',
                approval: 'bg-green-500',
                document: 'bg-yellow-500',
                team: 'bg-pink-500',
                alert: 'bg-orange-500',
                create: 'bg-teal-500'
            };

            return (
                <div className="flex gap-4">
                    {/* Timeline line and dot */}
                    <div className="flex flex-col items-center">
                        <div className={`w-10 h-10 rounded-full ${typeColors[event.type]} flex items-center justify-center text-lg z-10`}>
                            {event.icon}
                        </div>
                        {!isLast && <div className="w-0.5 flex-1 bg-mp-border"></div>}
                    </div>

                    {/* Content */}
                    <div className="flex-1 pb-8">
                        <div className="bg-mp-card border border-mp-border rounded-xl p-4 hover:border-mp-cyan/30 transition-colors">
                            <div className="flex items-start justify-between mb-2">
                                <div>
                                    <p className="text-sm font-medium text-white">{event.action}</p>
                                    <p className="text-xs text-mp-cyan">{event.opportunity}</p>
                                </div>
                                <span className="text-xs text-gray-500">{event.time}</span>
                            </div>
                            <p className="text-sm text-gray-400 mb-2">{event.details}</p>
                            <div className="flex items-center gap-2">
                                <div className="w-6 h-6 rounded-full bg-mp-slate flex items-center justify-center text-xs text-mp-cyan">
                                    {event.user === 'AI Agent' ? 'ü§ñ' : event.user === 'System' ? '‚öôÔ∏è' : event.user === 'Iron Dome' ? 'üõ°Ô∏è' : event.user.split(' ').map(n => n[0]).join('')}
                                </div>
                                <span className="text-xs text-gray-400">{event.user}</span>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const DateGroup = ({ date, events }) => {
            const formatDate = (dateStr) => {
                const d = new Date(dateStr);
                const today = new Date();
                const yesterday = new Date(today);
                yesterday.setDate(yesterday.getDate() - 1);
                
                if (d.toDateString() === today.toDateString()) return 'Today';
                if (d.toDateString() === yesterday.toDateString()) return 'Yesterday';
                return d.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' });
            };

            return (
                <div className="mb-8">
                    <div className="flex items-center gap-4 mb-4">
                        <div className="text-sm font-medium text-white bg-mp-slate px-3 py-1 rounded-full">
                            {formatDate(date)}
                        </div>
                        <div className="flex-1 h-px bg-mp-border"></div>
                        <span className="text-xs text-gray-500">{events.length} events</span>
                    </div>
                    
                    {events.map((event, idx) => (
                        <TimelineEvent 
                            key={event.id} 
                            event={event} 
                            isFirst={idx === 0}
                            isLast={idx === events.length - 1}
                        />
                    ))}
                </div>
            );
        };

        const Stats = ({ events }) => {
            const today = events.filter(e => e.date === '2025-01-29').length;
            const thisWeek = events.length;
            const aiActions = events.filter(e => e.type === 'ai').length;
            const milestones = events.filter(e => e.type === 'milestone').length;

            return (
                <div className="grid grid-cols-4 gap-4 mb-6">
                    <div className="bg-mp-card border border-mp-border rounded-xl p-4 text-center">
                        <p className="text-2xl font-bold text-white">{today}</p>
                        <p className="text-xs text-gray-400">Today</p>
                    </div>
                    <div className="bg-mp-card border border-mp-border rounded-xl p-4 text-center">
                        <p className="text-2xl font-bold text-white">{thisWeek}</p>
                        <p className="text-xs text-gray-400">This Week</p>
                    </div>
                    <div className="bg-mp-card border border-purple-500/30 rounded-xl p-4 text-center">
                        <p className="text-2xl font-bold text-purple-400">{aiActions}</p>
                        <p className="text-xs text-gray-400">AI Actions</p>
                    </div>
                    <div className="bg-mp-card border border-mp-cyan/30 rounded-xl p-4 text-center">
                        <p className="text-2xl font-bold text-mp-cyan">{milestones}</p>
                        <p className="text-xs text-gray-400">Milestones</p>
                    </div>
                </div>
            );
        };

        const OpportunityLegend = () => (
            <div className="bg-mp-card border border-mp-border rounded-xl p-4 mb-6">
                <h3 className="text-sm font-medium text-white mb-3">Active Opportunities</h3>
                <div className="flex flex-wrap gap-4">
                    {OPPORTUNITIES.map(opp => (
                        <div key={opp.id} className="flex items-center gap-2">
                            <div className="w-3 h-3 rounded-full bg-mp-cyan"></div>
                            <span className="text-sm text-gray-400">{opp.name}</span>
                            <span className="text-xs text-gray-500">{opp.value}</span>
                        </div>
                    ))}
                </div>
            </div>
        );

        // Main App
        const App = () => {
            const [activeType, setActiveType] = useState('all');
            const [activeOpp, setActiveOpp] = useState('all');

            const filteredEvents = TIMELINE_EVENTS.filter(event => {
                const matchesType = activeType === 'all' || event.type === activeType;
                const matchesOpp = activeOpp === 'all' || event.opportunity === activeOpp;
                return matchesType && matchesOpp;
            });

            // Group events by date
            const groupedEvents = filteredEvents.reduce((acc, event) => {
                if (!acc[event.date]) acc[event.date] = [];
                acc[event.date].push(event);
                return acc;
            }, {});

            const sortedDates = Object.keys(groupedEvents).sort((a, b) => new Date(b) - new Date(a));

            return (
                <div className="min-h-screen bg-mp-navy">
                    <Header />
                    
                    <main className="max-w-4xl mx-auto px-6 py-6">
                        <Stats events={filteredEvents} />
                        <OpportunityLegend />
                        <Filters 
                            activeType={activeType} 
                            setActiveType={setActiveType}
                            activeOpp={activeOpp}
                            setActiveOpp={setActiveOpp}
                        />

                        {sortedDates.length > 0 ? (
                            sortedDates.map(date => (
                                <DateGroup 
                                    key={date} 
                                    date={date} 
                                    events={groupedEvents[date]} 
                                />
                            ))
                        ) : (
                            <div className="text-center py-12">
                                <p className="text-4xl mb-2">üìÖ</p>
                                <p className="text-gray-400">No activity matches your filters</p>
                            </div>
                        )}

                        <div className="text-center mt-8">
                            <button className="text-sm text-mp-cyan hover:text-white transition-colors">
                                Load More Activity ‚Üí
                            </button>
                        </div>
                    </main>

                    <footer className="border-t border-mp-border py-4 mt-8">
                        <div className="max-w-4xl mx-auto px-6 flex items-center justify-between text-xs text-gray-500">
                            <p>AI GENERATED - REQUIRES HUMAN REVIEW</p>
                            <p>MissionPulse v12 ‚Ä¢ Sprint 69</p>
                        </div>
                    </footer>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
