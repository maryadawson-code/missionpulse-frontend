<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse ‚Äî Management Volume</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:#00050F;min-height:100vh;color:#e2e8f0}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(0,229,250,0.2);border-radius:3px}</style>
  <script src="rbac-guard.js"></script>
</head>
<body>
  <div id="missionpulse-sidebar"></div>
  <div class="main-content"><div id="root"></div></div>
  <script src="missionpulse-nav.js"></script>
  <script type="text/babel">
    const{useState,useEffect}=React;
    const SB_URL='https://qdrtpnpnhkxvfmvfziop.supabase.co';const SB_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5MjMxNDMsImV4cCI6MjA1MzQ5OTE0M30.GFbjgRMgVhMMcnNaJMrLVnJI_u6yBGJOhO-LHKE8sZQ';
    var sbClient;try{sbClient=supabase.createClient(SB_URL,SB_KEY)}catch(e){sbClient=null}
    const ROLES_ALLOWED=['*'];

    const ORG_CHART={
      name:'Mary Womack',title:'Program Manager',key:true,
      children:[
        {name:'Tom Patterson',title:'Deputy PM',key:true,children:[
          {name:'Kevin Brown',title:'Help Desk Lead',key:false,children:[{name:'HD Tier 1 (x3)',title:'Help Desk',key:false,children:[]}]},
          {name:'Mark Stevens',title:'Technical Writer',key:false,children:[]},
        ]},
        {name:'Sarah Kim',title:'Solutions Architect',key:true,children:[
          {name:'David Chen',title:'Senior Developer',key:false,children:[]},
          {name:'Lisa Wang',title:'DevSecOps Engineer',key:false,children:[]},
          {name:'Michelle Torres',title:'Data Engineer',key:false,children:[]},
          {name:'James Rodriguez',title:'AI/ML Lead',key:true,children:[]},
        ]},
        {name:'Angela Foster',title:'Cybersecurity Lead',key:true,children:[
          {name:'Robert Jackson',title:'ISSO',key:false,children:[]},
        ]},
        {name:'Patricia Nguyen',title:'QA Lead',key:false,children:[]},
      ]
    };

    const TRANSITION_PHASES=[
      {id:1,phase:'Phase 1: Mobilization',days:'Day 1-15',status:'PLANNED',tasks:['Contract kickoff & PMO standup','Key personnel onboarding & badging','Facility access & equipment provisioning','Initial KT sessions with incumbent','Tool/system access requests'],milestones:['KO Meeting Complete','PMO Operational','All KP Onboarded'],completion:0},
      {id:2,phase:'Phase 2: Knowledge Transfer',days:'Day 16-45',status:'PLANNED',tasks:['Shadowing incumbent operations','System architecture deep-dive','Process documentation review','Data access & migration prep','SLA baseline measurement'],milestones:['KT Plan Executed','System Access Granted','Baseline Metrics Captured'],completion:0},
      {id:3,phase:'Phase 3: Parallel Operations',days:'Day 46-75',status:'PLANNED',tasks:['Parallel processing with incumbent oversight','Graduated workload assumption (25%‚Üí50%‚Üí75%)','Deficiency identification & resolution','Continuous monitoring activation','Staff proficiency validation'],milestones:['50% Workload Assumed','ConMon Live','Zero Critical Deficiencies'],completion:0},
      {id:4,phase:'Phase 4: Full Operations',days:'Day 76-90',status:'PLANNED',tasks:['100% workload assumption','Incumbent release','Full SLA enforcement','Post-transition lessons learned','90-day assessment report'],milestones:['Full Operational Capability','Incumbent Released','90-Day Report Delivered'],completion:0},
    ];

    const RISKS=[
      {id:1,title:'Key Personnel Departure',prob:2,impact:5,score:10,category:'Staffing',mitigation:'Maintain bench of 2 pre-cleared alternates per KP role. Cross-training program ensures 2-deep coverage.',trigger:'KP resignation or extended leave >30 days',contingency:'Deploy alternate within 5 business days. Notify COR within 24 hours.',status:'MITIGATED',trend:'STABLE'},
      {id:2,title:'ATO Timeline Delay',prob:3,impact:4,score:12,category:'Security',mitigation:'Leverage Azure Gov FedRAMP High inheritance to reduce ATO scope by 65%. Begin ConMon from Day 1.',trigger:'Authorization delays exceeding 15 days from plan',contingency:'Escalate to ISSM. Deploy interim ATC if full ATO delayed.',status:'MITIGATED',trend:'IMPROVING'},
      {id:3,title:'Incumbent Non-Cooperation',prob:3,impact:3,score:9,category:'Transition',mitigation:'Automated knowledge capture tools operate independently. Government KT mandate in PWS.',trigger:'Incumbent misses 2+ scheduled KT sessions',contingency:'Activate independent discovery protocol. Engage CO for contract enforcement.',status:'MITIGATED',trend:'STABLE'},
      {id:4,title:'Data Migration Integrity',prob:2,impact:5,score:10,category:'Technical',mitigation:'4-phase migration with automated reconciliation at each gate. Parallel validation period before cutover.',trigger:'Data variance >0.1% in reconciliation',contingency:'Halt migration. Execute rollback to last validated checkpoint.',status:'MITIGATED',trend:'STABLE'},
      {id:5,title:'Scope Creep',prob:4,impact:3,score:12,category:'Management',mitigation:'Formal change control board (CCB) with impact assessment template. EVM tracking against baseline.',trigger:'>10% variance from baseline hours in any CLIN',contingency:'CCB review. Negotiate mod or re-baseline with CO approval.',status:'WATCH',trend:'STABLE'},
      {id:6,title:'Supply Chain / Tool Licensing',prob:2,impact:3,score:6,category:'Technical',mitigation:'Pre-negotiate enterprise licenses. Maintain approved vendor list. SBOM tracking.',trigger:'License expiration or vendor acquisition',contingency:'Activate backup tooling. 30-day license overlap maintained.',status:'MITIGATED',trend:'STABLE'},
      {id:7,title:'Staff Clearance Processing Delay',prob:3,impact:4,score:12,category:'Staffing',mitigation:'Pre-submit clearance packages 90 days before need-date. Maintain cleared bench.',trigger:'Clearance adjudication >120 days',contingency:'Deploy cleared interim staff. Escalate through SSO.',status:'WATCH',trend:'STABLE'},
      {id:8,title:'Subcontractor Performance',prob:2,impact:3,score:6,category:'Teaming',mitigation:'Monthly performance reviews. SLA flowdown to all subs. Backup sub pre-qualified.',trigger:'Sub misses 2+ deliverables or SLA targets',contingency:'Issue cure notice. Activate backup subcontractor.',status:'MITIGATED',trend:'STABLE'},
    ];

    const QCP_AREAS=[
      {area:'Deliverable Review',method:'Peer review + PM approval gate',frequency:'Per deliverable',metric:'100% deliverables reviewed before submission',tool:'MissionPulse HITL Module'},
      {area:'Code Quality',method:'Automated SAST/DAST + peer code review',frequency:'Every commit',metric:'Zero critical/high vulnerabilities in prod',tool:'SonarQube + GitLab'},
      {area:'Testing',method:'Automated regression + UAT',frequency:'Sprint cycle',metric:'>95% test pass rate; >80% code coverage',tool:'Selenium + Jest'},
      {area:'SLA Monitoring',method:'Automated dashboard + weekly reports',frequency:'Continuous',metric:'99.9% uptime; <4hr critical response',tool:'Datadog + ServiceNow'},
      {area:'508 Compliance',method:'Automated Axe-core + manual VPAT',frequency:'Per release',metric:'Zero WCAG 2.1 AA violations',tool:'Axe-core + manual audit'},
      {area:'Customer Satisfaction',method:'Monthly CPARS-aligned survey',frequency:'Monthly',metric:'>4.0/5.0 average rating',tool:'Survey tool + PMO review'},
      {area:'Process Improvement',method:'CMMI-based PIPs',frequency:'Quarterly',metric:'2+ process improvements per quarter',tool:'Lessons learned database'},
    ];

    const probColor=['','#00ff88','#86efac','#f59e0b','#fb923c','#ef4444'];
    const trendIcon={IMPROVING:'üìà',STABLE:'‚û°Ô∏è',WORSENING:'üìâ'};
    const ConnectionDot=({c})=>(<div style={{display:'flex',alignItems:'center',gap:'6px',fontSize:'11px',color:c?'#00ff88':'#f59e0b'}}><div style={{width:'8px',height:'8px',borderRadius:'50%',background:c?'#00ff88':'#f59e0b',boxShadow:`0 0 6px ${c?'#00ff88':'#f59e0b'}`}}/>{c?'LIVE':'DEMO'}</div>);

    const OrgNode=({node,depth=0})=>(
      <div style={{marginLeft:depth*28,marginBottom:'4px'}}>
        <div style={{display:'flex',alignItems:'center',gap:'8px',background:'rgba(10,22,40,0.5)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'8px',padding:'8px 12px',width:'fit-content'}}>
          {depth>0&&<div style={{width:'16px',borderBottom:'2px solid rgba(0,229,250,0.15)',marginLeft:'-20px'}}/>}
          <div>
            <div style={{fontSize:'12px',fontWeight:600,color:'white',display:'flex',alignItems:'center',gap:'4px'}}>
              {node.name}{node.key&&<span style={{fontSize:'8px',fontWeight:700,padding:'0 4px',borderRadius:'2px',background:'rgba(245,158,11,0.12)',color:'#f59e0b'}}>KP</span>}
            </div>
            <div style={{fontSize:'10px',color:'#5a7a9a'}}>{node.title}</div>
          </div>
        </div>
        {node.children&&node.children.map((c,i)=><OrgNode key={i} node={c} depth={depth+1}/>)}
      </div>
    );

    const App=()=>{
      const[connected,setConnected]=useState(false);
      const[tab,setTab]=useState('org');
      const[expandedRisk,setExpandedRisk]=useState(null);

      useEffect(()=>{if(!sbClient)return;(async()=>{try{const{data,error}=await sbClient.from('team_assignments').select('id');if(!error&&data&&data.length>0)setConnected(true)}catch{}})()},[]);

      return(
        <div style={{padding:'24px 32px',maxWidth:'1400px'}}>
          <div style={{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'24px'}}>
            <div>
              <div style={{fontSize:'10px',fontWeight:700,color:'rgba(0,229,250,0.5)',letterSpacing:'2px',textTransform:'uppercase',marginBottom:'4px'}}>PROPOSAL AUTHORING</div>
              <h1 style={{fontSize:'26px',fontWeight:800,color:'white',letterSpacing:'-0.5px',margin:0}}>Management Volume (Vol III)</h1>
              <div style={{fontSize:'12px',color:'#5a7a9a',marginTop:'4px'}}>DHA EHR Modernization ‚Ä¢ Org chart ‚Ä¢ Transition ‚Ä¢ QCP ‚Ä¢ Risk</div>
            </div>
            <ConnectionDot c={connected}/>
          </div>

          <div style={{display:'flex',gap:'10px',flexWrap:'wrap',marginBottom:'20px'}}>
            {[
              {label:'Key Personnel',value:5,color:'#f59e0b'},
              {label:'Total Staff',value:14,color:'#00E5FA'},
              {label:'Transition Days',value:90,color:'#a78bfa'},
              {label:'Risks Tracked',value:RISKS.length,color:'#00E5FA'},
              {label:'Avg Risk Score',value:(RISKS.reduce((s,r)=>s+r.score,0)/RISKS.length).toFixed(1),color:'#f59e0b'},
              {label:'QCP Areas',value:QCP_AREAS.length,color:'#00ff88'},
            ].map(s=>(
              <div key={s.label} style={{background:'rgba(10,22,40,0.7)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'10px',padding:'10px 16px',minWidth:'120px'}}>
                <div style={{fontSize:'9px',fontWeight:700,color:'#5a7a9a',letterSpacing:'0.5px',textTransform:'uppercase'}}>{s.label}</div>
                <div style={{fontSize:'22px',fontWeight:800,color:s.color,letterSpacing:'-0.5px'}}>{s.value}</div>
              </div>
            ))}
          </div>

          <div style={{display:'flex',gap:'4px',marginBottom:'16px'}}>
            {[{k:'org',l:'Org Chart'},{k:'transition',l:'Transition Plan'},{k:'risk',l:'Risk Register'},{k:'qcp',l:'QCP'}].map(t=>(
              <button key={t.k} onClick={()=>setTab(t.k)} style={{padding:'7px 16px',fontSize:'12px',fontWeight:600,borderRadius:'8px',border:'none',cursor:'pointer',background:tab===t.k?'rgba(0,229,250,0.15)':'rgba(10,22,40,0.5)',color:tab===t.k?'#00E5FA':'#5a7a9a'}}>{t.l}</button>
            ))}
          </div>

          {/* ORG CHART */}
          {tab==='org'&&(
            <div style={{background:'rgba(10,22,40,0.5)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'12px',padding:'20px',overflow:'auto'}}>
              <div style={{fontSize:'12px',fontWeight:700,color:'white',marginBottom:'12px'}}>Program Organization ‚Äî DHA EHR Modernization</div>
              <OrgNode node={ORG_CHART}/>
              <div style={{display:'flex',gap:'12px',marginTop:'16px',fontSize:'10px',color:'#5a7a9a'}}>
                <span><span style={{fontSize:'8px',fontWeight:700,padding:'0 4px',borderRadius:'2px',background:'rgba(245,158,11,0.12)',color:'#f59e0b',marginRight:'4px'}}>KP</span>Key Personnel (named in proposal)</span>
              </div>
            </div>
          )}

          {/* TRANSITION */}
          {tab==='transition'&&(
            <div style={{display:'flex',flexDirection:'column',gap:'10px'}}>
              {TRANSITION_PHASES.map((p,i)=>(
                <div key={p.id} style={{background:'rgba(10,22,40,0.5)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'12px',padding:'16px'}}>
                  <div style={{display:'flex',alignItems:'center',gap:'10px',marginBottom:'10px'}}>
                    <div style={{width:'32px',height:'32px',borderRadius:'50%',background:'rgba(0,229,250,0.08)',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'14px',fontWeight:800,color:'#00E5FA'}}>{i+1}</div>
                    <div>
                      <div style={{fontSize:'14px',fontWeight:700,color:'white'}}>{p.phase}</div>
                      <div style={{fontSize:'11px',color:'#00E5FA',fontWeight:600}}>{p.days}</div>
                    </div>
                  </div>
                  <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'16px'}}>
                    <div>
                      <div style={{fontSize:'9px',fontWeight:700,color:'#5a7a9a',letterSpacing:'0.5px',marginBottom:'6px'}}>KEY TASKS</div>
                      {p.tasks.map(t=><div key={t} style={{fontSize:'11px',color:'#94a3b8',padding:'2px 0'}}>‚ñ∏ {t}</div>)}
                    </div>
                    <div>
                      <div style={{fontSize:'9px',fontWeight:700,color:'#00ff88',letterSpacing:'0.5px',marginBottom:'6px'}}>EXIT MILESTONES</div>
                      {p.milestones.map(m=><div key={m} style={{fontSize:'11px',color:'#86efac',padding:'2px 0'}}>‚úì {m}</div>)}
                    </div>
                  </div>
                </div>
              ))}
            </div>
          )}

          {/* RISK REGISTER */}
          {tab==='risk'&&(
            <div style={{display:'flex',flexDirection:'column',gap:'6px'}}>
              {RISKS.sort((a,b)=>b.score-a.score).map(r=>(
                <div key={r.id} style={{background:'rgba(10,22,40,0.5)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'10px',overflow:'hidden'}}>
                  <div onClick={()=>setExpandedRisk(expandedRisk===r.id?null:r.id)} style={{padding:'12px 16px',cursor:'pointer',display:'flex',gap:'12px',alignItems:'center'}}>
                    <div style={{width:'36px',height:'36px',borderRadius:'8px',background:r.score>=12?'rgba(239,68,68,0.12)':r.score>=8?'rgba(245,158,11,0.12)':'rgba(0,255,136,0.08)',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'14px',fontWeight:800,color:r.score>=12?'#ef4444':r.score>=8?'#f59e0b':'#00ff88',flexShrink:0}}>{r.score}</div>
                    <div style={{flex:1}}>
                      <div style={{fontSize:'13px',fontWeight:600,color:'white'}}>{r.title}</div>
                      <div style={{display:'flex',gap:'8px',marginTop:'4px',fontSize:'10px',flexWrap:'wrap'}}>
                        <span style={{color:'#5a7a9a'}}>P:{r.prob} √ó I:{r.impact}</span>
                        <span style={{padding:'0 5px',borderRadius:'3px',background:'rgba(0,229,250,0.06)',color:'#67e8f9'}}>{r.category}</span>
                        <span style={{color:r.status==='MITIGATED'?'#00ff88':'#f59e0b',fontWeight:600}}>{r.status}</span>
                        <span>{trendIcon[r.trend]} {r.trend}</span>
                      </div>
                    </div>
                    <span style={{color:'#5a7a9a',fontSize:'16px',transform:expandedRisk===r.id?'rotate(180deg)':'rotate(0)',transition:'transform 0.2s'}}>‚ñæ</span>
                  </div>
                  {expandedRisk===r.id&&(
                    <div style={{padding:'0 16px 14px 64px',borderTop:'1px solid rgba(0,229,250,0.06)'}}>
                      <div style={{padding:'10px 0',display:'grid',gridTemplateColumns:'1fr 1fr',gap:'12px'}}>
                        <div><div style={{fontSize:'9px',fontWeight:700,color:'#00E5FA',marginBottom:'4px'}}>MITIGATION</div><div style={{fontSize:'11px',color:'#94a3b8',lineHeight:'1.5'}}>{r.mitigation}</div></div>
                        <div><div style={{fontSize:'9px',fontWeight:700,color:'#f59e0b',marginBottom:'4px'}}>TRIGGER</div><div style={{fontSize:'11px',color:'#fbbf24',lineHeight:'1.5'}}>{r.trigger}</div></div>
                      </div>
                      <div><div style={{fontSize:'9px',fontWeight:700,color:'#ef4444',marginBottom:'4px'}}>CONTINGENCY</div><div style={{fontSize:'11px',color:'#fca5a5',lineHeight:'1.5'}}>{r.contingency}</div></div>
                    </div>
                  )}
                </div>
              ))}
            </div>
          )}

          {/* QCP */}
          {tab==='qcp'&&(
            <div style={{background:'rgba(10,22,40,0.5)',border:'1px solid rgba(0,229,250,0.08)',borderRadius:'12px',overflow:'auto'}}>
              <table style={{width:'100%',borderCollapse:'collapse',fontSize:'12px'}}>
                <thead><tr style={{borderBottom:'1px solid rgba(0,229,250,0.1)'}}>
                  {['Quality Area','Method','Frequency','Metric','Tool'].map(h=>(
                    <th key={h} style={{padding:'10px 12px',textAlign:'left',color:'#5a7a9a',fontWeight:700,fontSize:'10px',letterSpacing:'0.5px',textTransform:'uppercase'}}>{h}</th>
                  ))}
                </tr></thead>
                <tbody>
                  {QCP_AREAS.map((q,i)=>(
                    <tr key={i} style={{borderBottom:'1px solid rgba(0,229,250,0.04)'}}>
                      <td style={{padding:'10px 12px',color:'white',fontWeight:600}}>{q.area}</td>
                      <td style={{padding:'10px 12px',color:'#94a3b8',fontSize:'11px'}}>{q.method}</td>
                      <td style={{padding:'10px 12px',color:'#00E5FA',fontSize:'11px',fontWeight:500}}>{q.frequency}</td>
                      <td style={{padding:'10px 12px',color:'#86efac',fontSize:'11px'}}>{q.metric}</td>
                      <td style={{padding:'10px 12px',color:'#5a7a9a',fontSize:'11px'}}>{q.tool}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}

          <div style={{textAlign:'center',padding:'20px 0',marginTop:'28px',borderTop:'1px solid rgba(0,229,250,0.06)',fontSize:'10px',color:'rgba(148,163,184,0.4)',lineHeight:'1.8'}}>‚ö†Ô∏è AI GENERATED ‚Äî REQUIRES HUMAN REVIEW<br/>MissionPulse v12.0 ‚Äî Mission Meets Tech | CMMC 2.0 L2 Compliant</div>
        </div>
      );
    };
    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  </script>
</body>
</html>
