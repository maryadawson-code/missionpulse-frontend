<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MissionPulse ‚Äî Compliance Matrix</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Inter',sans-serif;background:#00050F;min-height:100vh;color:#fff}
    @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
    .animate-fadeIn{animation:fadeIn .4s ease-out forwards}
    .glass{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);backdrop-filter:blur(20px)}
    .glow{box-shadow:0 0 20px rgba(0,229,250,.08)}
    input,textarea,select{font-family:'Inter',sans-serif}
    input:focus,textarea:focus,select:focus{outline:none;box-shadow:0 0 0 2px rgba(0,229,250,.3)}
    .row-hover{transition:all .15s}.row-hover:hover{background:rgba(0,229,250,.04)}
    .progress-ring{transform:rotate(-90deg)}
  </style>
  <script src="rbac-guard.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect,useMemo} = React;

const SB_URL='https://qdrtpnpnhkxvfmvfziop.supabase.co';
const SB_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY3MTcyNjUsImV4cCI6MjA1MjI5MzI2NX0.DACT1xnVtJeHx5tL7_K8y1hOx9NyJE7B6UBhPqwHHx8';
var sbClient;try{sbClient=supabase.createClient(SB_URL,SB_KEY)}catch(e){sbClient=null}

const ROLES_ALLOWED=['CEO','COO','CAP','PM','SA','CON','QA','Admin'];

const DEMO_ITEMS=[
  {id:'c1',opportunity_id:'opp1',opportunity_name:'DHA EHR Modernization',section:'L',ref:'L.4.1',requirement:'Technical Approach ‚Äî Describe your approach to migrating legacy EHR data to the modernized platform, including data validation, rollback procedures, and timeline.',response_section:'Vol I, Section 3.1',response_status:'complete',owner:'SA',eval_factor:'Technical Approach',eval_weight:40,priority:'critical',notes:'Maps to M.3.a discriminator #1',compliance_flag:'compliant',page_limit:15,current_pages:13},
  {id:'c2',opportunity_id:'opp1',opportunity_name:'DHA EHR Modernization',section:'L',ref:'L.4.2',requirement:'System Architecture ‚Äî Provide a detailed architecture diagram showing all system components, data flows, and security boundaries including FedRAMP authorization status.',response_section:'Vol I, Section 3.2',response_status:'in_progress',owner:'SA',eval_factor:'Technical Approach',eval_weight:40,priority:'critical',notes:'Include AskSage integration architecture',compliance_flag:'partial',page_limit:10,current_pages:7},
  {id:'c3',opportunity_id:'opp1',opportunity_name:'DHA EHR Modernization',section:'L',ref:'L.4.3',requirement:'Cybersecurity ‚Äî Detail your approach to CMMC 2.0 Level 2 compliance, continuous monitoring, and incident response within the MHS environment.',response_section:'Vol I, Section 3.3',response_status:'in_progress',owner:'CON',eval_factor:'Technical Approach',eval_weight:40,priority:'high',notes:'Reference MissionPulse SSP v2.1',compliance_flag:'partial',page_limit:8,current_pages:5},
  {id:'c4',opportunity_id:'opp1',opportunity_name:'DHA EHR Modernization',section:'L',ref:'L.5.1',requirement:'Management Approach ‚Äî Describe your program management methodology, staffing plan, and key personnel qualifications.',response_section:'Vol II, Section 2.1',response_status:'complete',owner:'PM',eval_factor:'Management Approach',eval_weight:30,priority:'high',notes:'Org chart required per amendment 3',compliance_flag:'compliant',page_limit:12,current_pages:11},
  {id:'c5',opportunity_id:'opp1',opportunity_name:'DHA EHR Modernization',section:'L',ref:'L.5.2',requirement:'Transition Plan ‚Äî Provide a 90-day transition-in plan with milestones, risk gates, and knowledge transfer approach.',response_section:'Vol II, Section 2.2',response_status:'draft',owner:'PM',eval_factor:'Management Approach',eval_weight:30,priority:'high',notes:'Zero-disruption language critical per debrief intel',compliance_flag:'gap',page_limit:8,current_pages:3},
  {id:'c6',opportunity_id:'opp1',opportunity_name:'DHA EHR Modernization',section:'L',ref:'L.5.3',requirement:'Quality Assurance ‚Äî Describe your QA/QC processes, defect tracking, and continuous improvement methodology.',response_section:'Vol II, Section 2.3',response_status:'not_started',owner:'QA',eval_factor:'Management Approach',eval_weight:30,priority:'medium',notes:'',compliance_flag:'gap',page_limit:6,current_pages:0},
  {id:'c7',opportunity_id:'opp1',opportunity_name:'DHA EHR Modernization',section:'L',ref:'L.6',requirement:'Price Volume ‚Äî Submit completed pricing model per Attachment J-4 format. FFP CLINs with option years.',response_section:'Vol III',response_status:'in_progress',owner:'FIN',eval_factor:'Price',eval_weight:30,priority:'critical',notes:'CUI ‚Äî Rate data restricted to FIN + CEO',compliance_flag:'partial',page_limit:null,current_pages:null},
  {id:'c8',opportunity_id:'opp1',opportunity_name:'DHA EHR Modernization',section:'M',ref:'M.3.a',requirement:'Technical Approach will be evaluated for innovation, feasibility, and understanding of DHA environment.',response_section:'‚Äî',response_status:'mapped',owner:'CAP',eval_factor:'Technical Approach',eval_weight:40,priority:'critical',notes:'Cross-ref L.4.1, L.4.2, L.4.3 ‚Äî ensure discriminators align to eval subfactors',compliance_flag:'compliant',page_limit:null,current_pages:null},
  {id:'c9',opportunity_id:'opp1',opportunity_name:'DHA EHR Modernization',section:'M',ref:'M.3.b',requirement:'Management Approach will be evaluated for reasonableness of staffing, qualifications, and risk mitigation.',response_section:'‚Äî',response_status:'mapped',owner:'CAP',eval_factor:'Management Approach',eval_weight:30,priority:'high',notes:'Key personnel resumes must match exactly ‚Äî verify before submission',compliance_flag:'compliant',page_limit:null,current_pages:null},
  {id:'c10',opportunity_id:'opp1',opportunity_name:'DHA EHR Modernization',section:'M',ref:'M.3.c',requirement:'Price will be evaluated for realism, completeness, and best value determination.',response_section:'‚Äî',response_status:'mapped',owner:'FIN',eval_factor:'Price',eval_weight:30,priority:'critical',notes:'Price realism analysis ‚Äî ensure rates are defensible vs GSA schedule',compliance_flag:'partial',page_limit:null,current_pages:null},
  {id:'c11',opportunity_id:'opp2',opportunity_name:'VA Claims Processing AI',section:'L',ref:'L.3.1',requirement:'AI/ML Approach ‚Äî Describe the AI models, training data governance, bias detection, and explainability framework.',response_section:'Vol I, Section 2.1',response_status:'draft',owner:'SA',eval_factor:'Technical Approach',eval_weight:50,priority:'critical',notes:'HITL architecture is primary discriminator',compliance_flag:'partial',page_limit:20,current_pages:8},
  {id:'c12',opportunity_id:'opp2',opportunity_name:'VA Claims Processing AI',section:'L',ref:'L.3.2',requirement:'Data Security ‚Äî Detail CUI handling procedures, de-identification methods, and FedRAMP compliance path for AI components.',response_section:'Vol I, Section 2.2',response_status:'not_started',owner:'CON',eval_factor:'Technical Approach',eval_weight:50,priority:'critical',notes:'Must address NIST AI RMF',compliance_flag:'gap',page_limit:10,current_pages:0},
];

function App(){
  const [userRole]=useState('CEO');
  const [dbStatus,setDbStatus]=useState('checking');
  const [loading,setLoading]=useState(true);
  const [items,setItems]=useState([]);
  const [search,setSearch]=useState('');
  const [sectionFilter,setSectionFilter]=useState('all');
  const [statusFilter,setStatusFilter]=useState('all');
  const [oppFilter,setOppFilter]=useState('all');
  const [priorityFilter,setPriorityFilter]=useState('all');
  const [expanded,setExpanded]=useState({});
  const [viewMode,setViewMode]=useState('matrix');

  useEffect(()=>{
    if(!ROLES_ALLOWED.includes(userRole)){window.location.href='/';return}
    loadData();
  },[]);

  async function loadData(){
    try{
      if(!sbClient) throw new Error('No DB');
      const {data,error}=await sbClient.from('compliance_items').select('*');
      if(error) throw error;
      if(data?.length>0){setItems(data);setDbStatus('live')}
      else{setItems(DEMO_ITEMS);setDbStatus('demo')}
    }catch{setItems(DEMO_ITEMS);setDbStatus('demo')}
    finally{setLoading(false)}
  }

  const toggle=(id)=>setExpanded(p=>({...p,[id]:!p[id]}));

  const opps=[...new Set(items.map(i=>i.opportunity_name))];

  const filtered=items.filter(i=>{
    const q=search.toLowerCase();
    const matchSearch=!q||i.requirement.toLowerCase().includes(q)||i.ref.toLowerCase().includes(q)||(i.response_section||'').toLowerCase().includes(q);
    const matchSec=sectionFilter==='all'||i.section===sectionFilter;
    const matchStatus=statusFilter==='all'||i.response_status===statusFilter;
    const matchOpp=oppFilter==='all'||i.opportunity_name===oppFilter;
    const matchPri=priorityFilter==='all'||i.priority===priorityFilter;
    return matchSearch&&matchSec&&matchStatus&&matchOpp&&matchPri;
  });

  // Stats
  const stats=useMemo(()=>{
    const total=items.length;
    const complete=items.filter(i=>i.response_status==='complete'||i.response_status==='mapped').length;
    const gaps=items.filter(i=>i.compliance_flag==='gap').length;
    const critical=items.filter(i=>i.priority==='critical').length;
    const critComplete=items.filter(i=>i.priority==='critical'&&(i.response_status==='complete'||i.response_status==='mapped')).length;
    const pagesUsed=items.reduce((a,i)=>a+(i.current_pages||0),0);
    const pagesAllowed=items.reduce((a,i)=>a+(i.page_limit||0),0);
    return{total,complete,pct:total?Math.round(complete/total*100):0,gaps,critical,critComplete,critPct:critical?Math.round(critComplete/critical*100):0,pagesUsed,pagesAllowed};
  },[items]);

  const statusColor=(s)=>({complete:'#00BDAE',mapped:'#00BDAE',in_progress:'#F59E0B',draft:'#3B82F6',not_started:'#EF4444'}[s]||'#64748B');
  const statusLabel=(s)=>({complete:'Complete',mapped:'Mapped',in_progress:'In Progress',draft:'Draft',not_started:'Not Started'}[s]||s);
  const flagColor=(f)=>({compliant:'#00BDAE',partial:'#F59E0B',gap:'#EF4444'}[f]||'#64748B');
  const flagIcon=(f)=>({compliant:'‚úÖ',partial:'‚ö†Ô∏è',gap:'‚ùå'}[f]||'‚Äî');
  const priColor=(p)=>({critical:'#EF4444',high:'#F59E0B',medium:'#3B82F6',low:'#64748B'}[p]||'#64748B');

  // Ring chart helper
  function Ring({pct,color,size=64,stroke=6}){
    const r=(size-stroke)/2;const c=2*Math.PI*r;const off=c-(pct/100)*c;
    return(
      <svg width={size} height={size} className="progress-ring">
        <circle cx={size/2} cy={size/2} r={r} fill="none" stroke="rgba(255,255,255,.06)" strokeWidth={stroke}/>
        <circle cx={size/2} cy={size/2} r={r} fill="none" stroke={color} strokeWidth={stroke} strokeDasharray={c} strokeDashoffset={off} strokeLinecap="round" style={{transition:'stroke-dashoffset .8s ease'}}/>
        <text x="50%" y="50%" textAnchor="middle" dy=".35em" fill={color} fontSize="14" fontWeight="800" style={{transform:'rotate(90deg)',transformOrigin:'center'}}>{pct}%</text>
      </svg>
    );
  }

  if(loading) return <div style={{display:'flex',alignItems:'center',justifyContent:'center',minHeight:'100vh',color:'#64748B'}}>Loading compliance matrix...</div>;

  return(
    <div style={{maxWidth:1440,margin:'0 auto',padding:'24px 20px 80px'}}>
      {/* Header */}
      <div style={{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:24,flexWrap:'wrap',gap:12}}>
        <div style={{display:'flex',alignItems:'center',gap:12}}>
          <a href="/" style={{color:'#64748B',textDecoration:'none',fontSize:13}}>‚Üê Dashboard</a>
          <span style={{color:'#1A2942'}}>|</span>
          <span style={{fontSize:13,color:'#64748B'}}>Compliance Matrix</span>
        </div>
        <div style={{display:'flex',alignItems:'center',gap:8}}>
          <span style={{width:8,height:8,borderRadius:'50%',background:dbStatus==='live'?'#00BDAE':'#F59E0B'}}></span>
          <span style={{fontSize:12,color:dbStatus==='live'?'#00BDAE':'#F59E0B'}}>{dbStatus==='live'?'Supabase Live':'Demo Data'}</span>
        </div>
      </div>

      <h1 style={{fontSize:28,fontWeight:800,marginBottom:4}}>üìã Compliance Matrix</h1>
      <p style={{color:'#94A3B8',fontSize:14,marginBottom:24}}>Section L/M requirement tracking with response mapping & gap analysis</p>

      {/* Stats Row */}
      <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fit,minmax(130px,1fr))',gap:12,marginBottom:24}}>
        <div className="glass glow" style={{padding:16,borderRadius:14,textAlign:'center',display:'flex',flexDirection:'column',alignItems:'center'}}>
          <Ring pct={stats.pct} color={stats.pct>=80?'#00BDAE':stats.pct>=50?'#F59E0B':'#EF4444'}/>
          <div style={{fontSize:11,color:'#94A3B8',marginTop:6}}>Overall Complete</div>
        </div>
        <div className="glass" style={{padding:16,borderRadius:14,textAlign:'center'}}>
          <div style={{fontSize:26,fontWeight:800,color:'#00E5FA'}}>{stats.total}</div>
          <div style={{fontSize:11,color:'#94A3B8',marginTop:4}}>Total Requirements</div>
        </div>
        <div className="glass" style={{padding:16,borderRadius:14,textAlign:'center'}}>
          <div style={{fontSize:26,fontWeight:800,color:stats.gaps>0?'#EF4444':'#00BDAE'}}>{stats.gaps}</div>
          <div style={{fontSize:11,color:'#94A3B8',marginTop:4}}>Compliance Gaps</div>
        </div>
        <div className="glass" style={{padding:16,borderRadius:14,textAlign:'center'}}>
          <div style={{fontSize:26,fontWeight:800,color:'#EF4444'}}>{stats.critComplete}/{stats.critical}</div>
          <div style={{fontSize:11,color:'#94A3B8',marginTop:4}}>Critical Done</div>
        </div>
        <div className="glass" style={{padding:16,borderRadius:14,textAlign:'center'}}>
          <div style={{fontSize:26,fontWeight:800,color:stats.pagesUsed>stats.pagesAllowed?'#EF4444':'#00E5FA'}}>{stats.pagesUsed}/{stats.pagesAllowed}</div>
          <div style={{fontSize:11,color:'#94A3B8',marginTop:4}}>Pages Used</div>
        </div>
      </div>

      {/* Filters */}
      <div style={{display:'flex',gap:8,marginBottom:12,flexWrap:'wrap'}}>
        <input value={search} onChange={e=>setSearch(e.target.value)} placeholder="Search requirements, refs..." style={{flex:1,minWidth:200,padding:'10px 14px',borderRadius:10,background:'rgba(255,255,255,.04)',border:'1px solid rgba(255,255,255,.08)',color:'#fff',fontSize:13,outline:'none'}}/>
        <select value={oppFilter} onChange={e=>setOppFilter(e.target.value)} style={{padding:'8px 12px',borderRadius:8,background:'#0A1628',border:'1px solid rgba(255,255,255,.08)',color:'#94A3B8',fontSize:12,cursor:'pointer'}}>
          <option value="all">All Opportunities</option>
          {opps.map(o=><option key={o} value={o}>{o}</option>)}
        </select>
      </div>
      <div style={{display:'flex',gap:6,marginBottom:20,flexWrap:'wrap'}}>
        {['all','L','M'].map(s=>(
          <button key={s} onClick={()=>setSectionFilter(s)} style={{padding:'6px 14px',borderRadius:7,border:'1px solid',borderColor:sectionFilter===s?'rgba(0,229,250,.4)':'rgba(255,255,255,.08)',background:sectionFilter===s?'rgba(0,229,250,.12)':'transparent',color:sectionFilter===s?'#00E5FA':'#94A3B8',fontSize:11,fontWeight:600,cursor:'pointer',fontFamily:'inherit'}}>¬ß{s==='all'?'All':s}</button>
        ))}
        <span style={{color:'#1A2942',margin:'0 2px'}}>|</span>
        {['all','complete','in_progress','draft','not_started','mapped'].map(s=>(
          <button key={s} onClick={()=>setStatusFilter(s)} style={{padding:'6px 12px',borderRadius:7,border:'1px solid',borderColor:statusFilter===s?`${statusColor(s)}60`:'rgba(255,255,255,.08)',background:statusFilter===s?`${statusColor(s)}18`:'transparent',color:statusFilter===s?statusColor(s):'#94A3B8',fontSize:11,fontWeight:600,cursor:'pointer',fontFamily:'inherit',textTransform:'capitalize'}}>{statusLabel(s)}</button>
        ))}
        <span style={{color:'#1A2942',margin:'0 2px'}}>|</span>
        {['all','critical','high','medium'].map(p=>(
          <button key={p} onClick={()=>setPriorityFilter(p)} style={{padding:'6px 12px',borderRadius:7,border:'1px solid',borderColor:priorityFilter===p?`${priColor(p)}60`:'rgba(255,255,255,.08)',background:priorityFilter===p?`${priColor(p)}18`:'transparent',color:priorityFilter===p?priColor(p):'#94A3B8',fontSize:11,fontWeight:600,cursor:'pointer',fontFamily:'inherit',textTransform:'capitalize'}}>{p}</button>
        ))}
      </div>

      {/* Matrix Table */}
      <div className="glass" style={{borderRadius:14,overflow:'hidden'}}>
        <div style={{overflowX:'auto'}}>
          <table style={{width:'100%',borderCollapse:'collapse',fontSize:12}}>
            <thead>
              <tr style={{borderBottom:'1px solid rgba(255,255,255,.08)',background:'rgba(0,229,250,.03)'}}>
                <th style={{padding:'12px 10px',textAlign:'left',color:'#64748B',fontWeight:600,whiteSpace:'nowrap'}}>Ref</th>
                <th style={{padding:'12px 10px',textAlign:'left',color:'#64748B',fontWeight:600,minWidth:280}}>Requirement</th>
                <th style={{padding:'12px 10px',textAlign:'center',color:'#64748B',fontWeight:600}}>Response</th>
                <th style={{padding:'12px 10px',textAlign:'center',color:'#64748B',fontWeight:600}}>Status</th>
                <th style={{padding:'12px 10px',textAlign:'center',color:'#64748B',fontWeight:600}}>Compliance</th>
                <th style={{padding:'12px 10px',textAlign:'center',color:'#64748B',fontWeight:600}}>Priority</th>
                <th style={{padding:'12px 10px',textAlign:'center',color:'#64748B',fontWeight:600}}>Owner</th>
                <th style={{padding:'12px 10px',textAlign:'center',color:'#64748B',fontWeight:600}}>Pages</th>
              </tr>
            </thead>
            <tbody>
              {filtered.map((item,i)=>(
                <React.Fragment key={item.id}>
                  <tr className="row-hover animate-fadeIn" style={{borderBottom:'1px solid rgba(255,255,255,.04)',cursor:'pointer',animationDelay:`${i*0.03}s`,opacity:0}} onClick={()=>toggle(item.id)}>
                    <td style={{padding:'10px',fontWeight:700,color:'#00E5FA',whiteSpace:'nowrap'}}>
                      <span style={{background:item.section==='L'?'rgba(0,229,250,.1)':'rgba(168,85,247,.1)',color:item.section==='L'?'#00E5FA':'#A855F7',padding:'2px 8px',borderRadius:4,fontSize:11,fontWeight:700}}>¬ß{item.ref}</span>
                    </td>
                    <td style={{padding:'10px',color:'#E2E8F0',lineHeight:1.4,maxWidth:400}}>
                      <div style={{overflow:'hidden',textOverflow:'ellipsis',display:'-webkit-box',WebkitLineClamp:expanded[item.id]?'none':2,WebkitBoxOrient:'vertical'}}>{item.requirement}</div>
                    </td>
                    <td style={{padding:'10px',textAlign:'center',color:'#94A3B8',whiteSpace:'nowrap',fontSize:11}}>{item.response_section||'‚Äî'}</td>
                    <td style={{padding:'10px',textAlign:'center'}}>
                      <span style={{padding:'3px 8px',borderRadius:5,fontSize:10,fontWeight:600,background:`${statusColor(item.response_status)}18`,color:statusColor(item.response_status),whiteSpace:'nowrap'}}>{statusLabel(item.response_status)}</span>
                    </td>
                    <td style={{padding:'10px',textAlign:'center',fontSize:14}}>{flagIcon(item.compliance_flag)}</td>
                    <td style={{padding:'10px',textAlign:'center'}}>
                      <span style={{padding:'2px 8px',borderRadius:4,fontSize:10,fontWeight:700,background:`${priColor(item.priority)}18`,color:priColor(item.priority),textTransform:'uppercase'}}>{item.priority}</span>
                    </td>
                    <td style={{padding:'10px',textAlign:'center',color:'#94A3B8',fontWeight:600,fontSize:11}}>{item.owner}</td>
                    <td style={{padding:'10px',textAlign:'center',fontSize:11}}>
                      {item.page_limit?(
                        <span style={{color:item.current_pages>item.page_limit?'#EF4444':item.current_pages>=item.page_limit*0.9?'#F59E0B':'#94A3B8'}}>{item.current_pages}/{item.page_limit}</span>
                      ):'‚Äî'}
                    </td>
                  </tr>
                  {expanded[item.id]&&(
                    <tr style={{background:'rgba(0,229,250,.02)'}}>
                      <td colSpan={8} style={{padding:'12px 16px'}}>
                        <div style={{display:'grid',gridTemplateColumns:'1fr 1fr 1fr',gap:16,fontSize:12}}>
                          <div>
                            <div style={{color:'#00E5FA',fontWeight:700,marginBottom:4}}>Evaluation Factor</div>
                            <div style={{color:'#94A3B8'}}>{item.eval_factor} ({item.eval_weight}%)</div>
                          </div>
                          <div>
                            <div style={{color:'#00E5FA',fontWeight:700,marginBottom:4}}>Compliance Status</div>
                            <div style={{display:'flex',alignItems:'center',gap:6}}>
                              <span style={{color:flagColor(item.compliance_flag),fontWeight:600,textTransform:'capitalize'}}>{item.compliance_flag}</span>
                            </div>
                          </div>
                          <div>
                            <div style={{color:'#00E5FA',fontWeight:700,marginBottom:4}}>Opportunity</div>
                            <div style={{color:'#94A3B8'}}>{item.opportunity_name}</div>
                          </div>
                        </div>
                        {item.notes&&(
                          <div style={{marginTop:10,padding:10,borderRadius:8,background:'rgba(245,158,11,.06)',border:'1px solid rgba(245,158,11,.1)',fontSize:12,color:'#94A3B8'}}>
                            <strong style={{color:'#F59E0B'}}>Notes:</strong> {item.notes}
                          </div>
                        )}
                      </td>
                    </tr>
                  )}
                </React.Fragment>
              ))}
            </tbody>
          </table>
        </div>
      </div>

      {filtered.length===0&&<div style={{textAlign:'center',padding:40,color:'#64748B',fontSize:13}}>No requirements match your filters</div>}

      {/* Eval Factor Summary */}
      <div className="glass" style={{marginTop:24,padding:20,borderRadius:14}}>
        <h3 style={{fontSize:15,fontWeight:700,marginBottom:12}}>üìä Evaluation Factor Readiness</h3>
        <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(240px,1fr))',gap:12}}>
          {[...new Set(items.map(i=>i.eval_factor))].map(ef=>{
            const efItems=items.filter(i=>i.eval_factor===ef);
            const efDone=efItems.filter(i=>i.response_status==='complete'||i.response_status==='mapped').length;
            const efPct=efItems.length?Math.round(efDone/efItems.length*100):0;
            const weight=efItems[0]?.eval_weight||0;
            return(
              <div key={ef} style={{padding:14,borderRadius:10,background:'rgba(255,255,255,.02)',border:'1px solid rgba(255,255,255,.04)'}}>
                <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:8}}>
                  <div style={{fontSize:13,fontWeight:700}}>{ef}</div>
                  <span style={{fontSize:11,color:'#64748B'}}>{weight}%</span>
                </div>
                <div style={{height:6,borderRadius:3,background:'rgba(255,255,255,.06)',overflow:'hidden',marginBottom:6}}>
                  <div style={{height:'100%',borderRadius:3,width:`${efPct}%`,background:efPct>=80?'#00BDAE':efPct>=50?'#F59E0B':'#EF4444',transition:'width .6s'}}/>
                </div>
                <div style={{display:'flex',justifyContent:'space-between',fontSize:11,color:'#64748B'}}>
                  <span>{efDone}/{efItems.length} complete</span>
                  <span style={{color:efPct>=80?'#00BDAE':efPct>=50?'#F59E0B':'#EF4444',fontWeight:700}}>{efPct}%</span>
                </div>
              </div>
            );
          })}
        </div>
      </div>

      <footer style={{position:'fixed',bottom:0,left:0,right:0,textAlign:'center',padding:'10px 16px',background:'linear-gradient(transparent,rgba(0,5,15,.95))',zIndex:50}}>
        <div style={{display:'flex',alignItems:'center',justifyContent:'center',gap:8,flexWrap:'wrap'}}>
          <span style={{fontSize:11,color:'#64748B'}}>‚ö†Ô∏è AI GENERATED ‚Äî REQUIRES HUMAN REVIEW</span>
          <span style={{fontSize:11,color:'#475569'}}>|</span>
          <span style={{fontSize:11,color:'#475569'}}>MissionPulse v12.0 ‚Äî Mission Meets Tech</span>
          <span style={{fontSize:11,color:'#475569'}}>|</span>
          <span style={{fontSize:11,color:'#475569'}}>CMMC 2.0 L2 Compliant</span>
        </div>
      </footer>
    </div>
  );
}

ReactDOM.render(<App/>,document.getElementById('root'));
</script>
</body>
</html>
