<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings | MissionPulse</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0a1628; }
        ::-webkit-scrollbar-thumb { background: #00E5FA; border-radius: 3px; }
        .toggle-switch { transition: all 0.3s; }
        .toggle-switch.active { background: #00E5FA; }
        .toggle-switch.active .toggle-knob { transform: translateX(20px); }
    </style>
  <script src="rbac-guard.js"></script>
</head>
<body class="bg-[#00050F] text-white min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const SUPABASE_URL = 'https://qdrtpnpnhkxvfmvfziop.supabase.co';
        const SUPABASE_ANON = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcnRwbnBuaGt4dmZtdmZ6aW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY3MTcyNjUsImV4cCI6MjA1MjI5MzI2NX0.DACT1xnVtJeHx5tL7_K8y1hOx9NyJE7B6UBhPqwHHx8';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON);

        const TABS = ['Profile', 'Notifications', 'Security', 'Integrations', 'Display', 'About'];

        const Toggle = ({ enabled, onChange, label }) => (
            <div className="flex items-center justify-between py-3">
                <span className="text-white/80">{label}</span>
                <button
                    onClick={() => onChange(!enabled)}
                    className={`toggle-switch w-12 h-6 rounded-full p-1 ${enabled ? 'active bg-[#00E5FA]' : 'bg-white/20'}`}
                >
                    <div className={`toggle-knob w-4 h-4 bg-white rounded-full transition-transform ${enabled ? 'translate-x-5' : ''}`}></div>
                </button>
            </div>
        );

        const App = () => {
            const [activeTab, setActiveTab] = useState('Profile');
            const [settings, setSettings] = useState({
                // Profile
                name: 'Mary Womack',
                email: 'maryadawson@gmail.com',
                role: 'CEO',
                company: 'Mission Meets Tech',
                // Notifications
                emailNotifications: true,
                desktopNotifications: true,
                slackNotifications: false,
                dueDateReminders: true,
                aiApprovalAlerts: true,
                weeklyDigest: true,
                // Security
                twoFactorEnabled: false,
                sessionTimeout: 30,
                auditLogging: true,
                // Display
                darkMode: true,
                compactView: false,
                showPipelineValue: true,
                defaultView: 'dashboard',
                // Integrations
                hubspotConnected: false,
                slackConnected: false,
                sharepointConnected: false,
                samGovConnected: true
            });
            const [saved, setSaved] = useState(false);

            const updateSetting = (key, value) => {
                setSettings(prev => ({ ...prev, [key]: value }));
                setSaved(false);
            };

            const saveSettings = () => {
                localStorage.setItem('missionpulse_settings', JSON.stringify(settings));
                setSaved(true);
                setTimeout(() => setSaved(false), 3000);
            };

            useEffect(() => {
                const stored = localStorage.getItem('missionpulse_settings');
                if (stored) {
                    setSettings(prev => ({ ...prev, ...JSON.parse(stored) }));
                }
            }, []);

            const ProfileTab = () => (
                <div className="space-y-6">
                    <div className="flex items-center gap-6 mb-8">
                        <div className="w-24 h-24 bg-gradient-to-br from-[#00E5FA]/30 to-[#0066FF]/30 rounded-full flex items-center justify-center text-4xl border-2 border-[#00E5FA]/30">
                            üëë
                        </div>
                        <div>
                            <h2 className="text-2xl font-bold">{settings.name}</h2>
                            <p className="text-white/60">{settings.role} at {settings.company}</p>
                            <button className="mt-2 text-sm text-[#00E5FA] hover:underline">Change Avatar</button>
                        </div>
                    </div>

                    <div className="grid grid-cols-2 gap-6">
                        <div>
                            <label className="block text-sm text-white/60 mb-2">Full Name</label>
                            <input
                                type="text"
                                value={settings.name}
                                onChange={(e) => updateSetting('name', e.target.value)}
                                className="w-full bg-[#00050F] border border-white/10 rounded-lg px-4 py-3 text-white focus:border-[#00E5FA] focus:outline-none"
                            />
                        </div>
                        <div>
                            <label className="block text-sm text-white/60 mb-2">Email</label>
                            <input
                                type="email"
                                value={settings.email}
                                onChange={(e) => updateSetting('email', e.target.value)}
                                className="w-full bg-[#00050F] border border-white/10 rounded-lg px-4 py-3 text-white focus:border-[#00E5FA] focus:outline-none"
                            />
                        </div>
                        <div>
                            <label className="block text-sm text-white/60 mb-2">Role</label>
                            <select
                                value={settings.role}
                                onChange={(e) => updateSetting('role', e.target.value)}
                                className="w-full bg-[#00050F] border border-white/10 rounded-lg px-4 py-3 text-white focus:border-[#00E5FA] focus:outline-none"
                            >
                                {['CEO', 'COO', 'CAP', 'PM', 'SA', 'FIN', 'CON', 'DEL', 'QA', 'Partner', 'Admin'].map(r => (
                                    <option key={r} value={r}>{r}</option>
                                ))}
                            </select>
                        </div>
                        <div>
                            <label className="block text-sm text-white/60 mb-2">Company</label>
                            <input
                                type="text"
                                value={settings.company}
                                onChange={(e) => updateSetting('company', e.target.value)}
                                className="w-full bg-[#00050F] border border-white/10 rounded-lg px-4 py-3 text-white focus:border-[#00E5FA] focus:outline-none"
                            />
                        </div>
                    </div>
                </div>
            );

            const NotificationsTab = () => (
                <div className="space-y-6">
                    <div className="bg-[#00050F] rounded-xl p-6 border border-white/10">
                        <h3 className="font-semibold mb-4">Email Notifications</h3>
                        <Toggle label="Email notifications" enabled={settings.emailNotifications} onChange={(v) => updateSetting('emailNotifications', v)} />
                        <Toggle label="Weekly digest" enabled={settings.weeklyDigest} onChange={(v) => updateSetting('weeklyDigest', v)} />
                        <Toggle label="Due date reminders" enabled={settings.dueDateReminders} onChange={(v) => updateSetting('dueDateReminders', v)} />
                    </div>

                    <div className="bg-[#00050F] rounded-xl p-6 border border-white/10">
                        <h3 className="font-semibold mb-4">In-App Notifications</h3>
                        <Toggle label="Desktop notifications" enabled={settings.desktopNotifications} onChange={(v) => updateSetting('desktopNotifications', v)} />
                        <Toggle label="AI approval alerts" enabled={settings.aiApprovalAlerts} onChange={(v) => updateSetting('aiApprovalAlerts', v)} />
                        <Toggle label="Slack notifications" enabled={settings.slackNotifications} onChange={(v) => updateSetting('slackNotifications', v)} />
                    </div>
                </div>
            );

            const SecurityTab = () => (
                <div className="space-y-6">
                    <div className="bg-[#00050F] rounded-xl p-6 border border-white/10">
                        <h3 className="font-semibold mb-4">Authentication</h3>
                        <Toggle label="Two-factor authentication" enabled={settings.twoFactorEnabled} onChange={(v) => updateSetting('twoFactorEnabled', v)} />
                        <div className="flex items-center justify-between py-3">
                            <span className="text-white/80">Session timeout (minutes)</span>
                            <select
                                value={settings.sessionTimeout}
                                onChange={(e) => updateSetting('sessionTimeout', parseInt(e.target.value))}
                                className="bg-[#0d1f3c] border border-white/10 rounded-lg px-3 py-1.5 text-white"
                            >
                                {[15, 30, 60, 120].map(m => (
                                    <option key={m} value={m}>{m} min</option>
                                ))}
                            </select>
                        </div>
                    </div>

                    <div className="bg-[#00050F] rounded-xl p-6 border border-white/10">
                        <h3 className="font-semibold mb-4">Audit & Compliance</h3>
                        <Toggle label="Audit logging enabled" enabled={settings.auditLogging} onChange={(v) => updateSetting('auditLogging', v)} />
                        <p className="text-sm text-white/50 mt-2">All actions are logged for CMMC 2.0 compliance</p>
                    </div>

                    <div className="bg-[#00050F] rounded-xl p-6 border border-white/10">
                        <h3 className="font-semibold mb-4">Password</h3>
                        <button className="px-4 py-2 bg-white/10 rounded-lg hover:bg-white/20">Change Password</button>
                    </div>
                </div>
            );

            const IntegrationsTab = () => (
                <div className="space-y-4">
                    {[
                        { name: 'HubSpot CRM', icon: 'üîó', key: 'hubspotConnected', desc: 'Sync opportunities with HubSpot deals' },
                        { name: 'Slack', icon: 'üí¨', key: 'slackConnected', desc: 'Get notifications in Slack channels' },
                        { name: 'SharePoint', icon: 'üìÅ', key: 'sharepointConnected', desc: 'Connect document library' },
                        { name: 'SAM.gov', icon: 'üèõÔ∏è', key: 'samGovConnected', desc: 'Import federal opportunities' },
                    ].map(integration => (
                        <div key={integration.key} className="bg-[#00050F] rounded-xl p-6 border border-white/10 flex items-center justify-between">
                            <div className="flex items-center gap-4">
                                <span className="text-2xl">{integration.icon}</span>
                                <div>
                                    <h3 className="font-semibold">{integration.name}</h3>
                                    <p className="text-sm text-white/50">{integration.desc}</p>
                                </div>
                            </div>
                            <button 
                                onClick={() => updateSetting(integration.key, !settings[integration.key])}
                                className={`px-4 py-2 rounded-lg font-medium ${settings[integration.key] ? 'bg-emerald-500/20 text-emerald-400' : 'bg-white/10 text-white/60'}`}
                            >
                                {settings[integration.key] ? '‚úì Connected' : 'Connect'}
                            </button>
                        </div>
                    ))}
                </div>
            );

            const DisplayTab = () => (
                <div className="space-y-6">
                    <div className="bg-[#00050F] rounded-xl p-6 border border-white/10">
                        <h3 className="font-semibold mb-4">Appearance</h3>
                        <Toggle label="Dark mode" enabled={settings.darkMode} onChange={(v) => updateSetting('darkMode', v)} />
                        <Toggle label="Compact view" enabled={settings.compactView} onChange={(v) => updateSetting('compactView', v)} />
                        <Toggle label="Show pipeline value in header" enabled={settings.showPipelineValue} onChange={(v) => updateSetting('showPipelineValue', v)} />
                    </div>

                    <div className="bg-[#00050F] rounded-xl p-6 border border-white/10">
                        <h3 className="font-semibold mb-4">Default View</h3>
                        <select
                            value={settings.defaultView}
                            onChange={(e) => updateSetting('defaultView', e.target.value)}
                            className="w-full bg-[#0d1f3c] border border-white/10 rounded-lg px-4 py-3 text-white"
                        >
                            {['dashboard', 'pipeline', 'warroom', 'swimlane'].map(v => (
                                <option key={v} value={v}>{v.charAt(0).toUpperCase() + v.slice(1)}</option>
                            ))}
                        </select>
                    </div>
                </div>
            );

            const AboutTab = () => (
                <div className="space-y-6">
                    <div className="bg-[#00050F] rounded-xl p-6 border border-white/10 text-center">
                        <div className="w-20 h-20 bg-gradient-to-br from-[#00E5FA] to-[#0066FF] rounded-xl flex items-center justify-center text-3xl mx-auto mb-4">üõ°Ô∏è</div>
                        <h2 className="text-2xl font-bold">MissionPulse</h2>
                        <p className="text-white/60 mt-1">Federal Proposal Intelligence Platform</p>
                        <p className="text-[#00E5FA] font-mono mt-2">v2.0.0</p>
                    </div>

                    <div className="bg-[#00050F] rounded-xl p-6 border border-white/10">
                        <h3 className="font-semibold mb-4">System Information</h3>
                        <dl className="space-y-2 text-sm">
                            <div className="flex justify-between"><dt className="text-white/60">Database</dt><dd>Supabase (qdrtpnpnhkxvfmvfziop)</dd></div>
                            <div className="flex justify-between"><dt className="text-white/60">API</dt><dd>Render (missionpulse-api)</dd></div>
                            <div className="flex justify-between"><dt className="text-white/60">Hosting</dt><dd>Netlify</dd></div>
                            <div className="flex justify-between"><dt className="text-white/60">AI Agents</dt><dd>8 Active</dd></div>
                            <div className="flex justify-between"><dt className="text-white/60">Compliance</dt><dd className="text-emerald-400">CMMC 2.0</dd></div>
                        </dl>
                    </div>

                    <div className="bg-[#00050F] rounded-xl p-6 border border-white/10">
                        <h3 className="font-semibold mb-2">Mission Meets Tech</h3>
                        <p className="text-sm text-white/60">Mission. Technology. Transformation.</p>
                        <p className="text-sm text-white/40 mt-4">¬© 2026 Mission Meets Tech. All rights reserved.</p>
                    </div>
                </div>
            );

            const renderTab = () => {
                switch (activeTab) {
                    case 'Profile': return <ProfileTab />;
                    case 'Notifications': return <NotificationsTab />;
                    case 'Security': return <SecurityTab />;
                    case 'Integrations': return <IntegrationsTab />;
                    case 'Display': return <DisplayTab />;
                    case 'About': return <AboutTab />;
                    default: return null;
                }
            };

            return (
                <div className="min-h-screen bg-[#00050F] p-6">
                    <div className="max-w-5xl mx-auto">
                        {/* Header */}
                        <div className="flex items-center justify-between mb-6">
                            <div>
                                <h1 className="text-2xl font-bold flex items-center gap-3">
                                    <span className="text-3xl">‚öôÔ∏è</span>
                                    Settings
                                </h1>
                                <p className="text-white/60 mt-1">Manage your account and preferences</p>
                            </div>
                            <button
                                onClick={saveSettings}
                                className={`px-6 py-2 rounded-lg font-medium transition-all ${saved ? 'bg-emerald-500 text-white' : 'bg-[#00E5FA] text-[#00050F] hover:bg-[#00E5FA]/90'}`}
                            >
                                {saved ? '‚úì Saved' : 'Save Changes'}
                            </button>
                        </div>

                        <div className="flex gap-6">
                            {/* Sidebar */}
                            <div className="w-48 flex-shrink-0">
                                <nav className="space-y-1">
                                    {TABS.map(tab => (
                                        <button
                                            key={tab}
                                            onClick={() => setActiveTab(tab)}
                                            className={`w-full px-4 py-2.5 rounded-lg text-left transition-colors ${activeTab === tab ? 'bg-[#00E5FA]/20 text-[#00E5FA]' : 'text-white/60 hover:bg-white/5 hover:text-white'}`}
                                        >
                                            {tab}
                                        </button>
                                    ))}
                                </nav>
                            </div>

                            {/* Content */}
                            <div className="flex-1 bg-[#0d1f3c] rounded-xl p-6 border border-white/10">
                                {renderTab()}
                            </div>
                        </div>
                    </div>

                    <div className="fixed bottom-0 left-0 right-0 bg-[#00050F]/90 border-t border-white/10 p-2 text-center text-xs text-white/40">
                        AI GENERATED - REQUIRES HUMAN REVIEW | MissionPulse ¬© 2026 Mission Meets Tech
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
