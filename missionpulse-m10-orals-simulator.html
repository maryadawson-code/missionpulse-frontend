<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MissionPulse M10 - Orals Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'mmt-cyan': '#00E5FA',
                        'mmt-navy': '#00050F',
                        'mmt-cyan-dark': '#00B8C8',
                        'mmt-slate': '#0A1628',
                        'mmt-gray': '#1E293B',
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .glow-cyan { box-shadow: 0 0 20px rgba(0, 229, 250, 0.3); }
        .pulse-ring { animation: pulse-ring 2s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite; }
        @keyframes pulse-ring {
            0% { box-shadow: 0 0 0 0 rgba(0, 229, 250, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0, 229, 250, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 229, 250, 0); }
        }
        .timer-critical { animation: timer-flash 0.5s ease-in-out infinite; }
        @keyframes timer-flash {
            0%, 100% { color: #EF4444; }
            50% { color: #FCA5A5; }
        }
        .score-excellent { background: linear-gradient(135deg, #10B981, #059669); }
        .score-acceptable { background: linear-gradient(135deg, #3B82F6, #2563EB); }
        .score-marginal { background: linear-gradient(135deg, #F59E0B, #D97706); }
        .score-unacceptable { background: linear-gradient(135deg, #EF4444, #DC2626); }
        .evaluator-card:hover { transform: translateY(-2px); transition: all 0.2s ease; }
        .recording-pulse { animation: rec-pulse 1.5s ease-in-out infinite; }
        @keyframes rec-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="bg-mmt-navy min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;

        // ============== DEMO DATA ==============
        const DEMO_OPPORTUNITY = {
            id: "OPP-2025-001",
            title: "VA Electronic Health Record Modernization",
            agency: "Department of Veterans Affairs",
            value: "$47.2M",
            dueDate: "2025-02-28",
            oralsDate: "2025-03-15",
            stage: "Gold Team (90%)"
        };

        const EVALUATOR_PERSONAS = {
            technical: {
                id: "technical",
                name: "Dr. Sarah Chen",
                title: "Technical Evaluation Chair",
                avatar: "üë©‚Äçüî¨",
                color: "from-purple-500 to-indigo-600",
                style: "Direct and detail-oriented. Focuses on architecture, scalability, and technical feasibility.",
                focusAreas: ["System Architecture", "Integration Approach", "Security Controls", "Scalability"]
            },
            contracts: {
                id: "contracts",
                name: "James Morrison",
                title: "Contracting Officer",
                avatar: "üë®‚Äçüíº",
                color: "from-blue-500 to-cyan-600",
                style: "Formal and compliance-focused. Emphasizes FAR/DFARS adherence and contract terms.",
                focusAreas: ["FAR Compliance", "Contract Terms", "Subcontracting Plan", "Small Business Goals"]
            },
            cost: {
                id: "cost",
                name: "Patricia Williams",
                title: "Cost/Price Analyst",
                avatar: "üë©‚Äçüíª",
                color: "from-green-500 to-emerald-600",
                style: "Analytical and probing. Questions labor rates, BOE assumptions, and cost realism.",
                focusAreas: ["Labor Rate Basis", "BOE Methodology", "Cost Realism", "Price Reasonableness"]
            },
            past_performance: {
                id: "past_performance",
                name: "Michael Torres",
                title: "Past Performance Evaluator",
                avatar: "üë®‚Äç‚öñÔ∏è",
                color: "from-orange-500 to-amber-600",
                style: "Skeptical but fair. Probes for relevance, recency, and lessons learned.",
                focusAreas: ["Contract Relevance", "Performance Issues", "Lessons Learned", "Reference Quality"]
            }
        };

        const QUESTION_BANK = {
            technical: [
                { id: "T1", text: "Walk us through your proposed system architecture and how it addresses the VA's interoperability requirements.", difficulty: "hard", section: "Technical Approach" },
                { id: "T2", text: "How will your solution handle the migration of legacy data while maintaining system availability?", difficulty: "hard", section: "Transition Plan" },
                { id: "T3", text: "Describe your approach to implementing FedRAMP High security controls within the proposed timeline.", difficulty: "medium", section: "Security" },
                { id: "T4", text: "What is your contingency plan if the primary cloud provider experiences an outage?", difficulty: "medium", section: "Risk Mitigation" },
                { id: "T5", text: "How does your team's experience with similar VA systems give you confidence in your technical approach?", difficulty: "easy", section: "Technical Capability" },
                { id: "T6", text: "Explain how your API integration strategy will ensure seamless data exchange with existing VistA systems.", difficulty: "hard", section: "Integration" }
            ],
            contracts: [
                { id: "C1", text: "Your proposal indicates a 30% small business subcontracting goal. How will you track and ensure compliance?", difficulty: "medium", section: "Subcontracting" },
                { id: "C2", text: "Walk us through your understanding of the IDIQ ordering procedures and how you'll manage task order execution.", difficulty: "medium", section: "Contract Administration" },
                { id: "C3", text: "How do you plan to handle potential organizational conflicts of interest given your other VA contracts?", difficulty: "hard", section: "OCI" },
                { id: "C4", text: "Describe your approach to invoicing and the documentation you'll provide to support cost reimbursement.", difficulty: "easy", section: "Invoicing" },
                { id: "C5", text: "What is your plan for key personnel substitution if your proposed PM becomes unavailable?", difficulty: "medium", section: "Key Personnel" }
            ],
            cost: [
                { id: "P1", text: "Your senior developer rate is 15% higher than GSA schedule. Justify this variance.", difficulty: "hard", section: "Labor Rates" },
                { id: "P2", text: "Walk us through the basis of estimate for the 2,400 hours allocated to Phase 2 development.", difficulty: "hard", section: "BOE" },
                { id: "P3", text: "How did you account for inflation in your out-year pricing given the 5-year period of performance?", difficulty: "medium", section: "Escalation" },
                { id: "P4", text: "Your ODC estimate seems low compared to industry standards. What assumptions drove this figure?", difficulty: "medium", section: "ODCs" },
                { id: "P5", text: "Explain the cost savings your proposed approach offers compared to the government estimate.", difficulty: "easy", section: "Cost Realism" }
            ],
            past_performance: [
                { id: "PP1", text: "Your CPARS rating on the DHA contract shows a 'Satisfactory' for schedule. What happened and what did you learn?", difficulty: "hard", section: "Performance Issues" },
                { id: "PP2", text: "How is the scope of your CDC modernization project relevant to this VA effort?", difficulty: "medium", section: "Relevance" },
                { id: "PP3", text: "One of your references mentioned staff turnover issues. How have you addressed retention since then?", difficulty: "hard", section: "Lessons Learned" },
                { id: "PP4", text: "Describe a challenging situation from a past contract and how your team resolved it.", difficulty: "medium", section: "Problem Solving" },
                { id: "PP5", text: "Your largest past performance is only $12M. How does this prepare you for a $47M contract?", difficulty: "hard", section: "Scale" }
            ]
        };

        const SCORING_RUBRIC = {
            excellent: { label: "Excellent", color: "score-excellent", points: 4, description: "Exceeds requirements, demonstrates exceptional understanding" },
            acceptable: { label: "Acceptable", color: "score-acceptable", points: 3, description: "Meets requirements, shows solid understanding" },
            marginal: { label: "Marginal", color: "score-marginal", points: 2, description: "Partially meets requirements, some gaps in understanding" },
            unacceptable: { label: "Unacceptable", color: "score-unacceptable", points: 1, description: "Does not meet requirements, significant deficiencies" }
        };

        const RBAC_ROLES = [
            { id: "ceo", label: "CEO", canViewTeamScores: true, canManageSessions: true, canExport: true },
            { id: "coo", label: "COO", canViewTeamScores: true, canManageSessions: true, canExport: true },
            { id: "cap", label: "CAP Manager", canViewTeamScores: true, canManageSessions: true, canExport: false },
            { id: "pm", label: "Proposal Manager", canViewTeamScores: true, canManageSessions: true, canExport: false },
            { id: "sa", label: "Solution Architect", canViewTeamScores: false, canManageSessions: false, canExport: false },
            { id: "fin", label: "Pricing Lead", canViewTeamScores: false, canManageSessions: false, canExport: false },
            { id: "con", label: "Contracts Lead", canViewTeamScores: false, canManageSessions: false, canExport: false },
            { id: "del", label: "Delivery Lead", canViewTeamScores: false, canManageSessions: false, canExport: false },
            { id: "writer", label: "Proposal Writer", canViewTeamScores: false, canManageSessions: false, canExport: false },
            { id: "reviewer", label: "Reviewer", canViewTeamScores: false, canManageSessions: false, canExport: false },
            { id: "admin", label: "Admin", canViewTeamScores: true, canManageSessions: true, canExport: true }
        ];

        const DEMO_TEAM_SCORES = [
            { name: "John Smith", role: "Technical Lead", sessions: 5, avgScore: 3.4, lastSession: "2025-01-24", trend: "up" },
            { name: "Sarah Johnson", role: "PM", sessions: 3, avgScore: 3.1, lastSession: "2025-01-23", trend: "up" },
            { name: "Mike Chen", role: "Pricing Lead", sessions: 4, avgScore: 2.8, lastSession: "2025-01-22", trend: "down" },
            { name: "Emily Davis", role: "Contracts", sessions: 2, avgScore: 3.6, lastSession: "2025-01-21", trend: "stable" }
        ];

        // ============== COMPONENTS ==============

        // Shield Logo Component
        const ShieldLogo = () => (
            <svg width="32" height="32" viewBox="0 0 100 100" className="text-mmt-cyan">
                <path d="M50 5 L90 20 L90 50 C90 75 70 95 50 95 C30 95 10 75 10 50 L10 20 Z" 
                      fill="none" stroke="currentColor" strokeWidth="4"/>
                <path d="M50 25 L50 75 M30 50 L70 50" stroke="currentColor" strokeWidth="4" strokeLinecap="round"/>
                <circle cx="50" cy="50" r="8" fill="currentColor"/>
            </svg>
        );

        // Timer Component
        const Timer = ({ duration, isRunning, onTimeUp, isPaused }) => {
            const [timeLeft, setTimeLeft] = useState(duration * 60);
            const [isVisible, setIsVisible] = useState(true);

            useEffect(() => {
                setTimeLeft(duration * 60);
            }, [duration]);

            useEffect(() => {
                if (!isRunning || isPaused) return;
                
                const interval = setInterval(() => {
                    setTimeLeft(prev => {
                        if (prev <= 1) {
                            clearInterval(interval);
                            onTimeUp();
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);

                return () => clearInterval(interval);
            }, [isRunning, isPaused, onTimeUp]);

            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            const isCritical = timeLeft < 60;
            const progress = ((duration * 60 - timeLeft) / (duration * 60)) * 100;

            return (
                <div className="bg-mmt-slate rounded-xl p-4 border border-mmt-gray">
                    <div className="flex items-center justify-between mb-2">
                        <span className="text-gray-400 text-sm font-medium">Session Timer</span>
                        {isPaused && <span className="text-yellow-400 text-xs">PAUSED</span>}
                    </div>
                    <div className={`text-4xl font-bold text-center ${isCritical ? 'timer-critical' : 'text-mmt-cyan'}`}>
                        {String(minutes).padStart(2, '0')}:{String(seconds).padStart(2, '0')}
                    </div>
                    <div className="mt-3 h-2 bg-mmt-gray rounded-full overflow-hidden">
                        <div 
                            className={`h-full transition-all duration-1000 ${isCritical ? 'bg-red-500' : 'bg-mmt-cyan'}`}
                            style={{ width: `${progress}%` }}
                        />
                    </div>
                </div>
            );
        };

        // Evaluator Card Component
        const EvaluatorCard = ({ evaluator, isSelected, onClick, disabled }) => (
            <button
                onClick={onClick}
                disabled={disabled}
                className={`evaluator-card p-4 rounded-xl border-2 transition-all w-full text-left
                    ${isSelected 
                        ? 'border-mmt-cyan bg-mmt-cyan/10 glow-cyan' 
                        : 'border-mmt-gray bg-mmt-slate hover:border-mmt-cyan/50'}
                    ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}`}
            >
                <div className="flex items-center gap-3 mb-2">
                    <div className={`w-12 h-12 rounded-full bg-gradient-to-br ${evaluator.color} flex items-center justify-center text-2xl`}>
                        {evaluator.avatar}
                    </div>
                    <div>
                        <div className="font-semibold text-white">{evaluator.name}</div>
                        <div className="text-xs text-gray-400">{evaluator.title}</div>
                    </div>
                </div>
                <p className="text-xs text-gray-500 mb-2">{evaluator.style}</p>
                <div className="flex flex-wrap gap-1">
                    {evaluator.focusAreas.slice(0, 2).map((area, i) => (
                        <span key={i} className="text-xs bg-mmt-gray px-2 py-0.5 rounded text-gray-400">
                            {area}
                        </span>
                    ))}
                </div>
            </button>
        );

        // Question Display Component
        const QuestionDisplay = ({ question, evaluator, onAnswer }) => {
            const [response, setResponse] = useState("");
            const [isRecording, setIsRecording] = useState(false);

            const handleSubmit = () => {
                if (response.trim()) {
                    onAnswer(response);
                    setResponse("");
                }
            };

            return (
                <div className="bg-mmt-slate rounded-xl p-6 border border-mmt-gray">
                    <div className="flex items-start gap-4 mb-6">
                        <div className={`w-14 h-14 rounded-full bg-gradient-to-br ${EVALUATOR_PERSONAS[evaluator].color} flex items-center justify-center text-3xl flex-shrink-0`}>
                            {EVALUATOR_PERSONAS[evaluator].avatar}
                        </div>
                        <div className="flex-1">
                            <div className="flex items-center gap-2 mb-1">
                                <span className="font-semibold text-white">{EVALUATOR_PERSONAS[evaluator].name}</span>
                                <span className={`text-xs px-2 py-0.5 rounded ${
                                    question.difficulty === 'hard' ? 'bg-red-500/20 text-red-400' :
                                    question.difficulty === 'medium' ? 'bg-yellow-500/20 text-yellow-400' :
                                    'bg-green-500/20 text-green-400'
                                }`}>
                                    {question.difficulty.toUpperCase()}
                                </span>
                            </div>
                            <p className="text-lg text-white leading-relaxed">{question.text}</p>
                            <span className="text-xs text-gray-500 mt-2 block">Section: {question.section}</span>
                        </div>
                    </div>

                    <div className="space-y-4">
                        <div className="flex items-center gap-2 mb-2">
                            <span className="text-gray-400 text-sm">Your Response:</span>
                            <button
                                onClick={() => setIsRecording(!isRecording)}
                                className={`flex items-center gap-1 text-xs px-2 py-1 rounded ${
                                    isRecording ? 'bg-red-500 text-white recording-pulse' : 'bg-mmt-gray text-gray-400 hover:bg-mmt-gray/80'
                                }`}
                            >
                                {isRecording ? '‚èπ Stop' : 'üé§ Record'}
                            </button>
                        </div>
                        <textarea
                            value={response}
                            onChange={(e) => setResponse(e.target.value)}
                            placeholder="Type your response here or use voice recording..."
                            className="w-full h-40 bg-mmt-navy border border-mmt-gray rounded-lg p-4 text-white placeholder-gray-500 focus:border-mmt-cyan focus:outline-none resize-none"
                        />
                        <div className="flex justify-between items-center">
                            <span className="text-xs text-gray-500">{response.length} characters</span>
                            <button
                                onClick={handleSubmit}
                                disabled={!response.trim()}
                                className="px-6 py-2 bg-mmt-cyan text-mmt-navy font-semibold rounded-lg hover:bg-mmt-cyan-dark disabled:opacity-50 disabled:cursor-not-allowed transition-all"
                            >
                                Submit Answer ‚Üí
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // Score Card Component
        const ScoreCard = ({ answer, index }) => (
            <div className="bg-mmt-slate rounded-xl p-4 border border-mmt-gray">
                <div className="flex items-start justify-between mb-3">
                    <div className="flex items-center gap-2">
                        <span className="text-gray-400 text-sm">Q{index + 1}</span>
                        <span className={`text-xs px-2 py-0.5 rounded ${
                            answer.difficulty === 'hard' ? 'bg-red-500/20 text-red-400' :
                            answer.difficulty === 'medium' ? 'bg-yellow-500/20 text-yellow-400' :
                            'bg-green-500/20 text-green-400'
                        }`}>
                            {answer.difficulty}
                        </span>
                    </div>
                    <div className={`px-3 py-1 rounded-full text-white text-sm font-medium ${SCORING_RUBRIC[answer.score].color}`}>
                        {SCORING_RUBRIC[answer.score].label}
                    </div>
                </div>
                <p className="text-sm text-gray-300 mb-2 line-clamp-2">{answer.question}</p>
                <p className="text-xs text-gray-500">{answer.feedback}</p>
            </div>
        );

        // Team Scores Table Component
        const TeamScoresTable = ({ scores }) => (
            <div className="bg-mmt-slate rounded-xl border border-mmt-gray overflow-hidden">
                <div className="p-4 border-b border-mmt-gray">
                    <h3 className="text-lg font-semibold text-white">Team Practice Scores</h3>
                    <p className="text-sm text-gray-400">Performance tracking for orals preparation</p>
                </div>
                <div className="overflow-x-auto">
                    <table className="w-full">
                        <thead className="bg-mmt-gray/50">
                            <tr>
                                <th className="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Team Member</th>
                                <th className="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Role</th>
                                <th className="px-4 py-3 text-center text-xs font-medium text-gray-400 uppercase">Sessions</th>
                                <th className="px-4 py-3 text-center text-xs font-medium text-gray-400 uppercase">Avg Score</th>
                                <th className="px-4 py-3 text-center text-xs font-medium text-gray-400 uppercase">Trend</th>
                                <th className="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Last Session</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-mmt-gray">
                            {scores.map((member, i) => (
                                <tr key={i} className="hover:bg-mmt-gray/30 transition-colors">
                                    <td className="px-4 py-3 text-white font-medium">{member.name}</td>
                                    <td className="px-4 py-3 text-gray-400">{member.role}</td>
                                    <td className="px-4 py-3 text-center text-gray-300">{member.sessions}</td>
                                    <td className="px-4 py-3 text-center">
                                        <span className={`px-2 py-1 rounded text-sm font-medium ${
                                            member.avgScore >= 3.5 ? 'bg-green-500/20 text-green-400' :
                                            member.avgScore >= 2.5 ? 'bg-yellow-500/20 text-yellow-400' :
                                            'bg-red-500/20 text-red-400'
                                        }`}>
                                            {member.avgScore.toFixed(1)}
                                        </span>
                                    </td>
                                    <td className="px-4 py-3 text-center text-xl">
                                        {member.trend === 'up' ? 'üìà' : member.trend === 'down' ? 'üìâ' : '‚û°Ô∏è'}
                                    </td>
                                    <td className="px-4 py-3 text-gray-400">{member.lastSession}</td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            </div>
        );

        // Session Summary Component
        const SessionSummary = ({ answers, duration, onClose, onNewSession }) => {
            const totalPoints = answers.reduce((sum, a) => sum + SCORING_RUBRIC[a.score].points, 0);
            const maxPoints = answers.length * 4;
            const percentage = Math.round((totalPoints / maxPoints) * 100);
            
            const getOverallRating = () => {
                if (percentage >= 85) return { label: "Excellent", color: "text-green-400" };
                if (percentage >= 70) return { label: "Acceptable", color: "text-blue-400" };
                if (percentage >= 50) return { label: "Marginal", color: "text-yellow-400" };
                return { label: "Needs Improvement", color: "text-red-400" };
            };

            const rating = getOverallRating();

            return (
                <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4">
                    <div className="bg-mmt-slate rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-mmt-gray">
                        <div className="p-6 border-b border-mmt-gray">
                            <h2 className="text-2xl font-bold text-white mb-1">Session Complete! üéØ</h2>
                            <p className="text-gray-400">Review your performance and identify areas for improvement</p>
                        </div>
                        
                        <div className="p-6 space-y-6">
                            {/* Overall Score */}
                            <div className="text-center py-6 bg-mmt-navy rounded-xl">
                                <div className="text-5xl font-bold text-mmt-cyan mb-2">{percentage}%</div>
                                <div className={`text-xl font-semibold ${rating.color}`}>{rating.label}</div>
                                <div className="text-sm text-gray-400 mt-1">
                                    {totalPoints} / {maxPoints} points ‚Ä¢ {answers.length} questions ‚Ä¢ {duration} min session
                                </div>
                            </div>

                            {/* Score Breakdown */}
                            <div>
                                <h3 className="text-lg font-semibold text-white mb-3">Score Breakdown</h3>
                                <div className="grid grid-cols-4 gap-2">
                                    {Object.entries(SCORING_RUBRIC).map(([key, rubric]) => {
                                        const count = answers.filter(a => a.score === key).length;
                                        return (
                                            <div key={key} className={`p-3 rounded-lg ${rubric.color} text-center`}>
                                                <div className="text-2xl font-bold text-white">{count}</div>
                                                <div className="text-xs text-white/80">{rubric.label}</div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>

                            {/* Question Review */}
                            <div>
                                <h3 className="text-lg font-semibold text-white mb-3">Question Review</h3>
                                <div className="space-y-3">
                                    {answers.map((answer, i) => (
                                        <ScoreCard key={i} answer={answer} index={i} />
                                    ))}
                                </div>
                            </div>

                            {/* Recommendations */}
                            <div className="bg-mmt-navy rounded-xl p-4">
                                <h3 className="text-lg font-semibold text-white mb-2">üí° Recommendations</h3>
                                <ul className="space-y-2 text-sm text-gray-300">
                                    {percentage < 70 && (
                                        <li>‚Ä¢ Schedule additional practice sessions focusing on weak areas</li>
                                    )}
                                    {answers.some(a => a.score === 'unacceptable') && (
                                        <li>‚Ä¢ Review proposal sections related to unacceptable answers</li>
                                    )}
                                    <li>‚Ä¢ Practice with different evaluator personas for well-rounded prep</li>
                                    <li>‚Ä¢ Time your responses to stay within evaluation windows</li>
                                </ul>
                            </div>
                        </div>

                        <div className="p-6 border-t border-mmt-gray flex gap-3">
                            <button
                                onClick={onNewSession}
                                className="flex-1 px-4 py-3 bg-mmt-cyan text-mmt-navy font-semibold rounded-lg hover:bg-mmt-cyan-dark transition-all"
                            >
                                Start New Session
                            </button>
                            <button
                                onClick={onClose}
                                className="px-4 py-3 bg-mmt-gray text-white rounded-lg hover:bg-mmt-gray/80 transition-all"
                            >
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // ============== MAIN APP ==============
        const OralsSimulatorApp = () => {
            const [currentRole, setCurrentRole] = useState(RBAC_ROLES[0]);
            const [activeView, setActiveView] = useState('setup'); // setup, practice, review, team
            const [selectedEvaluators, setSelectedEvaluators] = useState([]);
            const [sessionDuration, setSessionDuration] = useState(30);
            const [isSessionActive, setIsSessionActive] = useState(false);
            const [isPaused, setIsPaused] = useState(false);
            const [currentQuestion, setCurrentQuestion] = useState(null);
            const [currentEvaluator, setCurrentEvaluator] = useState(null);
            const [questionIndex, setQuestionIndex] = useState(0);
            const [answers, setAnswers] = useState([]);
            const [showSummary, setShowSummary] = useState(false);
            const [sessionQuestions, setSessionQuestions] = useState([]);

            const generateSessionQuestions = useCallback(() => {
                let questions = [];
                selectedEvaluators.forEach(evalId => {
                    const evalQuestions = QUESTION_BANK[evalId];
                    const shuffled = [...evalQuestions].sort(() => Math.random() - 0.5);
                    const numQuestions = Math.min(3, shuffled.length);
                    shuffled.slice(0, numQuestions).forEach(q => {
                        questions.push({ ...q, evaluator: evalId });
                    });
                });
                return questions.sort(() => Math.random() - 0.5);
            }, [selectedEvaluators]);

            const startSession = () => {
                const questions = generateSessionQuestions();
                setSessionQuestions(questions);
                setQuestionIndex(0);
                setCurrentQuestion(questions[0]);
                setCurrentEvaluator(questions[0].evaluator);
                setAnswers([]);
                setIsSessionActive(true);
                setActiveView('practice');
            };

            const handleAnswer = (response) => {
                // Simulate AI scoring (in production, this would call the API)
                const scores = ['excellent', 'acceptable', 'marginal', 'unacceptable'];
                const weights = [0.3, 0.4, 0.2, 0.1];
                let random = Math.random();
                let scoreIndex = 0;
                for (let i = 0; i < weights.length; i++) {
                    random -= weights[i];
                    if (random <= 0) {
                        scoreIndex = i;
                        break;
                    }
                }
                const score = scores[scoreIndex];

                const feedbackOptions = {
                    excellent: "Strong response with clear understanding of requirements and compelling examples.",
                    acceptable: "Adequate response covering key points. Consider adding more specifics.",
                    marginal: "Response addresses the question but lacks depth in critical areas.",
                    unacceptable: "Response does not adequately address the question. Review this section."
                };

                const newAnswer = {
                    question: currentQuestion.text,
                    response: response,
                    score: score,
                    feedback: feedbackOptions[score],
                    evaluator: currentEvaluator,
                    difficulty: currentQuestion.difficulty,
                    section: currentQuestion.section
                };

                setAnswers(prev => [...prev, newAnswer]);

                if (questionIndex < sessionQuestions.length - 1) {
                    const nextIndex = questionIndex + 1;
                    setQuestionIndex(nextIndex);
                    setCurrentQuestion(sessionQuestions[nextIndex]);
                    setCurrentEvaluator(sessionQuestions[nextIndex].evaluator);
                } else {
                    endSession();
                }
            };

            const endSession = () => {
                setIsSessionActive(false);
                setShowSummary(true);
            };

            const handleTimeUp = () => {
                endSession();
            };

            const resetSession = () => {
                setShowSummary(false);
                setActiveView('setup');
                setSelectedEvaluators([]);
                setAnswers([]);
                setQuestionIndex(0);
            };

            const toggleEvaluator = (evalId) => {
                setSelectedEvaluators(prev => 
                    prev.includes(evalId) 
                        ? prev.filter(id => id !== evalId)
                        : [...prev, evalId]
                );
            };

            return (
                <div className="min-h-screen bg-mmt-navy">
                    {/* Header */}
                    <header className="bg-mmt-slate border-b border-mmt-gray sticky top-0 z-40">
                        <div className="max-w-7xl mx-auto px-4 py-3">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center gap-4">
                                    <div className="flex items-center gap-2">
                                        <ShieldLogo />
                                        <div>
                                            <span className="text-mmt-cyan font-bold text-lg">MissionPulse</span>
                                            <span className="text-gray-400 text-sm ml-2">M10 Orals Simulator</span>
                                        </div>
                                    </div>
                                </div>
                                <div className="flex items-center gap-4">
                                    <select
                                        value={currentRole.id}
                                        onChange={(e) => setCurrentRole(RBAC_ROLES.find(r => r.id === e.target.value))}
                                        className="bg-mmt-gray border border-mmt-gray rounded-lg px-3 py-2 text-sm text-white focus:border-mmt-cyan focus:outline-none"
                                    >
                                        {RBAC_ROLES.map(role => (
                                            <option key={role.id} value={role.id}>{role.label}</option>
                                        ))}
                                    </select>
                                    <div className="w-8 h-8 rounded-full bg-gradient-to-br from-mmt-cyan to-blue-500 flex items-center justify-center text-mmt-navy font-bold text-sm">
                                        {currentRole.label.charAt(0)}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Opportunity Banner */}
                    <div className="bg-mmt-slate/50 border-b border-mmt-gray">
                        <div className="max-w-7xl mx-auto px-4 py-3">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center gap-4">
                                    <span className="text-mmt-cyan">üéØ</span>
                                    <div>
                                        <span className="text-white font-medium">{DEMO_OPPORTUNITY.title}</span>
                                        <span className="text-gray-400 mx-2">‚Ä¢</span>
                                        <span className="text-gray-400">{DEMO_OPPORTUNITY.agency}</span>
                                    </div>
                                </div>
                                <div className="flex items-center gap-4 text-sm">
                                    <span className="text-gray-400">Orals: <span className="text-mmt-cyan">{DEMO_OPPORTUNITY.oralsDate}</span></span>
                                    <span className="px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs">{DEMO_OPPORTUNITY.stage}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Navigation Tabs */}
                    <div className="bg-mmt-slate border-b border-mmt-gray">
                        <div className="max-w-7xl mx-auto px-4">
                            <div className="flex gap-1">
                                {[
                                    { id: 'setup', label: 'üéØ Session Setup', show: true },
                                    { id: 'practice', label: 'üé§ Practice', show: isSessionActive },
                                    { id: 'team', label: 'üë• Team Scores', show: currentRole.canViewTeamScores }
                                ].filter(t => t.show).map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveView(tab.id)}
                                        className={`px-4 py-3 text-sm font-medium transition-all border-b-2 ${
                                            activeView === tab.id
                                                ? 'text-mmt-cyan border-mmt-cyan'
                                                : 'text-gray-400 border-transparent hover:text-white'
                                        }`}
                                    >
                                        {tab.label}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto px-4 py-6">
                        {/* Setup View */}
                        {activeView === 'setup' && !isSessionActive && (
                            <div className="space-y-6">
                                <div className="text-center mb-8">
                                    <h1 className="text-3xl font-bold text-white mb-2">Orals Presentation Simulator</h1>
                                    <p className="text-gray-400">Practice with AI evaluators before your real oral presentation</p>
                                </div>

                                {/* Session Configuration */}
                                <div className="grid lg:grid-cols-3 gap-6">
                                    {/* Duration Selection */}
                                    <div className="bg-mmt-slate rounded-xl p-6 border border-mmt-gray">
                                        <h3 className="text-lg font-semibold text-white mb-4">‚è±Ô∏è Session Duration</h3>
                                        <div className="grid grid-cols-3 gap-2">
                                            {[15, 30, 60].map(duration => (
                                                <button
                                                    key={duration}
                                                    onClick={() => setSessionDuration(duration)}
                                                    className={`py-3 rounded-lg font-medium transition-all ${
                                                        sessionDuration === duration
                                                            ? 'bg-mmt-cyan text-mmt-navy'
                                                            : 'bg-mmt-gray text-white hover:bg-mmt-gray/80'
                                                    }`}
                                                >
                                                    {duration} min
                                                </button>
                                            ))}
                                        </div>
                                        <p className="text-xs text-gray-500 mt-3">
                                            Recommended: 30 min for comprehensive practice
                                        </p>
                                    </div>

                                    {/* Quick Stats */}
                                    <div className="bg-mmt-slate rounded-xl p-6 border border-mmt-gray lg:col-span-2">
                                        <h3 className="text-lg font-semibold text-white mb-4">üìä Your Practice Stats</h3>
                                        <div className="grid grid-cols-4 gap-4">
                                            <div className="text-center">
                                                <div className="text-2xl font-bold text-mmt-cyan">7</div>
                                                <div className="text-xs text-gray-400">Sessions</div>
                                            </div>
                                            <div className="text-center">
                                                <div className="text-2xl font-bold text-green-400">3.2</div>
                                                <div className="text-xs text-gray-400">Avg Score</div>
                                            </div>
                                            <div className="text-center">
                                                <div className="text-2xl font-bold text-yellow-400">42</div>
                                                <div className="text-xs text-gray-400">Questions</div>
                                            </div>
                                            <div className="text-center">
                                                <div className="text-2xl font-bold text-purple-400">üìà</div>
                                                <div className="text-xs text-gray-400">Trending Up</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Evaluator Selection */}
                                <div className="bg-mmt-slate rounded-xl p-6 border border-mmt-gray">
                                    <div className="flex items-center justify-between mb-4">
                                        <div>
                                            <h3 className="text-lg font-semibold text-white">üë• Select Evaluators</h3>
                                            <p className="text-sm text-gray-400">Choose which evaluation panels to practice with</p>
                                        </div>
                                        <span className="text-mmt-cyan text-sm">{selectedEvaluators.length} selected</span>
                                    </div>
                                    <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                                        {Object.values(EVALUATOR_PERSONAS).map(evaluator => (
                                            <EvaluatorCard
                                                key={evaluator.id}
                                                evaluator={evaluator}
                                                isSelected={selectedEvaluators.includes(evaluator.id)}
                                                onClick={() => toggleEvaluator(evaluator.id)}
                                            />
                                        ))}
                                    </div>
                                </div>

                                {/* Start Button */}
                                <div className="flex justify-center">
                                    <button
                                        onClick={startSession}
                                        disabled={selectedEvaluators.length === 0}
                                        className="px-8 py-4 bg-mmt-cyan text-mmt-navy font-bold text-lg rounded-xl hover:bg-mmt-cyan-dark disabled:opacity-50 disabled:cursor-not-allowed transition-all glow-cyan pulse-ring"
                                    >
                                        üé§ Start Practice Session
                                    </button>
                                </div>
                            </div>
                        )}

                        {/* Practice View */}
                        {activeView === 'practice' && isSessionActive && (
                            <div className="grid lg:grid-cols-4 gap-6">
                                {/* Main Question Area */}
                                <div className="lg:col-span-3 space-y-6">
                                    {/* Progress Bar */}
                                    <div className="bg-mmt-slate rounded-xl p-4 border border-mmt-gray">
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="text-gray-400 text-sm">Question {questionIndex + 1} of {sessionQuestions.length}</span>
                                            <div className="flex gap-2">
                                                <button
                                                    onClick={() => setIsPaused(!isPaused)}
                                                    className="px-3 py-1 bg-mmt-gray text-white text-sm rounded hover:bg-mmt-gray/80"
                                                >
                                                    {isPaused ? '‚ñ∂Ô∏è Resume' : '‚è∏Ô∏è Pause'}
                                                </button>
                                                <button
                                                    onClick={endSession}
                                                    className="px-3 py-1 bg-red-500/20 text-red-400 text-sm rounded hover:bg-red-500/30"
                                                >
                                                    End Session
                                                </button>
                                            </div>
                                        </div>
                                        <div className="h-2 bg-mmt-gray rounded-full overflow-hidden">
                                            <div 
                                                className="h-full bg-mmt-cyan transition-all duration-300"
                                                style={{ width: `${((questionIndex) / sessionQuestions.length) * 100}%` }}
                                            />
                                        </div>
                                    </div>

                                    {/* Current Question */}
                                    {currentQuestion && (
                                        <QuestionDisplay
                                            question={currentQuestion}
                                            evaluator={currentEvaluator}
                                            onAnswer={handleAnswer}
                                        />
                                    )}
                                </div>

                                {/* Sidebar */}
                                <div className="space-y-4">
                                    <Timer
                                        duration={sessionDuration}
                                        isRunning={isSessionActive}
                                        isPaused={isPaused}
                                        onTimeUp={handleTimeUp}
                                    />

                                    {/* Answers So Far */}
                                    <div className="bg-mmt-slate rounded-xl p-4 border border-mmt-gray">
                                        <h4 className="text-white font-medium mb-3">Completed</h4>
                                        <div className="space-y-2">
                                            {answers.length === 0 ? (
                                                <p className="text-sm text-gray-500">No answers yet</p>
                                            ) : (
                                                answers.map((answer, i) => (
                                                    <div key={i} className="flex items-center justify-between text-sm">
                                                        <span className="text-gray-400">Q{i + 1}</span>
                                                        <span className={`px-2 py-0.5 rounded text-xs ${SCORING_RUBRIC[answer.score].color}`}>
                                                            {SCORING_RUBRIC[answer.score].label}
                                                        </span>
                                                    </div>
                                                ))
                                            )}
                                        </div>
                                    </div>

                                    {/* Tips */}
                                    <div className="bg-mmt-navy rounded-xl p-4 border border-mmt-cyan/20">
                                        <h4 className="text-mmt-cyan font-medium mb-2">üí° Tips</h4>
                                        <ul className="text-xs text-gray-400 space-y-1">
                                            <li>‚Ä¢ Be specific with examples</li>
                                            <li>‚Ä¢ Reference proposal sections</li>
                                            <li>‚Ä¢ Stay within time limits</li>
                                            <li>‚Ä¢ Address all parts of questions</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Team Scores View */}
                        {activeView === 'team' && currentRole.canViewTeamScores && (
                            <div className="space-y-6">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <h2 className="text-2xl font-bold text-white">Team Practice Scores</h2>
                                        <p className="text-gray-400">Monitor team readiness for orals presentation</p>
                                    </div>
                                    {currentRole.canExport && (
                                        <button className="px-4 py-2 bg-mmt-gray text-white rounded-lg hover:bg-mmt-gray/80">
                                            üìä Export Report
                                        </button>
                                    )}
                                </div>

                                <TeamScoresTable scores={DEMO_TEAM_SCORES} />

                                {/* Readiness Assessment */}
                                <div className="grid md:grid-cols-3 gap-4">
                                    <div className="bg-mmt-slate rounded-xl p-6 border border-mmt-gray">
                                        <div className="text-3xl font-bold text-green-400 mb-1">78%</div>
                                        <div className="text-gray-400 text-sm">Team Readiness Score</div>
                                        <div className="mt-3 h-2 bg-mmt-gray rounded-full overflow-hidden">
                                            <div className="h-full bg-green-400" style={{ width: '78%' }} />
                                        </div>
                                    </div>
                                    <div className="bg-mmt-slate rounded-xl p-6 border border-mmt-gray">
                                        <div className="text-3xl font-bold text-yellow-400 mb-1">14</div>
                                        <div className="text-gray-400 text-sm">Total Team Sessions</div>
                                        <div className="text-xs text-gray-500 mt-2">Target: 20 sessions before orals</div>
                                    </div>
                                    <div className="bg-mmt-slate rounded-xl p-6 border border-mmt-gray">
                                        <div className="text-3xl font-bold text-purple-400 mb-1">Cost</div>
                                        <div className="text-gray-400 text-sm">Weakest Area</div>
                                        <div className="text-xs text-gray-500 mt-2">Schedule focused practice</div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>

                    {/* Session Summary Modal */}
                    {showSummary && (
                        <SessionSummary
                            answers={answers}
                            duration={sessionDuration}
                            onClose={() => setShowSummary(false)}
                            onNewSession={resetSession}
                        />
                    )}

                    {/* Footer */}
                    <footer className="bg-mmt-slate border-t border-mmt-gray mt-8">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <div className="flex items-center justify-between text-sm">
                                <div className="flex items-center gap-2 text-gray-400">
                                    <span>‚ö†Ô∏è AI GENERATED - REQUIRES HUMAN REVIEW</span>
                                </div>
                                <div className="text-gray-500">
                                    MissionPulse v12.0 ‚Ä¢ Shield & Pulse UX v8.0 ‚Ä¢ ¬© 2025 Mission Meets Tech
                                </div>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        ReactDOM.render(<OralsSimulatorApp />, document.getElementById('root'));
    </script>
</body>
</html>
