<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposal Outline Builder - MissionPulse</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'mp-navy': '#00050F',
                        'mp-cyan': '#00E5FA',
                        'mp-slate': '#0A1628',
                        'mp-dark': '#020817'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        * { font-family: 'Inter', sans-serif; }
        .glow-cyan { box-shadow: 0 0 20px rgba(0, 229, 250, 0.3); }
        .section-item { transition: all 0.2s ease; }
        .section-item:hover { background: rgba(0, 229, 250, 0.05); }
        .drag-handle { cursor: grab; }
        .drag-handle:active { cursor: grabbing; }
    </style>
</head>
<body class="bg-mp-navy text-white min-h-screen">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useMemo } = React;

        // Demo Proposal Outline
        const initialOutline = {
            opportunity: 'DHA EHR Modernization',
            opportunityId: 'opp-001',
            volumeType: 'Technical',
            pageLimit: 100,
            currentPages: 0,
            lastUpdated: '2025-01-28',
            sections: [
                {
                    id: 1,
                    number: '1.0',
                    title: 'Executive Summary',
                    pageLimit: 5,
                    estimatedPages: 4,
                    sectionLRef: 'L.5.1',
                    sectionMRef: 'M.3.1',
                    status: 'in_progress',
                    owner: 'Sarah Chen',
                    dueDate: '2025-02-05',
                    children: []
                },
                {
                    id: 2,
                    number: '2.0',
                    title: 'Technical Approach',
                    pageLimit: 40,
                    estimatedPages: 38,
                    sectionLRef: 'L.5.2',
                    sectionMRef: 'M.3.2',
                    status: 'in_progress',
                    owner: 'Michael Brown',
                    dueDate: '2025-02-08',
                    children: [
                        {
                            id: 21,
                            number: '2.1',
                            title: 'Understanding of Requirements',
                            pageLimit: 8,
                            estimatedPages: 7,
                            sectionLRef: 'L.5.2.1',
                            sectionMRef: 'M.3.2.a',
                            status: 'complete',
                            owner: 'Michael Brown',
                            dueDate: '2025-02-03',
                            children: []
                        },
                        {
                            id: 22,
                            number: '2.2',
                            title: 'Technical Solution',
                            pageLimit: 15,
                            estimatedPages: 15,
                            sectionLRef: 'L.5.2.2',
                            sectionMRef: 'M.3.2.b',
                            status: 'in_progress',
                            owner: 'Jennifer Taylor',
                            dueDate: '2025-02-06',
                            children: [
                                {
                                    id: 221,
                                    number: '2.2.1',
                                    title: 'System Architecture',
                                    pageLimit: 5,
                                    estimatedPages: 5,
                                    sectionLRef: 'L.5.2.2.a',
                                    sectionMRef: 'M.3.2.b.i',
                                    status: 'in_progress',
                                    owner: 'Jennifer Taylor',
                                    dueDate: '2025-02-04',
                                    children: []
                                },
                                {
                                    id: 222,
                                    number: '2.2.2',
                                    title: 'Integration Approach',
                                    pageLimit: 5,
                                    estimatedPages: 5,
                                    sectionLRef: 'L.5.2.2.b',
                                    sectionMRef: 'M.3.2.b.ii',
                                    status: 'not_started',
                                    owner: 'Jennifer Taylor',
                                    dueDate: '2025-02-05',
                                    children: []
                                },
                                {
                                    id: 223,
                                    number: '2.2.3',
                                    title: 'Security Implementation',
                                    pageLimit: 5,
                                    estimatedPages: 5,
                                    sectionLRef: 'L.5.2.2.c',
                                    sectionMRef: 'M.3.2.b.iii',
                                    status: 'not_started',
                                    owner: 'Robert Kim',
                                    dueDate: '2025-02-06',
                                    children: []
                                }
                            ]
                        },
                        {
                            id: 23,
                            number: '2.3',
                            title: 'Transition Plan',
                            pageLimit: 8,
                            estimatedPages: 8,
                            sectionLRef: 'L.5.2.3',
                            sectionMRef: 'M.3.2.c',
                            status: 'not_started',
                            owner: 'David Wilson',
                            dueDate: '2025-02-07',
                            children: []
                        },
                        {
                            id: 24,
                            number: '2.4',
                            title: 'Quality Assurance',
                            pageLimit: 9,
                            estimatedPages: 8,
                            sectionLRef: 'L.5.2.4',
                            sectionMRef: 'M.3.2.d',
                            status: 'not_started',
                            owner: 'Lisa Anderson',
                            dueDate: '2025-02-08',
                            children: []
                        }
                    ]
                },
                {
                    id: 3,
                    number: '3.0',
                    title: 'Management Approach',
                    pageLimit: 30,
                    estimatedPages: 28,
                    sectionLRef: 'L.5.3',
                    sectionMRef: 'M.3.3',
                    status: 'not_started',
                    owner: 'Sarah Chen',
                    dueDate: '2025-02-10',
                    children: [
                        {
                            id: 31,
                            number: '3.1',
                            title: 'Program Management',
                            pageLimit: 10,
                            estimatedPages: 10,
                            sectionLRef: 'L.5.3.1',
                            sectionMRef: 'M.3.3.a',
                            status: 'not_started',
                            owner: 'Sarah Chen',
                            dueDate: '2025-02-09',
                            children: []
                        },
                        {
                            id: 32,
                            number: '3.2',
                            title: 'Staffing Plan',
                            pageLimit: 12,
                            estimatedPages: 10,
                            sectionLRef: 'L.5.3.2',
                            sectionMRef: 'M.3.3.b',
                            status: 'not_started',
                            owner: 'Emily Davis',
                            dueDate: '2025-02-09',
                            children: []
                        },
                        {
                            id: 33,
                            number: '3.3',
                            title: 'Risk Management',
                            pageLimit: 8,
                            estimatedPages: 8,
                            sectionLRef: 'L.5.3.3',
                            sectionMRef: 'M.3.3.c',
                            status: 'not_started',
                            owner: 'James Miller',
                            dueDate: '2025-02-10',
                            children: []
                        }
                    ]
                },
                {
                    id: 4,
                    number: '4.0',
                    title: 'Past Performance',
                    pageLimit: 20,
                    estimatedPages: 18,
                    sectionLRef: 'L.5.4',
                    sectionMRef: 'M.3.4',
                    status: 'complete',
                    owner: 'Robert Kim',
                    dueDate: '2025-02-01',
                    children: [
                        {
                            id: 41,
                            number: '4.1',
                            title: 'Reference 1: DHA T2 Contract',
                            pageLimit: 5,
                            estimatedPages: 5,
                            sectionLRef: 'L.5.4.1',
                            sectionMRef: 'M.3.4.a',
                            status: 'complete',
                            owner: 'Robert Kim',
                            dueDate: '2025-01-30',
                            children: []
                        },
                        {
                            id: 42,
                            number: '4.2',
                            title: 'Reference 2: VA Claims System',
                            pageLimit: 5,
                            estimatedPages: 5,
                            sectionLRef: 'L.5.4.2',
                            sectionMRef: 'M.3.4.b',
                            status: 'complete',
                            owner: 'Robert Kim',
                            dueDate: '2025-01-30',
                            children: []
                        },
                        {
                            id: 43,
                            number: '4.3',
                            title: 'Reference 3: CMS Analytics',
                            pageLimit: 5,
                            estimatedPages: 5,
                            sectionLRef: 'L.5.4.3',
                            sectionMRef: 'M.3.4.c',
                            status: 'complete',
                            owner: 'Robert Kim',
                            dueDate: '2025-01-31',
                            children: []
                        }
                    ]
                },
                {
                    id: 5,
                    number: '5.0',
                    title: 'Appendices',
                    pageLimit: 5,
                    estimatedPages: 3,
                    sectionLRef: 'L.5.5',
                    sectionMRef: '-',
                    status: 'not_started',
                    owner: 'Lisa Anderson',
                    dueDate: '2025-02-12',
                    children: []
                }
            ]
        };

        const statusOptions = ['not_started', 'in_progress', 'review', 'complete'];

        function ProposalOutlineBuilder() {
            const [outline, setOutline] = useState(initialOutline);
            const [expandedSections, setExpandedSections] = useState(new Set([2, 22, 3, 4]));
            const [selectedSection, setSelectedSection] = useState(null);
            const [showEditor, setShowEditor] = useState(false);

            const toggleExpand = (id) => {
                const newExpanded = new Set(expandedSections);
                if (newExpanded.has(id)) {
                    newExpanded.delete(id);
                } else {
                    newExpanded.add(id);
                }
                setExpandedSections(newExpanded);
            };

            const getStatusColor = (status) => {
                const colors = {
                    not_started: 'bg-slate-500/20 text-slate-400',
                    in_progress: 'bg-yellow-500/20 text-yellow-400',
                    review: 'bg-blue-500/20 text-blue-400',
                    complete: 'bg-green-500/20 text-green-400'
                };
                return colors[status] || colors.not_started;
            };

            const getStatusLabel = (status) => {
                const labels = {
                    not_started: 'Not Started',
                    in_progress: 'In Progress',
                    review: 'In Review',
                    complete: 'Complete'
                };
                return labels[status] || 'Not Started';
            };

            const calculateTotals = (sections) => {
                let totalPages = 0;
                let totalLimit = 0;
                let completeCount = 0;
                let totalCount = 0;

                const countSection = (section) => {
                    totalPages += section.estimatedPages;
                    totalLimit += section.pageLimit;
                    totalCount++;
                    if (section.status === 'complete') completeCount++;
                    section.children?.forEach(countSection);
                };

                sections.forEach(countSection);
                return { totalPages, totalLimit, completeCount, totalCount };
            };

            const stats = useMemo(() => calculateTotals(outline.sections), [outline.sections]);

            const renderSection = (section, depth = 0) => {
                const hasChildren = section.children && section.children.length > 0;
                const isExpanded = expandedSections.has(section.id);
                const pageOverage = section.estimatedPages > section.pageLimit;

                return (
                    <div key={section.id}>
                        <div 
                            className={`section-item flex items-center gap-3 px-4 py-3 border-b border-mp-cyan/10 cursor-pointer`}
                            style={{ paddingLeft: `${depth * 24 + 16}px` }}
                            onClick={() => setSelectedSection(section)}
                        >
                            {/* Expand/Collapse */}
                            {hasChildren ? (
                                <button 
                                    onClick={(e) => { e.stopPropagation(); toggleExpand(section.id); }}
                                    className="w-5 h-5 flex items-center justify-center text-slate-400 hover:text-white"
                                >
                                    {isExpanded ? 'â–¼' : 'â–¶'}
                                </button>
                            ) : (
                                <div className="w-5 h-5" />
                            )}

                            {/* Section Number */}
                            <span className="text-mp-cyan font-mono text-sm w-12">{section.number}</span>

                            {/* Title */}
                            <span className="flex-1 text-white font-medium">{section.title}</span>

                            {/* Section L/M Reference */}
                            <span className="text-xs text-slate-500 w-16">{section.sectionLRef}</span>
                            <span className="text-xs text-slate-500 w-16">{section.sectionMRef}</span>

                            {/* Page Count */}
                            <div className="w-20 text-right">
                                <span className={`text-sm ${pageOverage ? 'text-red-400' : 'text-slate-300'}`}>
                                    {section.estimatedPages}
                                </span>
                                <span className="text-slate-500"> / {section.pageLimit}</span>
                            </div>

                            {/* Owner */}
                            <span className="text-xs text-slate-400 w-24 truncate">{section.owner}</span>

                            {/* Status */}
                            <span className={`text-xs px-2 py-1 rounded w-24 text-center ${getStatusColor(section.status)}`}>
                                {getStatusLabel(section.status)}
                            </span>
                        </div>

                        {/* Children */}
                        {hasChildren && isExpanded && (
                            <div>
                                {section.children.map(child => renderSection(child, depth + 1))}
                            </div>
                        )}
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-mp-navy">
                    {/* Header */}
                    <header className="bg-mp-slate/50 border-b border-mp-cyan/20 px-6 py-4">
                        <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                            <div>
                                <h1 className="text-2xl font-bold text-white">Proposal Outline Builder</h1>
                                <p className="text-sm text-slate-400 mt-1">{outline.opportunity} â€¢ {outline.volumeType} Volume</p>
                            </div>
                            <div className="flex items-center gap-3">
                                <button className="bg-mp-slate border border-mp-cyan/30 px-4 py-2 rounded-lg text-sm hover:bg-mp-cyan/10 flex items-center gap-2">
                                    ðŸ“¤ Export
                                </button>
                                <button className="bg-mp-cyan text-mp-navy font-semibold px-4 py-2 rounded-lg hover:bg-mp-cyan/90 flex items-center gap-2">
                                    <span>+</span> Add Section
                                </button>
                            </div>
                        </div>
                    </header>

                    <main className="p-6">
                        {/* Stats Bar */}
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                            <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-lg p-4">
                                <div className="text-2xl font-bold text-white">{stats.totalCount}</div>
                                <div className="text-xs text-slate-400">Total Sections</div>
                            </div>
                            <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-lg p-4">
                                <div className="text-2xl font-bold text-green-400">{stats.completeCount}</div>
                                <div className="text-xs text-slate-400">Complete</div>
                            </div>
                            <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-lg p-4">
                                <div className={`text-2xl font-bold ${stats.totalPages > outline.pageLimit ? 'text-red-400' : 'text-mp-cyan'}`}>
                                    {stats.totalPages}
                                </div>
                                <div className="text-xs text-slate-400">Estimated Pages</div>
                            </div>
                            <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-lg p-4">
                                <div className="text-2xl font-bold text-white">{outline.pageLimit}</div>
                                <div className="text-xs text-slate-400">Page Limit</div>
                            </div>
                        </div>

                        {/* Page Progress */}
                        <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-xl p-4 mb-6">
                            <div className="flex justify-between text-sm mb-2">
                                <span className="text-slate-400">Page Budget</span>
                                <span className={`font-medium ${stats.totalPages > outline.pageLimit ? 'text-red-400' : 'text-white'}`}>
                                    {stats.totalPages} / {outline.pageLimit} pages
                                    {stats.totalPages > outline.pageLimit && ` (${stats.totalPages - outline.pageLimit} over)`}
                                </span>
                            </div>
                            <div className="h-3 bg-mp-navy rounded-full overflow-hidden">
                                <div 
                                    className={`h-full rounded-full transition-all duration-500 ${
                                        stats.totalPages > outline.pageLimit ? 'bg-red-500' :
                                        stats.totalPages > outline.pageLimit * 0.9 ? 'bg-yellow-500' : 'bg-mp-cyan'
                                    }`}
                                    style={{ width: `${Math.min((stats.totalPages / outline.pageLimit) * 100, 100)}%` }}
                                />
                            </div>
                        </div>

                        {/* Outline Table */}
                        <div className="bg-mp-slate/50 border border-mp-cyan/20 rounded-xl overflow-hidden">
                            {/* Table Header */}
                            <div className="flex items-center gap-3 px-4 py-3 bg-mp-navy/50 border-b border-mp-cyan/20 text-xs text-slate-400 uppercase tracking-wide">
                                <div className="w-5" />
                                <span className="w-12">Sect</span>
                                <span className="flex-1">Title</span>
                                <span className="w-16">Sec L</span>
                                <span className="w-16">Sec M</span>
                                <span className="w-20 text-right">Pages</span>
                                <span className="w-24">Owner</span>
                                <span className="w-24 text-center">Status</span>
                            </div>

                            {/* Sections */}
                            <div className="max-h-[600px] overflow-y-auto">
                                {outline.sections.map(section => renderSection(section))}
                            </div>
                        </div>

                        {/* Legend */}
                        <div className="flex flex-wrap gap-4 mt-4 text-xs text-slate-400">
                            <div className="flex items-center gap-2">
                                <span className={`px-2 py-1 rounded ${getStatusColor('not_started')}`}>Not Started</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <span className={`px-2 py-1 rounded ${getStatusColor('in_progress')}`}>In Progress</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <span className={`px-2 py-1 rounded ${getStatusColor('review')}`}>In Review</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <span className={`px-2 py-1 rounded ${getStatusColor('complete')}`}>Complete</span>
                            </div>
                            <div className="flex items-center gap-2 ml-auto">
                                <span className="text-red-400">Red = Over page limit</span>
                            </div>
                        </div>
                    </main>

                    {/* Section Detail Panel */}
                    {selectedSection && (
                        <div className="fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4" onClick={() => setSelectedSection(null)}>
                            <div className="bg-mp-slate border border-mp-cyan/30 rounded-xl p-6 max-w-lg w-full" onClick={e => e.stopPropagation()}>
                                <div className="flex justify-between items-start mb-4">
                                    <div>
                                        <span className="text-mp-cyan font-mono">{selectedSection.number}</span>
                                        <h2 className="text-xl font-bold text-white">{selectedSection.title}</h2>
                                    </div>
                                    <button 
                                        onClick={() => setSelectedSection(null)}
                                        className="text-slate-400 hover:text-white text-xl"
                                    >
                                        Ã—
                                    </button>
                                </div>

                                <div className="space-y-4">
                                    {/* References */}
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="bg-mp-navy/50 rounded-lg p-3">
                                            <div className="text-xs text-slate-500">Section L Reference</div>
                                            <div className="text-white font-medium">{selectedSection.sectionLRef}</div>
                                        </div>
                                        <div className="bg-mp-navy/50 rounded-lg p-3">
                                            <div className="text-xs text-slate-500">Section M Reference</div>
                                            <div className="text-white font-medium">{selectedSection.sectionMRef}</div>
                                        </div>
                                    </div>

                                    {/* Page Allocation */}
                                    <div className="bg-mp-navy/50 rounded-lg p-3">
                                        <div className="flex justify-between mb-2">
                                            <span className="text-xs text-slate-500">Page Allocation</span>
                                            <span className={`text-sm font-medium ${
                                                selectedSection.estimatedPages > selectedSection.pageLimit ? 'text-red-400' : 'text-white'
                                            }`}>
                                                {selectedSection.estimatedPages} / {selectedSection.pageLimit}
                                            </span>
                                        </div>
                                        <div className="h-2 bg-mp-slate rounded-full overflow-hidden">
                                            <div 
                                                className={`h-full rounded-full ${
                                                    selectedSection.estimatedPages > selectedSection.pageLimit ? 'bg-red-500' : 'bg-mp-cyan'
                                                }`}
                                                style={{ width: `${Math.min((selectedSection.estimatedPages / selectedSection.pageLimit) * 100, 100)}%` }}
                                            />
                                        </div>
                                    </div>

                                    {/* Assignment */}
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <div className="text-xs text-slate-500 mb-1">Owner</div>
                                            <div className="text-white">{selectedSection.owner}</div>
                                        </div>
                                        <div>
                                            <div className="text-xs text-slate-500 mb-1">Due Date</div>
                                            <div className="text-white">{selectedSection.dueDate}</div>
                                        </div>
                                    </div>

                                    {/* Status */}
                                    <div>
                                        <div className="text-xs text-slate-500 mb-2">Status</div>
                                        <div className="flex gap-2">
                                            {statusOptions.map(status => (
                                                <button 
                                                    key={status}
                                                    className={`text-xs px-3 py-1 rounded transition-colors ${
                                                        selectedSection.status === status 
                                                            ? getStatusColor(status) + ' ring-2 ring-mp-cyan' 
                                                            : 'bg-mp-navy text-slate-400 hover:bg-mp-cyan/10'
                                                    }`}
                                                >
                                                    {getStatusLabel(status)}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Children Info */}
                                    {selectedSection.children?.length > 0 && (
                                        <div className="bg-mp-navy/50 rounded-lg p-3">
                                            <div className="text-xs text-slate-500 mb-2">Subsections ({selectedSection.children.length})</div>
                                            <div className="space-y-1">
                                                {selectedSection.children.map(child => (
                                                    <div key={child.id} className="flex justify-between text-sm">
                                                        <span className="text-slate-300">{child.number} {child.title}</span>
                                                        <span className={`text-xs px-2 py-0.5 rounded ${getStatusColor(child.status)}`}>
                                                            {getStatusLabel(child.status)}
                                                        </span>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>

                                {/* Actions */}
                                <div className="flex gap-3 mt-6">
                                    <button className="flex-1 bg-mp-cyan text-mp-navy font-semibold py-2 rounded-lg hover:bg-mp-cyan/90">
                                        Edit Section
                                    </button>
                                    <button className="flex-1 border border-slate-600 text-slate-300 py-2 rounded-lg hover:bg-mp-navy">
                                        Open in Editor
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Footer */}
                    <footer className="bg-mp-slate/30 border-t border-mp-cyan/10 px-6 py-4 mt-8">
                        <div className="flex flex-col md:flex-row justify-between items-center gap-2 text-xs text-slate-500">
                            <span>AI GENERATED - REQUIRES HUMAN REVIEW</span>
                            <span>MissionPulse Proposal Outline Builder v1.0</span>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<ProposalOutlineBuilder />, document.getElementById('root'));
    </script>
</body>
</html>
